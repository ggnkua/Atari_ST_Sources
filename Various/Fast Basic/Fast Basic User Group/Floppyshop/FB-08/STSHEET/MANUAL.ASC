
                         ST-Sheet Version 0.01
                        =======================
Written  in Computer Concepts' Fast BASIC.  The best BASIC  interpreter 
                           for the Atari ST.

ST-Sheet has been placed in the Public Domain on the one condition that 
it    is  only  supplied in its  complete  form.  That  is,  with  this 
document,  the   spreadsheet software,  the example spreadsheet and the 
accompanying READ.ME   file.

                              User Manual
                             =============

                               CONTENTS.
                              ===========

 1 ..................................................... Introduction
 2 .......................................... Numbers and expressions
 3 ................................. Glossary of accepted expressions 
 4 .......................................... Text in the spreadsheet
 5 ........................................ Instructions and commands
 6 ................................................... Error messages


                             INTRODUCTION
                            ==============

     ST-Sheet  is  a simple spreadsheet written in  Computer  Concepts' 
Fast BASIC.  Control is via the mouse, and keyboard when necessary. The 
source code it is only 12 kilobytes or so long, but the Fast BASIC run-
time  interpreter adds about 75 kilobytes of library routines to  this. 
The software is available in either .PRG format,  for running from  the 
desktop,  or  .ACC  format,  to be loaded on boot-up  and  called  upon 
whenever  required.  If  only one of the above versions is on  your  PD 
disk,  then send œ2.50 and your disk for the other version. If there is 
enough  support  then  future versions will be developed  and  will  be 
available  for  œ5.00.  A  fully  documented  source  code  listing  is 
available  for œ5.00.  Please specify version number when requesting  a 
listing.

     The spreadsheet itself is ten cells horizontally,  numbered from 0 
to 9, and 26 cells vertically, lettered from A to Z. Whenever you refer 
to  a  cell in a particular command you should give  the  letter  first 
followed by the number.  To start with,  all the cells are empty and so 
you  will just see the letters down the side and the numbers along  the 
top.
 

     As you move the mouse over the spreadsheet, the number of the cell 
that it is over will be displayed in the bottom left hand corner of the 
screen. This is the cell that will be affected by any actions you carry 
out.  To  get the command prompt you should press the left  hand  mouse 
button while over the desired cell.  A question mark prompt will appear 
above the spreadsheet and you can type in commands etc.
     
     You   should  note  that  when  values  in  the  spreadsheet   are 
recalculated,  the  recalculation starts in the top left  hand  corner, 
goes  across to the right and then returns to the left hand end of  the 
following  line.  Thus you should plan your spreadsheet so  that  cells 
only refer to cells to their left OR above themselves. Otherwise a cell 
will contain a value calculated from old data.


                        NUMBERS AND EXPRESSIONS
                       =========================

     A spreadsheet is designed to deal with numbers so these should  be 
the  first  thing  that you can enter.  To associate a  number  with  a 
particular  cell,  you should place the mouse cursor over  the  desired 
cell and then press the left hand mouse button. Once the '?' prompt has 
appeared you can enter the number.  To indicate to the spreadsheet that 
what you are about to enter is a number,  you should precede it with an 
equals sign, ('=').

     For example,  to place the number 123.45 in cell A0, (The top left 
cell), place the mouse pointer over the cell, press the left button and 
enter . . .

                                =123.45

     remember to press <RETURN>. At the start of a session, numbers are 
limited to a maximum value of 9999.99,  this can easily be changed, see 
the 'FORMAT' command below.

     Having just numbers in a spreadsheet is not very useful,  you have 
to be able to act upon these numbers and put them into  functions.  ST-
Sheet  can handle a very wide range of mathematical functions  and  you 
can use them all in your spreadsheets.  Entering functions is also very 
easy,  follow  the instructions above and when you get the '?'  prompt, 
enter  the equals sign followed by the function you require,  with  its 
argument.  For  example,  to give the value of the sine of 2.5  radians 
enter . . .

                               =SIN(2.5)

     followed by <RETURN> of course.  When a constant number is used as 
an  argument brackets are optional.  However spreadsheets can also  use 
values from previous cells as arguments to calculate new  values.  When 
these  values are used as arguments,  you should use the number of  the 
cell  in place of the value in the function.  You do not need  brackets 
around the cell number.  For example,  to get the sine of the value  in 
cell A1, enter . . . 
                                =SIN A1 

     followed by <RETURN> of course.

     You amy also have nested functions, that is one function acting on 
the result of another function,  all in the same cell.  A few  examples 
will  help.   All  the  following  are  valid  and  correct   .   .   . 
                              

                                =SIN A1
                               =SIN(A1)
                             =COS(SIN A1)
                            =EXP COS SIN A1
                           =EXP(COS SIN(A1))

     In   fact  these  expressions  with  nested  functions   are   bad 
spreadsheet  practice.  Very quickly,  it is easy to lose track of  the 
structure  of  the spreadsheet and where results have  come  from.  The 
'DISPLAY'  command detailed below may go some way towards  helping  the 
situation but nested functions are only recommended when you are  short 
of space on the spreadsheet.          

                   GLOSSARY OF ACCEPTED EXPRESSIONS
                  ==================================

     The spreadsheet uses the Fast BASIC 'EVAL' command to  recalculate 
the expressions in the cells so any valid expression in Fast BASIC  can 
be used in ST-Sheet.  Each is detailed below for those of you who don't 
have Fast BASIC.

  -         Unary minus. Gives the negative of a number.
  +         Unary plus. Gives the positive of a number. (Optional).
 NOT        Inverts its argument.
  ^         Raises the first value to the power of the second.
   >>       Bit  shifts  to  the  right  the  first  number   by   the 
            second number of bits.
 <<         Bit shift to the left. As above.
  *         Multiplication.
  /         Division.
 DIV        Integer division.
 MOD        Returns the remainder of an integer division.
  +         Addition.
  -         Subtraction.
 AND        Bitwise AND operation.
 EOR           "     "      "

 OR            "     "      "    
 ABS        Returns value without sign. i.e. ABS(-10) = ABS(10) = 10
 ACS        Arc cosine. Result in raians.
 ALOG       Anti-logarithm to base ten.
 ASC        ASCII code of a character.
 ASN        Arc sine. See ACS above.
 ATN        Arc tangent. See ACS above.
 COS        Cosine. See ACS above. Remember in radians.
 DEG        Convert an angle in radians into an angle in degrees.
DISCFREE    Returns bytes free on disk. Might be useful ???
DRIVE       Determine current drive. ???
DRIVEMAP    Determine which drives are attached. ???
 ERR        Number of last error. ??? 
 EXP        Exponential. e (2.71828...) to any power.
FALSE       Logical NOT TRUE. In fact 0.
FIELD       Width of PRINT field. ???
 FREE       Determine free memory. ???
GRAFHEIGHT  Height of graphics rectangle. ???
GRAFWIDTH   Width   "    "         "      ???
GRAFXBASE   X-coord "    "         "      ???
GRAFYBASE   Y-  "   "    "         "      ???
 INP        Input from an I/O device. ???


INPSTAT     Input device status.      ???
 INT        Integer value of argument.
 LEN        Length of a string. ???
 LN         Base e logarithm.
 LOG        Base 10 logarithm.
LOGBASE     GEM screen base address. ???
OUTSTAT     Output port status. ???
PEEK        Examine supervisor memory.
PHYSBASE    Physical screen base address. ???
 PI         3.1415926 . . .
 RAD        Convert angle in degrees to an angle in radians.
 RND        Return random 32 bit integer.
 RND(-n)    Return same number again.
 RND(0)     Return same number as last returned by RND(1).
 RND(1)     Return random number in range 0 to 0.999 inclusive.
 RND(n)     Return random number in range 1 to n inclusive.
 ROUND      Round a number to the nearest integer.
SCREENHEIGHT Determine total screen height. ???
SCREENMODE   Determine current screen resolution. ???
SCREENWIDTH  Determine total screen width. ???
 SGN        Return sign of argument. -1= -ve, 0= 0, +1= +ve
 SIN        Sine.


 SQR        Square root.
SQUARE      n squared. Faster than n^2
 TAN        Tangent.
 TIME       Internal timer. ???
TRUNC       Truncate value towards zero. TRUNC(10.6)=10, TRUNC(-9.5)=-9
TXTHEIGHT   Text rectangle height. ???
TXTWIDTH      "      "     width. ???
TXTXBASE      "      "     x-coord. ???
TXTYBASE      "      "     y-  "    ???
TXTXPOS     X-coord of cursor. ???
TXTYPOS     Y-  "    "    "    ???
 VAL        Value of number in string.

     I see no real use for some of these functions but they could  come 
in handy.  Some of the mathematical functions can be operated at double 
precision be preceding them with a 'D'.  The extra decimal places  will 
not  be noticed though,  and they will just slow down recalculation  so 
it's not really worth it.

                        TEXT IN THE SPREADSHEET
                       =========================

     A sheet full of numbers is not very meaningful so the facility for 
text  in essential.  Each cell can hold up to nine characters  so  only 
short titles  and notes can be squeezed in. To enter text, position the 
mouse  pointer over the required cell and press the left  hand  button. 
When the '?' prompt appears you should type in your text.  To  indicate 
to  the  spreadsheet  that  it is text you  should  precede  it  by  an 
apostrophe sign, (').
     
     For example to place the text 'PRICES' in cell D4, place the mouse 
pointer over cell D4 and depress the left hand button.
When the prompt appears type in . . .


                                'PRICES

     followed  by <RETURN>.  Due to the small size of the characters  I 
suggest   that  you  only  use  upper  case  characters,   to   improve 
readibility. In fact it is advisable to keep CAPS LOCK ON throughout as 
all expressions and commands require upper case characters.



                       INSTRUCTIONS AND COMMANDS
                      ===========================

     There are only seven commands in this early  version.  Suggestions 
for  additional commands and instructions will be gratefully  received, 
and  will  result  in a new version being published.  For  all  of  the 
commands,  only  the  first  two characters are tested so  it  is  only 
necessary to type these. Thus RECALCULATE ON can be shortened to RE ON.

     In  fact the ON can also be abbreviated to N.  Thus  the  shortest 
forms of commands are shown below . . .

          RECALCULATE ON           =         REN
          RECALCULATE OFF          =         REF
          BLANK n                  =         BL n
          BLANK r                  =         BL r
          SAVE                     =         SA
          LOAD                     =         LO
          QUIT                     =         QU
          FORMAT DDDDDDD           =         FO DDDDDDD
          DISPLAY ON               =         DIN
          DISPLAY OFF              =         DIF


     The functions of these commands are detailed below . . .

RECALCULATE:-  With  this ON,  after ever operation the values  in  the 
               spreadsheet will be automatically recalculated. Thus the 
               spreadsheet  will always be up to date if an  alteration 
               is made. However recalculation and reprinting can take a 
               while so only turn it on every so often.      

BLANK:-        BLANK  followed  by a number will  remove  all  numbers, 
               expressions and text from that particular column.
               BLANK  followed  by a letter will  remove  all  numbers, 
               expressions and text from that particular row.

SAVE:-         This  command allows you to save a spreadsheet you  have 
               created.  It  will be saved in its most  recent  format. 
               Each  spreadsheet will take at least 2 kilobytes on  the 
               disk.

LOAD:-         This  command  allows you to load a  previously  created 
               spreadsheet.  
QUIT:-         QUIT is the only way you can leave the program. You will 
               be asked to confirm the command.


FORMAT:-       At  start up the highest value in any cell  is  9999.99. 
               Any  higher value will result in an  error.  The  format 
               command  is  the most complex so it  will  be  explained 
               separately at the end.

DISPLAY:-      If  you  haven't  noted  each cells  expression  then  it  can  be 
               difficult  to work out what's going on.  With DISPLAY ON any  cell 
               that  the  mouse  pointer passes over  will  have  its  expression 
               printed at the bottom of the screen. This can slow mouse movements 
               but is very useful.

     The  format  command  allows you to display the  numbers  in  your 
spreadsheet  in any way that you like.  Essentially you can select  how 
many digits you want before the decimal point and how many  afterwards. 
There  are seven available positions so you can have seven  digits,  or 
six  digits  and a decimal point.  This allows you  to  configure  your 
spreadsheet  to  deal with either very large  numbers,  or  very  small 
numbers, or a mixture.

     The  'FORMAT' command hould be followed by the seven symbols  that 
you  require.  These symbols consist of upper case 'D's or 'Z's and  at 
most  one '.' .  If any of the last seven characters in the command  is 
not a 'D' or 'Z',  or if there is more that one '.',  an error  message 
will be generated.

     The  '.'  in the command specifies where the  decimal  point  will 
come.  A 'D' will be replaced by the digit in its position, while a 'Z' 
will  be replaced by a digit or a space if that digit was  '0'.  A  few 
examples may help . . .

     Number.                  Format.                  Displayed as.

     125.3                    DDD.DDD                  125.300
     125.3                    ZZD.DZZ                  125.3
       1.253                  DDD.DDD                  001.253
       1.253                  ZZD.DDD                    1.253
   
     5832.456                 DDDD.DD (rounding up)    5832.46
       58.3                   DDDD.DD                  0058.30

     5791347                  DDDDDDD                  5791347
          23                  DDDDDDD                  0000023
          23                  ZZZZZZD                       23

     From these examples you should be able to see that 'Z's allow  you 
to remove ugly leading '0's.  As a general rule, it is best to have all 
'Z's  with 'D's just before and after the decimal  point.  The  default 
format is 'ZZZD.DD',  all decimal digits that cannot be displayed  will 
round up the previous digit, (see the example above).

                            ERROR MESSAGES
                           ================

     Whenever an error occurs,  it is trapped and the Fast BASIC  error 
type  displayed.  When  you exit the alert the cell mentioned  will  be 
automatically cleared and set to its start-up value. The following list 
summarises the errors I have successfully invoked.  All are trapped and 
cannot ruin the spreadsheet.

Illegal assignment :     You tried to enter a character after an '='.
                         E.G.      '=A'
                                   '=CHR$(65)'

To big to be real  : The number you entered, or has been calculated, is 
                     to big to be printed with the current format.
                      E.G.      Any  number  greater  than  9999.99  on 
                    start-up.

Missing right-hand bracket :  You entered an expression with more left-
                              hand brackets than right-hand brackets.
                         E.G.      '=SIN (A0'

ACS/ASN   range      :     The  number  you  entered,   or   has   been 
                         calculated, breaks the -1 to +1 limit on these 
                         functions.
                         E.G.      '=ACS 2.6'

Division by zero   :     It has come about that, a division by zero has 
                         occurred.
                         E.G.      '=(SIN 1.7)/(2-2)'

EXP range          :     The argument supplied for EXP is to large.
                         E.G.      '=EXP 100'

LOG  range          :     The  argument supplied for LOG  is  to  large 
                         or small. 
                         E.G.      '=LOG  (SIN 0)'

Negative square root :   You tried to calculate the root of a  negative 
                         number.
                         E.G.      '=SQR (5-EXP 2)'

Tokenising  error  :     This  error occurs when  Fast  BASIC's  'EVAL' 
                         command cannot  convert  your input  into  the 
                         tokens it uses.
                         E.G.      '=ASC ("T)'

No such variable   :    You have put something in your expression  that 
                         doesn't constitute a function,  a number or  a 
                         cell address.
                         E.G.      '=STOP'

Incorrect format    :    This is the error message given if you  follow 
                         the  FORMAT command with anything  other  than 
                         'Z's, 'D's or a '.' .
                         E.G.      'FORMAT zzzD.zz'
