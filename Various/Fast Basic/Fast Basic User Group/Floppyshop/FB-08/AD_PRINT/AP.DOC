     ADDPRINT  (AP.BSC)
     ÿÿÿÿÿÿÿÿ  ÿÿÿÿÿÿÿÿ
     by  Pat Dickinson


     Introduction:

          While ST programmers thrive on producing address 
     databases and the many and varied (GEM and non-GEM) versions
     have their own features and qualities, I felt there is room 
     for one more which has a slightly different purpose. While 
     this program serves as a database with all the usual features
     to be loaded at the click of a mouse the main function is to 
     act as an envelope and label printer. The idea is that, 
     with the program converted and installed as a desk accessory,
     you have easy access to addresses from within your word processor 
     and can address envelopes easily and without having to use a 
     printer-as-typewriter utility. If used as a program on its 
     own it can still be useful especially for bulk addressing.
     It is possible, in addition, to set print type and size 
     according to needs.
            The program is called ADDPRINT (AP). Written in Fast 
    Basic and completely GEM driven it has the following attributes:-

        a] It has a scrolling list of all your addressees in alphabetical 
            order.
        b] It can load, save, create, delete or edit addresses.
        c] It can store telephone numbers (but doesn't print them).
        d] For Epson compatible printers it can:
                   1) Set the print type
                   2) Set the print size
                   3) Set the printing position on the envelope
        e] It can disable the paper-out detector on the printer and
             re-enable it when finished, so making it possible to
             print on envelopes without going off line.
        f] It can store up to 100 addresses on your file.

     
     Files:
     
          The following files should come with ADDPRINT:-

          - AP.BSC           - AP.DOC
          - AP.DAT           - AP_EXAMP.DAT
          - APHELP.PI3
                
          AP.BSC is the ADDPRINT program. You will need Fast 
               Basic or or its smaller shell program RUNNER.PRG 
               to load and run it.
          AP.DAT and AP_EXAMP.DAT are data (address) files.
          [NB - By renaming AP_EXAMP.DAT to AP.DAT (having first 
                removed the original AP.DAT file) you can load an 
                example address book and experiment with it.]
          APHELP.PI3 is a high-res Degas picture which offers a 
               useful on-screen or printed help sheet to the user.
  

     Description:

          The program is displayed in the form of a GEM Dialogue 
     Box from which all functions are performed.
          The data (ie names and addresses) is held on a file 
     (AP.DAT) and is loaded and saved by the program when
     required. This file must be in the root directory of Drive A.           
        
          [NB - If you use a RAM disk with your word processor, 
     considerable time can be saved when loading and saving 
     addresses by installing AP.DAT in the RAM disk and changing 
     line 7 of 'PROCsetup' in the program listing from

             PATH$="A:\"        to        PATH$="D:\".

     (This is assuming that your RAM disk is labelled Drive D.)
     Don't forget to save the data file to floppy disk before the
     end of the session. The same method can be used by hard disk
     owners.]

          
    
     How to start:

        a) If ADDPRINT is in BSC form then Run it from the menu as 
     usual. You can convert it to PRG or desk accessory (ACC) form
     by using TAGGER.PRG found on the Fast Basic supplement disk.
     The one provision for all forms is to have the data file AP.DAT 
     on the root directory on a disk in Drive A.
     [ NB. If converting to PRG or ACC first delete the 13th line 
          of the program ('TOP=SEGHANDLE(SEGMENT') to ensure smooth
          running of GEM after exiting from the program.]

        b) Once ADDPRINT has appeared on the screen and AP.DAT 
     has been loaded you are presented with an empty directory
     on the right side of the dialogue box and the address box on
     the left side. To enter addresses simply type in each field
     of the address box the appropriate information using the 
     standard GEM editing keys ( ie. arrows, tab, delete, 
     backspace and Esc). When you are satisfied that the name and 
     address is complete, click in the 'Save' box and the record 
     will be saved to disk and the name listed in the directory.
          To enter the next name and address, click on 'Clear'
     to empty the address box and then start typing again. Follow 
     this procedure until all your addresses have been entered.
     The program will automatically sort the directory names
     into alphabetical order.


     Directory:

          The directory holds the names of the addressees in your 
     address file. When the program is first run the list will
     be blank; but after all your addresses have been entered 
     the first fourteen names are displayed in alphabetical order.
     If there are less than fifteen names they will all be
     displayed. If there are more than fourteen names then the 
     scrolling arrows become active and clicking and holding
     down the mouse button on the up or down arrow will scroll
     the full list of names upwards or downwards. 
 
          The box labelled 'Total' at the top of the directory
     shows the number of addresses in your data file.


     Selecting a Name:

          First of all make sure that the addressee you want to  
     load and print is in the directory, if necessary scrolling 
     to find the right name. Then click on that name with the  
     mouse pointer. It will become highlighted and the relevent      
     address will be loaded from the disk file into the address box.  

  
     'Print':

          Clicking on this button will send the name and address 
     in the address box to the printer (providing that your 
     printer is on line). Before using this function check to make 
     sure that the PRINTER SETTINGS are set to your requirements. 
     If any of the fields are blank (eg field Address3 or 
     Address4) then the program will close any gap between the 
     fields which are used. For example, if you are printing 
     an address which is two lines ( PO Box 230, London),and the 
     next two fields are blank, but there is a postcode (SW1 1RD), 
     then the printer would print:-     

               PO Box 230     
               London    
               SW1 1RD

     and not:- 

               PO Box 230     
               London


               SW1 1RD  

          The telephone field is an optional extra and it is not 
     printed with the address.


     'Clear':

          Using this function will erase any address from the 
     address box. This will NOT erase that particular address from 
     your data file if it has been saved.


     'Save' 

          When you click on this box the address in the address 
     box is saved to disk in the AP.DAT file. If it is a new 
     address it is tagged on to the end of the address file; 
     if it is an address already on the directory then the program
     will seek the position in the file of the old address and 
     write the new address (in the box) on top of it (thus 
     including any alterations). 
          If you alter the addressee's name in any way (apart
     from changing from upper to lower case or vice-versa)
     then a new record will be added to the data file under the
     new spelling of that name.
          If you change the letters from upper to lower case or 
     vice-versa in the name, then the address will be saved under 
     that name. For example, if you have a 'Mr J Smith' on your 
     data file and you save 'MR J SMITH' then the latter will 
     replace the former in the file.
           

     'Del':

          This button will delete the address in the address box 
     from your file. Confirmation will be needed beforehand as a 
     safeguard against accidental deletion.

     
     'Help':

          Clicking here will produce a small dialogue box with a 
     few instruction reminders. For example, how to edit in the
     address box.

    
     'Printer Settings':

          Before printing an address you have the option of 
      adjusting certain features on your Epson compatible printer.
          Type: This will decide the quality of print needed -
                Near Letter Quality, Draft or Bold
          Size: This will set the type size - Normal, Condensed  
                or Large         
          Offset: This allows you to choose how far from the edge 
                of the envelope or label you want to print the 
                address - 2", 2.5" or 3". The left edge of the paper
                must be set at the '0' position on the printer 
                ruler to get accurate results, though adjustments
                may be neccessary according to different printers.
          [NB - This feature only applies to Epson or Epson 
      compatible printers. If your printer isn't one, it is possible
      to alter the code in the PROCsetup and PROCconfig procedures
      to suit your needs.]


       'Exit':

          Clicking on this button ends the program and returns you 
     to Fast Basic. The AP.DAT file will remain as it was when you 
     last saved or deleted an address. 


     Problems & Limitations:

     1  - If you convert ADDPRINT to a PRG or ACC version and 
     have 512K RAM you can run up against problems if too much 
     memory is allocated to desk accessories or, with the ACC 
     version, you have a particularly large application in 
     residence. The problem occurs because of the method of 'tagging' 
     Fast Basic on to the original BSC file to create an independent 
     program. This produces a very large file which TOS has to 
     wrestle with to fit into available RAM. No such problems exist 
     when 1MB of RAM is fitted.

     2 - Because of the size of the dialogue box and the amount
     of information displayed in it, the program will only work,
     I am afraid, in High Resolution.


          As far as I know this program is reasonably bug free, 
     but, as we all know from experience, there are conditions 
     where even the most thoroughly checked code can come unstuck.
     I hope these are few and that the compulsive letter writers 
     among you will make good use of the program. If anyone should 
     have any problems or any modification is needed I would be glad 
     to help out if asked. 


     Patrick Dickinson
     23 Whitehall Park,
     London
     N19 3TS

      
 

 
      


    
     

   

