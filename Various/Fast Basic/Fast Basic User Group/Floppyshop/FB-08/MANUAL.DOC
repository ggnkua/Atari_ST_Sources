




         P R O C E D U R E / F U N C T I O N   L I B R A R Y
         
                              By Martin Brough
 


1:  Introduction
      
       This  guide can be  viewed or printed from the desktop or 
loaded into "1ST WORD" or any other ASCII editor for printing or
viewing.
       It is advisable to make a back-up of this disc before using
it to avoid accidental erasure of the routines when loading them.
       The  routines  included on this disc  are  designed  to  be 
included in your own programs and will not run as they  stand.They
are also meant as a source  of ideas for programming and should be
altered  and  extended to  suit the user's needs.To include one of
these routines ,  just position the cursor at the point in your
progran at which you wish the routine to be inserted and then load
the routine  by  selecting  the  "Insert program"  option  of  the
"File"  menu.After  this has been done you  can  call  the routine
whenever it is needed.

      It  should  be noted that some  routines  need  initialising 
commands  before  they  will work  (eg.  the  procedure  PROCsound 
requires   you   to   reserve   20   bytes   of   memory    before 
execution).



2:  Summary of routines
  
      Below  is a list of the routines included  together  with  a 
breif  description of what each one does.For  further  explanation 
see the next section.
 No.|Filename|Procedure name|Description
----|--------|--------------|------------------------------------- 
 1  |3DTO2D  |convertx3D    |Converts X,Z co-ordinates to 2D X 
    |        |              |co-ordinate
 2  |3DTO2D  |converty3D    |Converts Y,Z co-ordinates to 2D Y
    |        |              |co-ordinate
 3  |BESTFIT |bestfit       |Gives line of best fit gradient and 
    |        |              |Y-axis intercept
 4  |CLEAR   |clear         |Resets ink colour line colour etc and
    |        |              |clears screen
 5  |DATE    |setdate       |Sets  the  date  given  a  string 
    |        |              |Day/Month/Year
 6  |DATESTRG|datestring    |Converts date to a string (eg. 12th
    |        |              |November 1986)
 7  |DELSTRNG|deletestring  |Takes out specified number of letters
    |        |              |from a string
 8  |DELSTRNG|insertstring  |Inserts letters into a string at 
    |        |              |specified place
 9  |DPALETTE|defaultpalette|Resets the palette to default setting
10  |DRAWAXES|drawaxes      |Draws graph axes and lables them
11  |DRAWFORM|drawformula   |Draws specified formula onto axes
12  |GETGDATA|getgraphdata  |Gets  information  about  axes  for 
    |        |              |drawaxes
13  |GETINPUT|input         |A versatile input routine allowing
    |        |              |accented and special characters
14  |GETKEYS |getkeys       |Waits until one of a range of keys 
    |        |              |is pressed returning the one selected
15  |HIGHLOW |hilo          |Finds upper and lower limits of array
16  |INPUTNUM|inputnum      |Waits for number between specified
    |        |              |values
17  |INPUTYN |inputyn       |Waits for yes or no answer
18  |INPXYJOY|joyinputmove  |Adjusts  X  and   Y   co-ordinates 
    |        |              |according to joystick position
19  |LOADNEO |loadpic       |Loads a Neochrome picture and resets
    |        |              |the colour palette
20  |MEAN    |mean          |Finds the mean of any array
21  |MEDIAN  |median        |Finds the median of any array
22  |MODE    |mode          |Finds the mode of any array
23  |MOVEXY  |inputmove     |Adjusts X  and   Y  co-ordinates
24  |PADSTRNG|padright      |Fills  a string  to  the  specified 
    |        |              |length leaving the string on the left
25  |PADSTRNG|padleft       |Opposite of 24
26  |QBESTFIT|quickbestfit  |Quick version of 3 but limmited
27  |QHIGHLOW|quickhilo     |Quick version of 15 but limited
28  |QMEAN   |quickmean     |Quick version of 20 but limited
29  |QMODE   |quickmode     |Quick version of 22 but limited
30  |QSORT   |quicksort     |Quick version of 33 but limited
31  |QTOTAL  |quicktotal    |Quick version of 40 but limited
32  |ROTATE  |Xrotation     |Rotates 3D coordinates about X-axis
33  |ROTATE  |Yrotation     |Rotates 3D coordinates about Y-axis
34  |ROTATE  |Zrotation     |Rotates 3D coordinates about Z-axis
35  |SCREEN2 |setupscreentwo|Reserves second screen and sets up
    |        |              |variables for screen flipping
36  |SORT    |sort          |Sorts any array into numerical order
37  |SOUND   |sound         |Plays a note given channel,volume,
    |        |              |pitch,duration
38  |SPRITES |initsprites   |Initialises the sprite routines
39  |SPRITES |spriteon      |Puts specified sprite on the screen
40  |SPRITES |collision     |Checks whether the sprite has hit 
    |        |              |anything
41  |TIME    |settime       |Sets the internal clock given the
    |        |              |time in the format "hrs:mins:secs"
42  |TITLE   |title         |Print and underlines given title
43  |TOTAL   |total         |Finds the total of any array
44  |WAITBUTN|waitbutton    |Waits until the left mouse button
    |        |              |is pressed
45  |WRDCOUNT|words         |Counts  the number of  words  in  a 
    |        |              |string


3:  Explanations

     Below is an alphabetical list of each routine as above with a 
longer explanation against each one.

 1:FNconvertx3D( X , Z ,D )

    This function converts the 3D X and Z co-ordinates given to  a 
2D  X  co-ordinate.This can be used together with  FNcoverty3D  to 
plot 2D points on the screen.
   To get an idea of  what  each  variable  does try experimenting 
with  the  coordinates  and  the  variable  "distance%"  in  the
example program "ROTATE.EXM".    

 2:FNconverty3D( Y , Z )

     This  function  converts 3D Y and Z co-ordinates to  a  2D  Y 
co-ordinate, in the same way as FNconvertx3D does for X.

 3:PROCbestfit( array name for X ,  array name for Y ,  length  of 
               arrays)

    This procedure finds the line of best fit for the X and Y  
co-ordinates held in the specified arrays.Thus , if all the points 
were plotted from the arrays "Day" for the X-axis and "Price"  for 
the  Y-axis then the command  PROCbestfit("Day","Price",number  of 
co-ordinates) would find the line of best fit for these points.The 
line is returned by means of two global variables;
 "gradient" is the gradient of the line
 "intercept" is the point at which the line crosses the Y-axis

 4:PROCclear

   This procedure is a basic initialisation routine which does the 
following functions;
 Sets the text colour to 1(usually black)
 Turns off any text effects
 Makes the text size 6(default for colour modes)
 Resets to default line and marker type
 Sets the graphic tect color to 1
 Sets the graphic text size to 6
 Turns off any graphic text effects
 Sets the text and graphic windows to full screen size  excluding 
the menu bar
 Clears the screen (excluding the menu bar)

 5:PROCsetdate( date as a string )
   
    This  procedure  sets the internal  clock  using  the  command 
SYSDATE.The  procedure  does the opposite of DATEUK$  in  that  it 
converts  the  date in the string provided into  a  binary  number 
before  resetting  the  date.The string should be  in  the  format 
"day/month/year" (eg "25/12/1987").

 6:FNdatestring( date as a string )
 
   This function converts a date in the format "25/12/1987" to the 
string "25th December 1987 ".

 7:FNdeletestring( string ,  starting place , number of characters 
                  to be deleted )

    This  function deletes a certain number of characters  from  a 
string.

 Example:  A$="This is a long string"
           B$=FNdeletestring(A$,11,5)
           PRINT B$
          This would print  "This is a string"

 8:FNinsertstring( string , place , string to be inserted )

    This function insterts one string into another string  at  the 
specified place.

 Example: A$="This is a string"
          B$=FNinsertstring(A$,11,"long ")
          PRINT B$
         This would print   "This is a long string"

 9:PROCdefaultpalette

   This procedure resets the palette values to those set when  the 
machine  is  first switchen on.The procedure  automatically  tests 
which mode the computer is in.

 10:PROCdrawaxes

    This procedure draws , numbers and lables X and Y axes.It also 
contains the functions necessary to plot points on these  axes.The 
data for the axes must be held in the foolowing global variables;
   xglow  ,  xghigh ,  yglow ,  yghigh - the co-ordinates  of  the 
position on the screen that the axes will be drawn.
   Xlow ,  Xhigh , Ylow , Yhigh - the range of the X and Y axes.
   xinterval ,  yinterval - the intervals at which numbers will be 
marked on the X and Y axes.
   Xlable$ , Ylable$ - X and Y axes lables
   gtitle$ - the title for the graph

 The two functions for plotting points on the axes are;
   FNconvertx( X co-ordinate )
   FNconverty( Y co-ordinate )
  These  will return the screen co-ordinates at which  the  point 
should go.Thus to plot the point (3,2) on the axes use
 PLOT FNconvertx(3),FNconverty(2)

 The axes can have negative co-ordinates and false origins.

 11:PROCdrawformula

     This  procedure is to be used with PROCdrawaxes to  plot  any 
formula   that  is  allowable  in  FAST  BASIC   expressions   (eg 
SIN,COS,LOG  etc).The  expression  should be  given  in  terms  of 
X.Therefore a formula such as Y=2*X should be given as "2*X".
  It  should be noted that all the error messages still  apply  to 
this  procedure  and so if plotting LOG(-1) is attempted  it  will 
generate the error message "LOG range".

   Example:    PROCclear
               PROCgetgraphdata
               PROCdrawaxes
               PROCdrawformula("X*COS(X)^3")


 12:PROCgetgraphdata

    This simple procedure gets the necessary variables for use with 
PROCdrawaxes.This  can be used to experiment with  PROCdrawaxes  to 
give an idea of the information needed and each ones functions.

 13:FNinput( cursor X pos , cursor Y pos , string length )

    This function is used to enter any reply at the X and Y
 co-ordinates specified.It  will  only allow the reply  to  be  the 
specified length.
 Function keys and shift-with-function keys are used to provide  20 
special keys which can be set to any character ,  allowing input of 
characters not normally available from the keyboard  (eg.  accented 
characters).The   20  special  keys  are  set  in   the   procedure 
PROCreadaccents.The  first DATA statement contains the ASCII  codes 
for  the 10 function keys and the next DATA statement contains  the 
codes  for the function keys with shift.These should be set to  the 
keys required or else left as the default set.These are:
 function key| ASCII code |function+shift| ASCII code
     1       |  160       |     1        |  140
     2       |  133       |     2        |  139
     3       |  131       |     3        |  153
     4       |  132       |     4        |  149
     5       |  130       |     5        |  147
     6       |  138       |     6        |  148
     7       |  136       |     7        |  163
     8       |  137       |     8        |  151
     9       |  180       |     9        |  150
    10       |  135       |    10        |  129


 14:FNgetkeys( selection of keys to wait for )

    This function waits until one of the specified keys is pressed 
and then returns which one it was.

   Example:    A$=FNgetkeys("XYZ")
               PRINT "You pressed ";A$

 15:PROChilo( array name , length of array )
 
     This  procedure finds the highest and lowest  values  in  the 
array  specified.The values are returned in the  global  variables 
dbig and dsmall.

    Example:  To  find the highest and lowest price in  the  array 
Prices(50)
                PROChilo("Prices",50)
                highest=dbig:lowest=dsmall

 16:FNinputnum( upper limit , lower limit )

     This  function  waits until a number is  entered  within  the 
required range and then returns the number entered.

    Example: To input a number between 10 and 20 inclusive
                A=FNinputnum(20,10)

 17:FNinputyn( prompt string )

    This function will print the prompt string and then wait for a 
yes or no answer , returning "Y" or "N".

    Example: A$=FNinputyn("Do you want to continue?")

 18:PROCjoyinputmove

     This procedure adjusts the global variables xpos%  and  ypos% 
within  the  screen  limits  depending  on  how  the  joystick  is 
positioned.It  is useful in simple games and can be combined  with 
the sprite routines to make a sprite move about the screen.
  If the co-ordinates have changed during the procedure  then  the 
variable "move" is set to TRUE.If the fire button is preesed  then 
"quit" is set to TRUE.
 It should be noted that PROCinitjoystick should be called at  the 
start of the program to assemble the machine code and that the 
command OUT 4,8 be issued at the end of the program.

 19:PROCloadpic( filename , address )

    This procedure loads the Neochrome picture specified into  the 
memory  at the address given.It also resets the colour palette  to 
the  one  for  that  picture.A  screen  could  be  reserved  using 
PROCsetupscreentwo  and then the following program  would  display 
the picture "Picture".
                    PROCsetupscreentwo
                    PROCloadpic("Picture",screentwo)
                    PHYSBASE=screentwo

 20:FNmean( array name , length of array )

    This function finds the arithmatic mean of the data held in the 
given  array (ie.  the total of the data divided by the  number  of 
values included).

 21:FNmedian( array name , start of array , finish of array )

     This function finds the median of the array values  given.(ie. 
the middle value after the values have been arranged into numerical 
order).
   Note that before this routine is executed the data should  have 
been sorted with PROCsort.

 22:PROCmode( array name , length of array )

     This  procedure finds the mode or  most  frequently  occuring 
number in the specified array.It returns this value in the  global 
variable  'mode' and the number of times it occured in the  global 
variable 'freq%'.
  In  addition  to  this,the procedure  creates  an  array  called 
'frequency'  which  holds  the number of times  each  array  value 
occurs.(eg.  if after running the program  bellow,'frequency(3)'=2 
then  the value held in 'PRICES(3)' occurs two times in the  whole 
array.)

           Example:    <the array 'PRICES' must be
                        filled with data>
                       DIM frequency(50)
                       PROCmode("PRICES",50)
                       PRINT mode,freq%
 Note that before this procedure can be used the array 'frequency' 
must be defined with the number of items in the array you wish  to 
test.(ie.  if  you want to test the array 'HEIGHTS' which has  200 
values  then you must use the command 'DIM frequency(200)' at  the 
start of the program)

 23:PROCinputmove

     This  procedure is similar to  PROCjoyinputmove  except  that 
instead of using the joystick for input it uses the keys:
                    Z - Left
                    X - Right
                    ' - Up
                    / - Down
                    Q - sets the variable 'quit' to TRUE
  There  is  no  'move' variable and  the  procedure  requires  no 
initialisation.

 24:FNpadright( string ,  final length ,  string to be used to pad 
               with )

    This function pads a string out to the required length leaving 
the  string on the left and using the character specified to  fill 
in  the  space.If  the given string is longer  than  the  required 
length then then first 'n' characters will be returned.

       Examples:    PRINT FNpadright("hello",2," ")
                    would print 'he'
                    PRINT FNpadright("hello",10," ")
                    would print 'hello     '
                    PRINT FNpadright("hello",10,"*")
                    would print 'hello*****'

 25:FNpadleft( string , final length , string to be used to pad 
              with )

    This function is the same as FNpadright except that the string 
given is to the right of the padding.

       Example:     PRINT FNpadleft("hello",10,"*")
                    would print '*****hello'

 26:PROCquickbestfit( length of array )

    This procedure is identical to PROCbestfit except that it  can 
only  use 'datax' and 'datay' for its arrays.Because the  computer 
knows  which  arrays  the data will be in it can be  made  to  run 
faster.

        Example:     to find the line of best fit for the three       
                     points (1,1),(3,6),(5,3):
                     DIM datax(3),datay(3)
                     datax(1)=1:datay(1)=1
                     datax(2)=3:datay(2)=6
                     datax(3)=5:datay(5)=3
                     PROCquickbestfit
                     PRINT "gradient of line = ";gradient
                     PRINT "intercept on Y-axis = ";intercept
 27:PROCquickhilo( length of array )

    This procedure is identical to PROChilo except that it only
 uses  the array 'data'.It is therefore more limited  but  notably 
faster  than PROChilo.It is ideal for programs  only  manipulating 
one array.

 28:FNquickmean( length of array )

     This function is identical to FNmean except that it can  only 
use 'data' as its array.

 29:PROCquickmode( length of array )

     This  procedure is the same as PROCmean except  that  it  can 
only use 'data' as its array.

 30:PROCquicksort( starting place , finishing place )

    This procedure is the same as PROCquicksort except that it can 
only use 'data' as its array.

 31:FNquicktotal( length of array )

     This function is the same as FNtotal except that it can  only 
use 'data' as its array.

 32:PROCXrotation( angle of rotation , start , end )

     This procedure rotates the coordinates specified about the 
X-axis. The  coordinates  should be held in  the global  arrays 
X(n),Y(n) and Z(n).The values "start" and "end" signify the 
starting and ending point for the rotation.See the example 
program "ROTATE.EXM" for an example of its use.
    Note  that  the  values  in  X(n)  do not  change in this 
procedure.

 33:PROCYrotation( angle of rotation , start , end )

     This procedure rotates the coordinates specified about the 
Y-axis. The  coordinates  should be held in  the global  arrays 
X(n),Y(n) and Z(n).The values "start" and "end" signify the 
starting and ending point for the rotation.See the example 
program "ROTATE.EXM" for an example of its use.
    Note  that  the  values  in  Y(n)  do not  change in this 
procedure.

 34:PROCZrotation( angle of rotation , start , end )

     This procedure rotates the coordinates specified about the 
Z-axis. The  coordinates  should be held in  the global  arrays 
X(n),Y(n) and Z(n).The values "start" and "end" signify the 
starting and ending point for the rotation.See the example 
program "ROTATE.EXM" for an example of its use.
    Note  that  the  values  in  Z(n)  do not  change in this 
procedure.


 35:PROCsetupscreentwo

     This procedure reserves 33K of memory and adjusts  its  start 
address so that it can be used as a screen address.It returns  the 
second screen address in the variable 'screentwo' and the  address 
fot the present screen in the variable 'screenone'.These can  then 
be used in screen-flipping by alternately setting PHYSBASE to  one 
address and LOGBASE to the other.
  The  variable 'screentwo' can also be used as the  address  when 
loading a picture off disc(possibly using PROCloadpic).

 36:PROCsort( array name , starting place , finishing place )

     This  procedure  sorts the  specified  array  into  numerical 
order.

 37:PROCsound( channel , volume , pitch , duration )

    This procedure plays a note with the variables defined on  the 
specified channel.
     The channel can be 0-3 (0 is a 'white noise' channel)
     The volume can be 0-15 (0=soft 15=loud)
     The pitch can be 0-2030 (0=low 2030=high)
     The duration can be 0-255 (0=short 255=long)
  Note that before the procedure is used for the fisrt time  space 
must be reserved using the command:
              RESERVE Sound%,20

 38:PROCinitsprites

    This procedure reserves 32K for the sprite data and background 
screen  data.It  sets  up the data for  BLITing  the  sprites  and 
assembles  the  machine code collision detection  routine.It  also 
reads  the  data  for the sprites.This data  is  arranged  in  the 
following way;
  The  first line of each sprite definition  contains  information 
about the sprite number,its width and height,ie.
        DATA sprite no.(1-4),width(0-99),height(0-49)
   eg.  DATA 1,12,34  : sprite no. 1 with width 12 pixels and 
                        height 34 pixels
  The  next few lines contain the information about  each  pixel's 
colour,0 or 1 in monochrome,0-3 in medium resolution and 0-15  in 
low resolution.
 eg. if the first line in sprite 1 (width 12) was
        DATA 2,2,2,2,2,2,3,3,3,3,3,3
     then the top of the sprite would be half green and half red.
    33  lines  of data would then follow (one for  each  pixel  of 
    height)

  This is then repeated for any other sprites (up to a maximum  of 
4) with a 0 at the end of the whole thing to signify the end.

 39:PROCspriteon( sprite number , X co-ordinate , Y co-ordinate )

     Once the sprites have been set up  using  PROCinitsprites,you 
can   put  your  sprites  anywhere  on  the  screen   using   this 
procedure.To move a sprite form one position to another,just  call 
this   procedure   again  with  new   co-ordinates.The   procedure 
automatically  replaces  the  old screen contents  and  moves  the 
sprites to the new specified co-ordinates.

       Example:      to move sprite 1 across the screen
                     FOR x%=50 TO 300 STEP 2
                     PROCspriteon(1,x%,100)
                     NEXT x%

 40:FNcollision( sprite number )

      This  function  checks to see whether the  sprite  has  been 
printed over anything but the background colour (0).If it has then 
the colour number which it has hit is returned.

 41:PROCsettime( time as a string )

       This  procedure  converts  the time  given  in  the  format 
"Hours:minutes:seconds"  to  a binary number before  reseting  the 
internal clock.

      Example:       To set the time to 7:34 and 20 seconds pm
                     PROCsettime("19:34:20")


 42:PROCtitle( title )

       This  procedure prints the title specified  underlined  and 
resets the effects to give normal text afterwards.

 43:FNtotal( array name , length of array )

        This function finds the total sum of the elements  in  the 
array specified.

 44:PROCwaitbutton
 
      This procedure waits until the left mouse button is  pressed 
before returning.

 45:FNwords( string )

       This function returns the number of words in the string.

4: The Example Programs 

   These can be found in the extention ".EXM" (you will have to
change the directory to *.EXM in the file selection box). 
