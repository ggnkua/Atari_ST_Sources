06601030305800
F0110030
9[.......................................................]011
ÅMandelbrotandJuliaSets

Äby

MikePiff

     TheMandelbrotandJuliasetsareobtainedfromthemathematical
functionÑf(z)=zî2Ñ+cÄbyrepeatedlyiteratingit.FortheMandelbrot
sets,westartwithÑz=0Ä,andseewhethertheiteratesofÑfÄremain
bounded.Ifso,thenÑcÄisintheMandelbrotset.WiththeJuliaset,
wechooseafixedinitialvalueofÑcÄ,andthencheck,foreach
startingvalueofÑzÄwhethertheiteratesremainbounded.Thusthereis
adifferentJuliasetforeachinitialÑcÄ,butonlyoneMandelbrotset.
     However,allthishappensinthecomplexplane,sotheactual
formulaeweareworkingwithare:
Ñx:=xî2Ñ-yî2Ñ+a,y:=2xy+b,
ÄwhereÑz=x+iy,c=a+ib.
Ä     ThedifferencebetweenaMandelbrotandaJuliasetisthatwith
theMandelbrotset,westarttheiterationswithÑz=0,ÄandapointÑcÄis
inthesetiftheiteratesremainbounded,ie,ifallof
Ñ0,c,cî2Ñ+c,(cî2Ñ+c)î2Ñ+c,ÄetcÑ,
Äareboundedinsize,withafixedbound.WiththeJuliaset,westart
withafixedc,thenforeachz,wetestwhetherallof
Ñz,zî2Ñ+c,(zî2Ñ+c)î2Ñ+c,Äetc,
remainbounded.
     Themainproblemindrawingthesetsisthenumberofiterations
involvedindecidingwhetherornottheiteratesareorarenotgoing
offtoinfinity.Althoughabout100iterationswillgivereasonable
definitiononthewholeMandelbrotset,sometimesthedetailswill
onlyshowupwhenseveralthousandareused.Evenfor100iterations,
anaiveÑFastBasicÄprogramwilltakeperhapsonehourtorunto
completion,andsosomesortofspeedupisessential.Afulllow
resolutionscreenwilltakeupto6,400,000iterationstocomplete.
Thustheuseofmachinecodewouldseemessential.
     ThisprogramusesamixtureofÑFastBasicÄandassemblylanguage
todrawtheMandelbrotsetinaboutsixminutes,to125iterations.It
isthenpossibletozoomintoasmallareaoftheboundaryoftheset
anddrawthistothesameorhigherresolution,andrepeatthis
processtothelimitsoftheprogram.Alternatively,apointcanbe
chosen,anditsJuliasetdrawn,thenmagnifiedinthesameway.The
entireMandelbrotsetiscontainedwithintherectanglefromÑx=-2Äto
Ñx=0.75ÄandfromÑy=-1.5ÄtoÑy=1.5,Äsothereisnoneedtoconsider
pointsoutsidethisregion.Juliasets,ontheotherhand,varyin
sizedependingonthevalueofÑcÄ;however,alltheinteresting
exampleswillfitintothescreensizesetbydefaultintheprogram.
Thereisanoptiontochangethisifyourequire.
     Theplottingroutinehasbeendesignedtoscatterplottedpoints
overthescreen,ratherthanjustscanthescreenserially.Thismeans
thatagoodideacanbehadofwhatthesetbeingplottedlookslike
afteronlyafewseconds.Sometimesthismeansthatyoucanzoominon
asmallportionofthesetataquiteearlystage.Thevariablewhich
controlsthisisÑstpsize%Ä.Settingthisto1givesasimplescan.
     Theassemblypartoftheprogramdoestheactualiterationsfor
eachpixel.AvariableÑshift%Äisusedtostoreapoweroftwo,sothat
Ñscale%=2îshift%
Äpixelsrepresentoneunitofdistance.ThevariablesÑxÄandÑyÄarethen
convertedtointegervariablesÑx%=x*scale%Ä,andÑy%=y*scale%Äforuse
inthecalculations.Similarly,aandbarereplacedbya%andb%.Our
iterationcalculationsarethenreplacedby:
x%=((x%-y%)*(x%+y%))>>shift%+a%,
y%=(2*x%*y%)>>shift%+b%.
Thispartofthecalculationisexecutedinassemblylanguage.Also,
|Ñx%+y%Ä|istestedagainstÑ4*scale%Äasaconditionforexitfromthe
iteration.
     ThebodyoftheprogramissetuptoworkwithÅGEMÄasinthe
exampleprogramssuppliedwithÑFastBasicÄ.TheitemsintheMenuhave
thefollowingmeaning.
ÅLoadScreenÄ.Loadapreviouslydrawnorpartlydrawnscreen.ÅFast
BasicÄ'sfileselectionhasbeenchangedsothatanullfilenamedoes
notcauseasystemcrash.
ÅSaveScreenÄ.Savethecurrentscreen.Uptothreescreenscanbe
activeatanytimeinthisversion,soitispossibletorunthe
programona520ST.Ownersofa1040STcaneasilymodifytheprogram
toaccceptmorescreens.
ÅNewScreenÄ.Workwithanewscreen,ofthethreeavailable.The
programstartsuponÅScreen1Äbydefault,andsearchesforafile
'BOOT4.SC'inmediumresolution,or'BOOT16.SC'inlowresolution.If
neitherisfound,thentheÅRunÄparametersaresettodrawthe
correspondingMandelbrotset.Thisshouldbesavedintheappropriate
filewhenfinished.Theprogramwillthenbootitselfatthenext
startupwiththesavedfile.IfwechangetheÅRunÄparameterslateron,
anddrawanotherscreen,thiswilloverwritetheÅScreen1Äpicture
unlesswemovetoÅScreen2ÄorÅScreen3Ä.Afterthetwoextrascreenshave
beencalled,itispossibletomovebetweenthembyclickingintheir
Menuoptions.
ÅScreenCoordinatesÄ.Analertboxisdrawncontaininginformationabout
thecurrentscreen.Thiswillinitiallybesettoplotafull-size
Mandelbrotset.
ÅClearScreenÄ.Clearcurrentscreen.Itisnevernecessarytodothis,
butitmightbeusefulto'mark'anuninterestingornolongerneeded
screen.
ÅViewÄÅScreenÄ.Displaycurrentscreen.Pressthespacebaroralmostany
keytoremovethedisplay.
ÅRunÄ.Usingthecurrentscreen,andcurrentÅRunÄparameters,start
drawingaMandelbrotorJuliaset.Thiswilloverwritethecurrent
screen.Whenthedrawingisfinished,thedesktopwillreappear.
However,apartly-drawnscreencanbepausedbypressingthespace
bar.ÅContinueÄwillthenresumedrawingit.
ÅZoomÄ.Thecurrentscreenisdisplayed,andazoomboxcanbemoved
aroundthescreenusingthemouse.Clickingtheleftmousebuttonwill
settheÅRunÄcoordinatestothedimensionsofthisbox.
ÅContinueÄ.Continuedrawingthepartly-drawncurrentscreen,usingthe
sameÅRunÄparameters.Thiswillchecktoseewhetherthescreenis,in
fact,completelydrawn,andwillthenreturntothedesktop.Any
previouslysetÅRunÄparameterswillbelost.
ÅRefineÄ.IfthecurrentscreenhasbeendrawninÅAlternatingColourÄ,
andthecurrentlysetnumberofiterationsisatleastequaltothat
usedindrawingthescreen,theneachpointdrawninblackwillbere-
Ätestedtothenewnumberofiterationstoseewhetheritisstillto
bedrawnblack.Thisoption,ifselected,shouldbelefttorunto
completion.
ÅJuliaSetÄ.IfthecurrentscreenshowsaMandelbrotset,thenthis
willbedisplayed,andthemousesettoapointinghand.Clickingon
theleftmousebuttonwillsetthecorrespondingcoordinatesforÑcÄ.
ÅReinitialiseÄ.DropanychangedÅRunÄparametersandsetthembacktothe
onesactiveonthecurrentscreen.Thisisdoneautomaticallyby
ÅContinueÄ.
ÅRunCoordinatesÄ.DisplayanalertboxwiththecurrentÅrunÄcoordina
tes.
ÅSetCoordinatesÄ.Atext-basedsystemisusedtoinputtheÅRunÄ
parameters.Theseparametersareaflagforwhetheryouareplottinga
Juliasetornot;thelowvalueofÑxÄandhighvalueofÑyÄusedtoset
thecoordinatesofthetoplefthandcornerofthescreen;thewidthof
thescreen,ie,therangeofvaluesofÑxÄ;andfinally,foraJulia
set,thevaluesofÑaÄandÑbÄinÑc=a+ÄiÑbÄ.Thecurrentvaluesofthe
parametersareindicatedinbrackets.Ifyoudonotwanttochangeany
ofthese,pressreturn.Also,thewidthisroundedtothenearest
permissiblevalue.
ÅLogarithmicColourÄ.PointsoutsidetheJuliaorMandelbrotsetare
colouredaccordingtothenumberofiterationsneededbeforethe
iterateslieoutsideadiamondcentredontheoriginofside4.Once
aniterateliesoutsidethisdiamond,thenitisassuredthatthe
iterateswilltendtoinfinity.BlackisusedtoplottheMandelbrot
set,andasecondcolourforpointswhichhavenotyetbeenplotted.
Theothercolours(14or2accordingtothemode)arethenused
progressivelytoshadeinfrominfinitytotheset.WithÅAlternating
ColourÄ,eachextraiterationneededusesanewcolour,andwhenthe
totalnumberisexceeded,thecoloursareusedcyclicallyagain.The
ÅRefineÄoptioncanthusonlybeusedwiththissecondmethodof
plotting.
Å125ÄtoÅ4000IterationsÄ.Thenumberofiterationsusedtodecide
membershipoftheMandelbrotorJuliaset.Asthemagnificationused
inplottingincreasesbyrepeateduseofÅZoomÄ,thisnumbershouldbe
increasedprogressively,elsedetailwillbelost.
ÅTimes2ÄtoÅ32Ä.ThiscontrolsthemagnificationusedinoneÅZoomÄ.The
zoomboxchangessizeaccordingly.

     Theprogramshouldberunwith150Kofworkspace.


Å
