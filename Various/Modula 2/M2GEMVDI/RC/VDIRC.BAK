MODULE VDIOPEN;
IMPORT AESApplications;
IMPORT AESGraphics;
IMPORT VDIControls;
IMPORT GEMVDIbase;
IMPORT AESEvents;
IMPORT VDIAttribs;
IMPORT VDIOutputs;
IMPORT GEMAESbase;
FROM  DRAWINRC IMPORT DRAWRC;

 VAR
        APPL,HANDLE,MAXW,MAXH,KEY,I,WCHAR,HCHAR,WBOX,HBOX:INTEGER;
        WORKIN:GEMVDIbase.VDIWorkInType;
        WORKOUT:GEMVDIbase.VDIWorkOutType;


BEGIN
        APPL:= AESApplications.ApplInitialise();
        HANDLE:=AESGraphics.GrafHandle(WCHAR,HCHAR,WBOX,HBOX);
        AESGraphics.GrafMouse(GEMAESbase.MouseOff,NIL);
        VDIControls.ClearWorkstation(HANDLE);
        FOR I:= 0 TO 10 DO; 
            WORKIN[I]:=1;
        END;
        WORKIN[10]:= 2; (* RC *)
        VDIControls.OpenVirtualWorkstation(WORKIN,HANDLE,WORKOUT);
        MAXW:=WORKOUT[0]; MAXH:=WORKOUT[1];
        DRAWRC(HANDLE,0,0,MAXW,MAXH);
        VDIOutputs.GraphicText(HANDLE,MAXW,MAXH,'PRESS ANY KEY TO CONTINUE');
        KEY:=AESEvents.EventKeyboard();
        VDIControls.CloseVirtualWorkstation(HANDLE);
        AESApplications.ApplExit;
END VDIOPEN.
