' BITBLT.LST
' --------------------
DIM s%(8),d%(8),p%(8)
'
' cr‚ation du texte
a$="Voici une d‚monstration portant sur une "
b$="ligne trŠs longue … faire d‚filer. La mo"
c$="dification des paramŠtres GET rend cela "
d$="trŠs facile. Votre curiosit‚ est piqu‚e?"
DEFTEXT 1,0,0,32
TEXT 0,24,a$
TEXT 0,56,b$
TEXT 0,88,c$
TEXT 0,120,d$
'
' affectation de ce graphique
GET 0,0,639,127,graphique$
d%=VARPTR(graphique$)
'
PRINT AT(30,13);"Appuyez sur une touche s.v.p."
VOID INP(2)
'
@bitblt_sd(XBIOS(2),640,400,1,d%+6,2560,32)
FOR y%=0 TO 127 STEP 32
  @bitblt_p(0,y%,639,31,y%*20,0,3)
NEXT y%
'
d%=VARPTR(graphique$)
' mettre les nouveaux paramŠtres GET
DPOKE d%,640*4-1
DPOKE d%+2,128/4-1
'
' d‚filement
CLS
FOR y%=64 TO 350 STEP 64
  FOR x%=320 TO -640*3 STEP -1
    PUT x%,y%,graphique$
  NEXT x%
NEXT y%
'
EDIT
'
PROCEDURE bitblt_sd(s0%,s1%,s2%,s5%,d0%,d1%,d2%)
  s%(0)=s0%
  s%(1)=s1%
  s%(2)=s2%
  s%(3)=s1%/16
  s%(5)=s5%
  d%(0)=d0%
  d%(1)=d1%
  d%(2)=d2%
  d%(3)=d1%/16
  d%(5)=s5%
RETURN
'
PROCEDURE bitblt_p(p0%,p1%,p2%,p3%,p4%,p5%,p8%)
  p%(0)=p0%
  p%(1)=p1%
  p%(2)=p0%+p2%
  p%(3)=p1%+p3%
  p%(4)=p4%
  p%(5)=p5%
  p%(6)=p4%+p2%
  p%(7)=p5%+p3%
  p%(8)=p8%
  BITBLT s%(),d%(),p%()
RETURN
