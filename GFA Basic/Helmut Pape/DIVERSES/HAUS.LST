' Name: HAUS
'
DIM a(8),e(8),v(8),w(8),z(8),x(5),y(5)
'
CLS
PRINT "      Dieses Programm sucht alle Lîsungen eines bekannten Problems :"
PRINT
PRINT "      Wie zeichnet man die 8 Verbindungsstrecken der 5 Punkte"
PRINT "      dieses HÑuschens mit einem Strich ohne abzusetzen ?"
'
PRINT AT(37,6);"1"
PRINT AT(30,10);"2               3"
PRINT AT(30,16);"4               5"
PRINT AT(2,24);"Schnell ein/aus : s       Einzelschritt ein/aus : e         Programmende: Esc"
'
' a(1...8) und e(1...8) sind die Anfangs- bzw. Endpunkte der 8 Strecken.
' Es sind 8 Strecken, die Liste besitzt aber noch den Eintrag Nr. 0,
' dies erleichtert das Suchen nach einer freien Strecke.
'
' v(n)=1, wenn die Strecke Nr. n schon beschritten wurde.
'
' In w(0...8) stehen die Nummern der Punkte in der Reihenfolge,
' in der sie durchlaufen werden. Bei einer Lîsung sind es 9 Punkte !
'
' Die Liste z(0...8) enthÑlt zu jedem der bereits durchlaufenen
' Punkte die Stufenzahl.
' Diese gibt an, wie weit wir bei dem betreffenden Punkt auf der Suche
' nach Fortsetzungsstrecken in der DATA-Liste schon gekommen sind.
'
FOR n=0 TO 8
  READ a(n),e(n),v(n),w(n)
NEXT n
'
DATA 0,0,0,4
DATA 1,2,0,2
DATA 1,3,0,1
DATA 2,3,0,3
DATA 2,4,0,5
DATA 2,5,0,4
DATA 3,4,0,3
DATA 3,5,0,2
DATA 4,5,0,5
'
FOR n=1 TO 5
  READ x(n),y(n)
NEXT n
'
DATA 300,100,250,150,350,150,250,250,350,250
'
hier=8
zeichne
PAUSE 200
loesche
'
loesungsnummer=1
'
' FÅr jeden mîglichen Anfangspunkt werden nun alle bei ihm beginnenden
' Lîsungsstrecken gesucht.
'
einzelschritt=FALSE
schnell=FALSE
'
FOR punkt=1 TO 5
  '
  PRINT AT(2,20);"Lîsungen mit Anfangspunkt ";punkt
  PAUSE 100
  PRINT AT(4,22);"keine"
  '
  ' Die Variable 'hier' enthÑlt die Nummer des gerade erreichten Punktes.
  '
  hier=0
  '
  w(hier)=punkt       ! Da fangen wir an.
  '
  z(hier)=9
  '
  REPEAT
    '
    e$=INKEY$
    '
    IF hier=8
      PRINT AT(2,22);"   ";loesungsnummer;"   "
      INC loesungsnummer
      PRINT AT(20,22);w(0);"  ";
      FOR x=1 TO 8
        PRINT w(x);"  ";
      NEXT x
      PRINT "           Taste !";
      REPEAT
        e$=INKEY$
      UNTIL e$<>""
    ENDIF
    '
    IF einzelschritt=TRUE
      REPEAT
        e$=INKEY$
      UNTIL e$<>""
    ENDIF
    REPEAT
    UNTIL INKEY$=""
    EXIT IF e$=CHR$(27)
    IF e$="s"
      schnell=NOT schnell
    ENDIF
    IF e$="e"
      einzelschritt=NOT einzelschritt
    ENDIF
    IF einzelschritt=TRUE
      PRINT AT(54,24);"*";
    ELSE
      PRINT AT(54,24);" ";
    ENDIF
    IF schnell=TRUE
      PRINT AT(22,24);"*";
    ELSE
      PRINT AT(22,24);" ";
    ENDIF
    '
    a(0)=w(hier)
    REPEAT
      DEC z(hier)
    UNTIL (a(z(hier))=w(hier) OR e(z(hier))=w(hier)) AND v(z(hier))=0
    '
    IF z(hier)=0                     ! keinen Weg gefunden
      '
      DEC hier                       ! einen Schritt zurÅck
      IF hier>=0                     ! falls wir nicht am Anfangspunkt sind:
        v(z(hier))=0                 ! vorige Strecke freigeben
        n=hier
        loesche_strecke
      ENDIF
      '
    ELSE                             ! Weg gefunden
      '
      v(z(hier))=1                   ! als verwendet markieren
      IF w(hier)=a(z(hier))          ! den
        w(hier+1)=e(z(hier))         ! richtigen
      ELSE                           ! Punkt
        w(hier+1)=a(z(hier))         ! der Strecke
      ENDIF                          ! eintragen
      n=hier
      zeichne_strecke
      INC hier
      z(hier)=9
      '
    ENDIF
    '
    ' Wenn wir hinter den Anfangspunkt zurÅck mÅûten, gibt es keine
    ' weiteren Lîsungen mit diesem Anfangspunkt
    '
  UNTIL hier<0
  '
  EXIT IF e$=CHR$(27)
  '
NEXT punkt
'
PROCEDURE zeichne
  FOR n=0 TO 7
    zeichne_strecke
  NEXT n
RETURN
'
PROCEDURE loesche
  COLOR 0
  FOR n=0 TO 7
    DRAW x(w(n)),y(w(n)) TO x(w(n+1)),y(w(n+1))
  NEXT n
RETURN
'
PROCEDURE zeichne_strecke
  COLOR 1
  x=x(w(n))
  y=y(w(n))
  vx=SGN(x(w(n+1))-x(w(n)))
  vy=SGN(y(w(n+1))-y(w(n)))
  REPEAT
    DRAW x,y
    IF schnell=FALSE
      PAUSE 0
    ENDIF
    x=x+vx
    y=y+vy
  UNTIL x=x(w(n+1)) AND y=y(w(n+1))
RETURN
'
PROCEDURE loesche_strecke
  COLOR 0
  x=x(w(n+1))
  y=y(w(n+1))
  vx=SGN(x(w(n+1))-x(w(n)))
  vy=SGN(y(w(n+1))-y(w(n)))
  REPEAT
    DRAW x,y
    IF schnell=FALSE
      PAUSE 0
    ENDIF
    x=x-vx
    y=y-vy
  UNTIL x=x(w(n)) AND y=y(w(n))
RETURN
