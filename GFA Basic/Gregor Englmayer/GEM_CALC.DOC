                            G E M - C A L C   1.92
                            ----------------------
                                   (c) 1988

                                      von

                                Gregor Englmayer
                                Weienbach  30/2
                                A-8813 St. Lambrecht

  ***************************************************************************



  GEM-CALC ist ein einfaches Tabellenkalkulationsprogramm mit einer gewissen
  Einbindung einer GEM-Benutzeroberfl„che (Pull-Down-Mens) sowie der
  M”glichkeit Daten grafisch darzustellen. Es ist geschrieben in GFA-BASIC
  2.0 und mit dem GFA-Compiler V2.02 compiliert. Fr einen Teil der
  Grafikroutinen bedanke ich mich bei Johannes Fiedler, der sie in seinem
  Programm 'Datobert' als PD-Programm ver”ffentlicht hat. GEM-CALC l„uft
  sowohl in hoher als auch in mittlerer Aufl”sung.



  BESCHREIBUNG
  ------------

  AUFBAU DES ARBEITSBLATTES

  Das Arbeitsblatt besteht aus max. 26 Spalten (A bis Z) und 200 bis 999
  Zeilen (1 bis 999), d.h. es stehen 5200 Zellen zur Verfgung, von denen
  natrlich nur ein kleiner Teil (ca. 19 bis max. 1325 in hochaufl”sender
  Darstellung) auf dem Bildschirm Platz findet. Die Breite der Spalten, die
  Zahl der Nachkommastellen und die Beschriftung der Kopfzeile ist variabel
  gestaltet und kann vom Benutzer eingestellt werden.

  BILDSCHIRMAUFBAU

  Der Bildschirm ist in mehrere Bereiche horizontal gegliedert. Die oberste
  Zeile ist die Menzeile, wo aus den entsprechenden Pull-Down-Menpunkten
  die Funktionen ausgew„hlt werden k”nnen. Alle Funktionen in den
  Pull-Down-Mens k”nnen auch ber die Tastatur angesprochen werden
  (Beschreibung siehe unten).
  Unter der Menzeile steht das Copyright (nur s/w), darunter befindet sich
  dann die Eingabezeile. Hier steht der aktuelle Inhalt der Speicherstelle,
  in der der Cursor steht, und es k”nnen Daten, Formeln und Text eingegeben
  oder ver„ndert werden.
  Unter der Eingabezeile sind die Spaltenindizes (A bis Z) angezeigt,
  darunter dann ein Ausschnitt aus dem Arbeitsblatt. Die oberste Zeile ist
  die Kopfzeile, die nach Starten des Programms durch die Buchstaben A bis Z
  die Spalten kennzeichnet und vom Benutzer ver„ndert werden kann. Die
  Zeilennummern sind in der Spalte links auen angefhrt. Die aktive Zelle,
  in der sich der Cursor befindet, ist invers dargestellt.
  Die unterste Zeile des Bildschirms ist als Infozeile gestaltet. Sie zeigt
  (von links nach rechts) die Zelle an, in der sich der Cursor gerade
  befindet, die gemerkte Zelle, die Begrenzungszellen fr einen definierten
  Block (dazu sp„ter), die Breite des Blocks, die Breite des benutzten
  Bereiches des Arbeitsblattes, eine eventuell aktive Funktion oder die Gr”e
  des Blattes und den freien Speicherplatz.
  Auf der rechten Seite des Bildschirms befinden sich noch zwei
  Schieberegler. Diese dienen dazu, mit der Maus schnelle Bewegungen
  innerhalb des Arbeitsblattes zu erreichen. Der obere Schieber ist fr die
  Einstellung der Spalte, der untere fr die Einstellung der Zeile
  zust„ndig.


  BEWEGUNG INNERHALB DES ARBEITSBLATTES

  Der Cursor kann innerhalb des Arbeitsblattes mit den Cursortasten bewegt
  werden. 5 Spalten nach links oder rechts bzw. 20 Zeilen nach oben oder
  unten gelangt man mit 'Shift + Cursor'. In die jeweilige Randzelle des
  benutzten Bereiches gelangt man mit 'Control + Cursor'. Von jeder Stelle
  des Blattes gelangt man durch Drcken der Taste 'Clr Home' in die Zelle A1.
  Durch Drcken der Tastenkombination 'Control + Clr Home' gelangt man in die
  rechte untere Zelle des benutzten Bereiches. Siehe auch F8.
  Man kann den Cursor innerhalb des auf dem Bildschirm sichtbaren Bereiches
  des Arbeitsblattes auch mit der Maus positionieren. Diese M”glichkeit
  arbeitet jedoch nicht bei Blockoperationen.
  Weitere Entfernungen k”nnen mit der Maus mittels der Schieberegler
  bew„ltigt werden. Man kann im oberen Schiber entweder die Pfeile anklicken
  oder die Anzeigelinie mit festgehaltener linker Maustaste verschieben. Beim
  unteren Schieberegler gibt es hehr M”glichkeiten: Anklicken der
  Einzelpfeile verschiebt den angezeigten Bereich um eine Zeile, anklicken
  der Doppelpfeile um 100 Zeilen, anklicken des grauen Bereiches ober- bzw.
  unterhalb des weien Bereiches (der die relative Position im Blatt
  darstellt) verschiebt den angezeigten Bereich um zehl Zeilen, zus„tzlich
  kann der weie Bereich mit festgehaltener Maustaste verschoben werden.
  Sobald der Bereich der Schieberegler verlassen wird, wird der Bildschirm
  neu aufgebaut.

  Help

  Mit einem Druck auf die Help-Taste gelangt man in den Help-Screen, wo die
  zur Verfgung stehenden Funktionen und Befehle aufgezeigt werden.





  EINGABE VON TEXT, DATEN, FORMELN UND KOMMENTAREN

  Um Daten etc. in eine Zelle einzugeben, beginnt man einfach zu tippen. Die
  Beendigung der Eingabe erfogt mit der 'Return' oder den Cursor-Tasten. Die
  Korrektur von Fehlern kann mit 'Backspace' erfolgen. Ein in der Zelle
  vorhandener Inhalt wir durch die Neueingabe ersetzt. Wenn man die Eingabe
  ohne šbernahme in die Zelle (weil etwa der Inhalt nicht ver„ndert werden
  soll) beenden will, so erreicht man dies mit 'Esc' oder 'Undo'. Soll ein
  vorhandener Inhalt nur ver„ndert werden, so sollte man den Edit-Modus
  w„hlen (siehe Funktionstastenbelegung). Eine Zelle kann maximal 77 Zeichen
  enthalten.


  Eingabe von Text
  Einfach Eintippen und 'Return' oder eine Cursortaste drcken.


  Eingabe von Zahlen
  Einfach Eintippen und 'Return' oder eine Cursortaste drcken.

  Eingabe von Formeln
  Das erste Zeichen eines Feldes, in dem eine Formel steht, mu unbedingt ein
  '='-Zeichen sein. Dann k”nnen Formeln und Funktionen folgen (siehe unten).

  Eingabe von Kommentaren
  In jede Zelle kann nach einer Eingabe von Text, Zahlen oder Formeln noch
  ein Kommentar angefgt werden (wenn noch Platz ist). Dazu gibt man ' !'
  (ein Leerzeichen und ein Ausrufungszeichen) und anschlieend den Kommentar
  ein.


  OPERATOREN

  Als mathematische Operatoren in Formeln sind folgende Zeichen erlaubt:

      () Klammern
      ^  Potenzierung
      *  Multiplikation   /  Division
      +  Addition         -  Subtraktion

  Diese Operatoren werden gem„ den normalen Regeln der Mathmatik angewandt,
  also in der Reihenfolge und Wertigkeit wie in der Tabelle.


  FUNKTIONEN I

  Formeln k”nnen auch folgende Funktionen enthalten:

      #PI    Pi=3.1415...
      #DAT   gibt das Datum aus (als Text)
      #ABS() berechnet den Absolutwert des Wertes in Klammern
      #INT() berechnet den Integerwert
      #RND() rundet auf die n„chste Integerzahl
      #LOG() berechnet des natrlichen Logarithmus
      #EXP() Wert der natrlichen Exponentialfunktion
      #CLG() berechnet den Zehnerlogarithmus
      #SQR() berechnet die Quadratwurzel
      #SIN() berechnet den Sinus
      #COS() berechnet den Cosinus
      #TAN() berechnet den Tangens
      #ATN() berechnet den Arcustangens
      #FAK() berechnet die Fakult„t
      #NUN(N:n) berechnet 'N ber n' = N!/(n!*(N-n)!)

  S„mtliche Funktionen werden auf den Klammerinhalt angewandt. In den
  Klammern k”nnen Zahlen, Formeln und andere Funktionen enthalten sein.
  Winkelfunktionen k”nnen in Grad oder im Bogenma eingegeben werden (s.
  Control-B).


  FUNKTIONEN II

  Dies sind spezielle Funktionen, die sich auf den Inhalt anderer Zellen
  sttzen:

      #SUM(A1:X100) berechnet die Summe des angegebenen Zellenbereiches
      #AVE(A1:X100) berechnet den Durchschnittswert
      #STA(A1:X100) berechnet die Standardabweichung mit N-1 als Divisor
      #STD(A1:X100) berechnet die Standardabweichung mit N als Divisor
      #MUL(A1:X100) berechnet das Produkt aus dem angegebenen Zellenbereich
      #MIN(A1:X100) berechnet den niedrigsten Wert
      #MAX(A1:X100) berechnet den h”chsten Wert
      #QMW(A1:X100) berechnet den quadratischen Mittelwert (Divisor N-1)
      #QMN(A1:X100) berechnet den quadratischen Mittelwert (Divisor N)

  In den Klammern sind jeweils die linke obere und die rechte untere Zelle
  getrennt durch einen Doppelpunkt anzugeben, die von der Funktion behandelt
  werden sollen. Zellen, die keine numerischen Daten enthalten, werden dabei
  nicht bercksichtigt.



  BEZUG AUF ANDERE ZELLEN

  Um den numerischen Wert einer anderen Zelle zu bernehmen, tippt man '~'
  oder '@' und die Zellkoordinaten ein, also z.B. '~A10'. Diese Ausdrcke
  k”nnen nur in Formeln verwendet werden, z.B.:
  =~A10 oder
  =~A10+@A20*(#SUM(A1:A5))-4*(5+3)^2+#INT(~A100) usw.
  Dabei bewirkt die Verwendung von '@' im Gegensatz zu '~', da diese
  Koordinaten bei relativen Kopier- und Verschiebeoperationen nicht angepat
  werden.



  CONTROL-TASTENKOMBINATIONEN

  Einstellung der Blattbreite  Control-L
  Hier kann die Zahl der Spalten im Bereich von 5 bis 26 eingegeben werden.
  Die L„nge des Blattes „ndert sich entsprechend, soda immer etwa 5000 -
  5200 Zellen zur Verfgung stehen.

  Aktualisieren des benutzten Bereiches  Control-9
  Wenn Teile eines Blattes wieder gel”scht werden, kann es sein, da die
  Tastenkombination Control-ClrHome nicht optimal arbeitet. Mit dieser
  Funktion kann der tats„chlich benuzte Bereich ermittelt werden.

  Aufbau des Arbeitsblattbildschirms  Control-S
  Der Bildschirm mit dem Arbeitsblatt wird neu aufgebaut. Dies ist z.B.
  notwendig nach einer Grafikanzeige oder dem Aufruf eines Accessories (der
  Bildschirm wird nach Aufruf eines Accessories nicht automatisch wieder
  aufgebaut; dies wrde nur bei einem aktiven Fenster m”glich sein, eine
  Gestaltung des Programms mit Fenstern verlangsamt aber den Bildschirmaufbau
  drastisch - von dzt. ca. 0,8 s  auf 2,4 s).

  Zeile einfgen  Control-1
  Eine Zeile in Cursorposition wird eingefgt. Dabei werden
  Koordinatenangaben, die sich auf Zellen unterhalb der eingefgten Zeile
  beziehen, angepat.

  Zeile l”schen  Control-2
  Die Zeile, in der sich der Cursor befindet wird gel”scht. Dabei werden
  Koordinatenangaben, die sich auf Zellen unterhalb der gel”schten Zeile
  beziehen, angepat.

  Spalte einfgen  Control-3
  Eine Spalte in Cursorposition wird eingefgt. Dabei werden
  Koordinatenangaben, die sich auf Zellen rechts der eingefgten Spalte
  beziehen, angepat.

  Spalte l”schen  Control-4
  Die Spalte, in der sich der Cursor befindet wird gel”scht. Dabei werden
  Koordinatenangaben, die sich auf Zellen rechts der gel”schten Spalte
  beziehen, angepat.

  Fehler suchen  Control-O
  Die n„chste Zelle, die eine fehlerhafte Formel enth„lt wird angesprungen.

  Farbwahl  Control-C
  Umschaltung der Bildschirmdarstellung von dunkel/hell auf hell/dunkel.

  Zelle merken  Control-M
  Die Koordinaten der Zelle werden notiert. Anzeige als 2. Angabe von links
  in der Infozeile.

  Zelle absolut kopieren  Control-A
  Die mit 'Control-M' gemerkte Zelle wird absolut in die Zelle, in der der
  Cursor steht, kopiert.

  Zelle relativ kopieren  Control-R
  Die mir 'Control-M' gemerkte Zelle wird relativ (unter nderungen von
  Bezugskoordinaten) in die Zelle, in der der Cursor steht, kopiert.

  Carriage Return mit/ohne Linefeed  Control-P
  Beim Ausdruck wird vom Computer mit jedem Carriage Return (k)ein Linefeed
  ausgegeben.

  Nachkommastellen  Control-N
  Fehlende Nachkommastellen gem„ dem eingestellten Wert (s. F5) werden
  (nicht) mit '0' aufgefllt.

  Ausdruck mit/ohne Trennzeichen  Control-T
  Beim Ausdruck wird zwischen den Zellen ein '!' als Trennzeichen ausgedruckt
  (sonst wird ein Leerzeichen ausgegeben).

  Ausdruck der Zellinhalte  Control-Z
  Die Zellinhalte werden wie sie eingegeben wurden auf dem Drucker
  ausgelistet.

  Grad/Bogenma  Control-B
  Umschalten zwischen Grad/Bogenma zur Eingabe in Winkelfunktionen.

  Help-Screen  Control- oder Help
  Man gelangt in den Help-Screen (siehe Help).

  ?  Control-Y

  Kleinanzeige - High-resolution-Anzeige  Control-K
  Ein gr”erer Teil des Arbeitsblattes wird angezeigt (100 Zeichen Breite, 55
  Zeilen in s/w bzw. 26 in Farbe). Bezugspunkt ist die links oben angezeigte
  Zelle. Hier sind keine nderungen und Cursorbewegungen m”glich. Durch
  Drcken einer Taste oder Maustastendruck gelangt man wieder in den normalen
  Anzeigeschirm.

  Sortieren  Control-X
  Das gesamte Arbeitsblatt wird nach einer Spalte auf- oder absteigend
  sortiert, d.h. wenn nach Spalte B sortiert wird, werden die Spalten A und
  C-Z mitgetauscht. Vorsicht bei Spalten, in denen Funktionen verwendet
  werden, die Bezugskoordinaten werden nicht ge„ndert.

  Titelzeilen  Control-0
  Nach Aufruf dieser Funktion k”nnen die beiden obersten Zeilen als Titel auf
  jeder Seite eines Ausdruckes ausgegeben werden. Dabei kann gew„hlt werden,
  ob nur die Zellen der Spalte A (dafr fast in ihrer ganzen L„nge) oder die
  gesamte Spalte formatiert ausgegeben wird.

  Hardcopy  Control-Q
  Gibt eine Hardcopy des Bildschirms auf dem Drucker aus (nur s/w).

  Abspeichern des Bildschirms  Control-W
  Der Bildschirm wird im Degas-Format gespeichert und kann in diesem
  Grafikprogramm weiter bearbeitet werden.

  Datenbernahme fr Grafikausgabe  Control-U
  Hier werden die Parameter fr die grafische Darstellung von numerischen
  Daten festgelegt. Zuerst mu man sich entscheiden, ob man Spalten oder
  Zeilen nebeneinander ausgeben will. Anschlieend kann man Haupt- und
  Untertitel eingeben.
  Jetzt werden folgende Parameter eingegeben:
   * Y-Offset (Beginn der Beschriftung der Y-Achse)
   * Y-Faktor (Faktor fr die Beschriftung der Y-Achse)
   * Zahl der Reihen (max. 4)
   * oberste Reihe fr die Anzeige: Zeile oder Spalte, je nachdem
   * Reihenbeschriftung: Zeile oder Spalte / nichts / Kopfzeile
   * Zahl der Werte pro Reihe (max. 28)
   * „uerst linker Wert der Reihe(n): Spalte oder Zeile, je nachdem
   * Beschriftung der Werte: Spalte oder Zeile / nichts / Kopfzeile
  Am unteren Bildschirmrand erscheint w„hrend der Eingabe der Daten eine
  Hilfszeile, in der die M”glichkeiten aufgezeigt werden.

  Grafikdaten speichern  Control-5
  Die mit Control-U bernommen Grafikdaten k”nnen auf Diskette gespeichert
  werden.

  Grafikdaten laden  Control-6
  Die mit Control-5 gespeicherten Grafikdaten k”nnen geladen werden.

  Kuchengrafik  Control-D (max. 4*14 positive Werte darstellbar)
  Liniengrafik  Control-E (max. 4*28 Werte darstellbar)
  Balkengrafik  Control-F (max. 4*14 bzw. 2*28 Werte darstellbar)
  Stapelgrafik  Control-G (max. 4*28 positive Werte darstellbar)
  S„ulengrafik  Control-H (max. 4*14 positive Werte darstellbar)
  Blockgrafik   Control-I (max. 4*14 positive Werte darstellbar)
  Fl„chengrafik Control-J (max. 4*14 positive Werte darstellbar)
  Es wird die entsprechende Grafik ausgegeben. Dies funktioniert nur, wenn
  vorher Daten bernommen wurden, s. Control-U. Bei Anzeige der Grafik ist
  nur ein Teil der Control-Funktionen aktiv (Hardcopy, Grafiken,
  Arbeitsblattaufbau). Auerdem sind nur die Grafikfunktionen aktiv, die die
  bernommenen Werte auch darstellen k”nnen. Zur Beendigung der Grafikanzeige
  ist eine dieser Funktionen anzuw„hlen.
  Werte kleiner als der Y-Offset in dargestellten Zellen werden als '=
  Y-Offset' angesehen. Eine Grafikausgabe von kleineren Zellinhalten ist also
  nicht unbedingt zielfhrend. Der Y-Offset kann auch negativ eingegeben
  werden.

  Block - Formeln in Werte wandeln  Control-V
  Die in einem definierten Block (s.u.) in den Zellen enthaltenen Formeln
  werden mit den errechneten Werten gefllt.



  BELEGUNG DER FUNKTIONSTASTEN

  F1 Edit
  Es k”nnen Zelleninhalte ver„ndert werden.

  Shift-F1 Recalc
  Das gesamte Arbeitsblatt wird neu durchgerechnet. Man sollte dies besonders
  dann zwei- bis dreimal durchfhren, wenn man Zelleninhalte definiert hat,
  die sich auf Zellen rechts oder unterhalb dieser Zelle beziehen.

  F2 Block links oben
  Legt die linke obere Ecke des Blockes fest. Ein Block ist ein Teil des
  Arbeitsblattes, der dann verschoben, gedruckt oder auf Diskette gespeichert
  werden kann.

  Shift F2 rechts unten
  Legt die rechte untere Ecke des Blockes fest.

  F3 Laden
  Laden eines Datenfiles von Diskette. Dieses File kann entweder ein gesamtes
  Blatt oder einen Block enthalten. Bei Laden eines Blockes wird dieser mit
  der Cursorposition als linker oberer Ecke in das Arbeitsblatt eingebunden.

  Shift F3 Speichern
  Es kann entweder das ganze Blatt (Filename wird mit dem Extender '.CLC'
  versehen) oder der definierte Block (Filename wird mit dem Extender '.BLK'
  versehen) gespeichert werden. Ein zu speicherndes Blatt kann mit einem Code
  versehen werden, der einen unbefugten Datenzugriff erschwert. Ein einmal
  mit Code gespeichertes Blatt kann nicht mehr ohne Code abgespeichert
  werden, also Codewort gut merken oder ungeschtzte Version als Backup
  ablegen. Der hier verwendete Schutz ist nur sehr einfach und schtzt die
  Daten nicht gegen einen Zugriff etwa mit einem Diskettenmonitor.

  F4 Breite
  Die Breite der Spalte, in der sich der Cursor befindet kann von 3 bis 72
  Zeichen eingestellt werden. Soll der eingestellte Wert nicht ge„ndert
  werden, 'Esc' eingeben.

  Shift F4 Breite aller Spalten
  Die Breite aller Spalten kann global von 3 bis 72 Zeichen eingestellt
  werden. Sollen die eingestellten Werte nicht ge„ndert werden, 'Esc'
  eingeben.

  F5 Komma
  Die Zahl der Nachkommastellen in der Spalte, in der sich der Cursor
  befindet, kann von 0 bis 9 eingestellt werden. Soll der eingestellte Wert
  nicht ge„ndert werden, 'Esc' eingeben.

  Shift F5 Komma aller Spalten
  Die Zahl der Nachkommastellen fr alle Spalten kann von 0 bis 9 eingestellt
  werden. Sollen die eingestellten Werte nicht ge„ndert werden, 'Esc'
  eingeben.

  F6 Copy absolut
  Der definierte Block wird an eine andere Stelle kopiert, ohne da die in
  den Zellen enthaltenen Daten ver„ndert werden. Aussteigen aus dieser
  Funktion mit 'Esc'.

  Shift F6 Copy relativ
  Der definierte Block wird an eine andere Stelle kopiert, wobei in den
  Zellen enthaltene Daten, die sich auf andere Zellen beziehen (also z.B.
  ~A10 oder #SUM(A1:A5)) entsprechend der Blockverschiebung korrigiert
  werden. Aussteigen aus dieser Funktion mit 'Esc'.

  F7 Move absolut
  Wie Copy absolut, nur wird der Block verschoben. Aussteigen aus dieser
  Funktion mit 'Esc'.

  Shift F7 Move relativ
  Wie Copy relativ, nur wird der Block verschoben. Aussteigen aus dieser
  Funktion mit 'Esc'.

  F8 Goto
  Es kann eine Zelle eingegeben werden, in die der Cursor dann gesetzt wird.
  Wird nur 'Return' gedrckt, bleibt der Cursor, wo er ist.

  Shift F8 Kopf
  Die Beschriftung der Kopfzeilen (default A bis Z) kann eingegeben werden.

  F9 Print
  Der gesamte bisher benutzte Teil des Blattes oder der definierte Block kann
  ausgedruckt oder als ASCII-File auf Diskette gespeichert werden (z.B. um
  die Daten in eine Textverarbeitung wie ST-WRITER einzubinden). Dabei wird
  ein Epson-kompatibler Drucker (z.B. Star NL-10) untersttzt.

  Shift F9 Quit
  Verlassen des Programms.

  F10 Clear Zelle
  L”schen des Zelleninhalts der Zelle, in der sich der Cursor befindet.

  Shift F10 Clear all
  Es wird des gesamte Blatt oder der definierte Block gel”scht.




  Fehler

  GEM-CALC bemht sich sehr, alle Fehler, die gemacht werden k”nnen,
  abzufangen. Es wird in einer Alertbox eine Fehlermeldung ausgegeben. In der
  Zelle wird dann '*FEHLER*' ausgegeben.
  Ist eine Zahl zu lang fr die Darstellung in einer Zelle, so wird die Zelle
  mit einer Reihe von '*'-Zeichen gefllt. Um eine Ausgabe der Zahl zu
  erreichen, mu man dann die Spalte verbreitern.


  Tip

  Eine Eingabe von '12/-2' wird als fehlerhaft interpretiert ('/-' werden als
  zwei Operatoren ohne Argumente angesehen), '-12/2' funktioniert
  allerdings.












