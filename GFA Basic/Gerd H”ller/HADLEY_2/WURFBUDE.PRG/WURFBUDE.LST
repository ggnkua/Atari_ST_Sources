CHDIR "a:\hadley_2\wurfbude.prg"
'
' *** Dieses kleine Spiel habe ich aus Langeweile programmiert, vielleicht
' *** kann ja der eine odere andere etwas damit anfangen
' *** Die Bilder des Programms habe ich alle mit einem Zeichenprogramm ge-
' *** zeichnet und dann abgespeichert
'
' *** Danach habe ich das Bild in GFA eingeladen und mit GET die Bereiche
' *** ausgelesen, die ich gebraucht habe. Nun wird das Ganze gespeichert mit:
'
' *** OPEN "O",#1,bildname$
' *** PRINT #1,MKI$(LEN(bildname$));bildname$;
' *** CLOSE #1
'
' *** Konto auffllen
'
konto=100000
'
' *** Die Wrfel einlesen
'
DIM w$(6)
OPEN "i",#1,"wrfel"
FOR x=1 TO 6
  w$(x)=INPUT$(CVI(INPUT$(2,#1)),#1)
NEXT x
CLOSE #1
'
' *** Den Hintergrund einlesen, dabei befindet sich auch das Bild fr
' *** das Geldsetzen und das Setzen der zahlen
'
OPEN "i",#1,"wurfbude"
wurfbude$=INPUT$(CVI(INPUT$(2,#1)),#1)
geldsetz$=INPUT$(CVI(INPUT$(2,#1)),#1)
zahlsetz$=INPUT$(CVI(INPUT$(2,#1)),#1)
CLOSE #1
'
' *** Die letzten Bildchen einlesen
'
OPEN "i",#1,"wurfbutt"
verloren$=INPUT$(CVI(INPUT$(2,#1)),#1)
gewonnen$=INPUT$(CVI(INPUT$(2,#1)),#1)
CLOSE #1
'
' *** den Hintergrund anzeigen
'
PUT 131,100,wurfbude$
'
' *** Jetzt gehts los
'
@wurfbude
'
'
'
PROCEDURE wurfbude
  DEFTEXT 1,,,13
  '
  ' *** Das Geld anzeigen
  '
  GRAPHMODE 1
  TEXT 220,190,"              "
  TEXT 225,190,konto
  TEXT 225,207,"        "
  '
  ' *** den Hintergrund retten
  '
  SGET wurfbude$
  '
  ' *** Transparent schalten
  '
  GRAPHMODE 3
  '
  ' *** Mausabfrage des Bildschirms
  '
  DO
    MOUSE x,y,k
    '
    ' *** Ins Titelfeld geclickt
    '
    IF x>170 AND x<505 AND y>113 AND y<156 AND k=1
      '
      ' *** GROWBOX auf
      '
      abg
      ALERT 1," | Wrfelbude von | Hadley B. Jones | ",1," Aha ",a
      '
      ' *** GROWBOX zu
      '
      abk
    ENDIF
    '
    ' *** Ins Wrfelfeld geclickt
    '
    IF x>463 AND x<518 AND y>164 AND y<266 AND k=1
      abg
      ALERT 1," | Heute keine Sprechstunde | ",1," Aha ",a
      abk
    ENDIF
    '
    ' *** auf setzen geclickt
    '
    IF x>145 AND x<264 AND y>240 AND y<278 AND k=1
      '
      ' *** die Box wird revers
      '
      PBOX 145,239,264,277
      '
      ' *** kurze Pause
      '
      PAUSE 10
      '
      ' *** die Box wird wieder weiž
      '
      PBOX 145,239,264,277
      '
      ' *** zum setzen verzweigen
      '
      GOSUB setzen
    ENDIF
    '
    ' *** das Ende naht
    '
    IF x>277 AND x<413 AND y>241 AND y<278 AND k=1
      abg
      ALERT 1," |Das ist wohl auch besser so! | ",1," Jaja ",a
      abk
      END
    ENDIF
  LOOP
RETURN
'
' *** jetzt aber wirklich
'
PROCEDURE setzen
  '
  ' *** kein Geld mehr da
  '
  IF konto-10<0
    abk
    ALERT 1," | | Du hast kein Geld mehr! ",1," Oje ",a
    GOSUB wurfbude
  ENDIF
  '
  ' *** šbertschreibmodus
  '
  GRAPHMODE 1
  '
  ' *** GROWBOX auf
  '
  abg
  '
  ' *** Bildchen setzen
  '
  PUT 180,135,geldsetz$
  '
  ' *** wieder transparent
  '
  GRAPHMODE 3
  '
  ' *** Mausabfrage
  '
  DO
    MOUSE x,y,k
    '
    ' *** auf die 10 geclickt
    '
    IF x>201 AND x<241 AND y>223 AND y<250 AND k=1
      '
      ' *** Einsatz bestimmen
      '
      einsatz=10
      '
      ' *** Growbox auf
      '
      abk
      '
      ' *** Hintergrund restaurieren
      '
      SPUT wurfbude$
      '
      ' *** kleinen Text ausgeben
      '
      TEXT 225,207,"        "
      TEXT 225,207,einsatz
      '
      ' *** Hintergrund wieder retten (mit neuem Text)
      '
      SGET wurfbude$
      '
      ' *** zum Zahlen setzen
      '
      GOTO zahl
    ENDIF
    '
    ' *** und so weiter, und so weiter
    '
    IF x>242 AND x<299 AND y>223 AND y<250 AND k=1
      einsatz=100
      abk
      SPUT wurfbude$
      TEXT 225,207,"        "
      TEXT 225,207,einsatz
      SGET wurfbude$
      GOTO zahl
      ' 100
    ENDIF
    IF x>300 AND x<380 AND y>224 AND y<249 AND k=1
      einsatz=1000
      abk
      SPUT wurfbude$
      TEXT 225,207,"        "
      TEXT 225,207,einsatz
      SGET wurfbude$
      GOTO zahl
      ' 1000
    ENDIF
    IF x>380 AND x<475 AND y>224 AND y<250 AND k=1
      einsatz=10000
      abk
      SPUT wurfbude$
      TEXT 225,207,"        "
      TEXT 225,207,einsatz
      SGET wurfbude$
      GOTO zahl
      ' 10000
    ENDIF
  LOOP
zahl:
  '
  ' *** Der Rest drfte jawohl jetzt klar sein, oder?????
  '
  GRAPHMODE 1
  SPUT wurfbude$
  abk
  abg
  PUT 180,135,zahlsetz$
  GRAPHMODE 3
  DO
    MOUSE x,y,k
    IF x>269 AND x<284 AND y>192 AND y<216 AND k=1
      PBOX 269,192,284,216
      PAUSE 10
      PBOX 269,192,284,216
      abg
      ALERT 1," | Trottel, wie soll ich denn| mit zwei Wrfeln eine EINS| werfen, h„h? | ",1,"Sorry",a
      abk
      ' 1
    ENDIF
    IF x>284 AND x<309 AND y>192 AND y<216 AND k=1
      abk
      zahl=2
      SPUT wurfbude$
      GOSUB spielen
      ' 2
    ENDIF
    IF x>309 AND x<335 AND y>192 AND y<216 AND k=1
      abk
      zahl=3
      SPUT wurfbude$
      GOSUB spielen
      ' 3
    ENDIF
    IF x>335 AND x<359 AND y>192 AND y<216 AND k=1
      abk
      zahl=4
      SPUT wurfbude$
      GOSUB spielen
      ' 4
    ENDIF
    IF x>359 AND x<384 AND y>192 AND y<216 AND k=1
      abk
      zahl=5
      SPUT wurfbude$
      GOSUB spielen
      ' 5
    ENDIF
    IF x>384 AND x<408 AND y>192 AND y<216 AND k=1
      abk
      zahl=6
      SPUT wurfbude$
      GOSUB spielen
      ' 6
    ENDIF
    IF x>253 AND x<276 AND y>223 AND y<247 AND k=1
      abk
      zahl=7
      SPUT wurfbude$
      GOSUB spielen
      ' 7
    ENDIF
    IF x>276 AND x<301 AND y>223 AND y<247 AND k=1
      abk
      zahl=8
      SPUT wurfbude$
      GOSUB spielen
      ' 8
    ENDIF
    IF x>301 AND x<325 AND y>223 AND y<247 AND k=1
      abk
      zahl=9
      SPUT wurfbude$
      GOSUB spielen
      ' 9
    ENDIF
    IF x>325 AND x<360 AND y>223 AND y<247 AND k=1
      abk
      zahl=10
      SPUT wurfbude$
      GOSUB spielen
      ' 10
    ENDIF
    IF x>360 AND x<385 AND y>223 AND y<247 AND k=1
      abk
      zahl=11
      SPUT wurfbude$
      GOSUB spielen
      ' 11
    ENDIF
    IF x>385 AND x<419 AND y>223 AND y<247 AND k=1
      abk
      zahl=12
      SPUT wurfbude$
      GOSUB spielen
      ' 12
    ENDIF
    IF x>208 AND x<464 AND y>144 AND y<169 AND k=1
      ' info
    ENDIF
  LOOP
RETURN
'
PROCEDURE spielen
  '
  GRAPHMODE 3
  ERASE zahl()
  '
  DIM zahl(2)
  '
  zahl(1)=INT(RND(1)*6)+1
  zahl(2)=INT(RND(1)*6)+1
  '
  PRINT zahl(1)
  PRINT zahl(2)
  '
  FOR t=1 TO 60
    '
    SPUT wurfbude$
    zufall1=INT(RND(1)*6)+1
    '
    PUT 473,173,w$(zufall1)
    '
  NEXT t
  '
  SGET werfen$
  FOR t=1 TO 60
    '
    SPUT werfen$
    zufall2=INT(RND(1)*6)+1
    '
    PUT 473,220,w$(zufall2)
    '
  NEXT t
  '
  '
  geworfen=0
  geworfen=geworfen+zufall1+zufall2
  '
  IF geworfen>zahl OR geworfen<zahl
    OUT 2,7
    PUT 240,170,verloren$
    PAUSE 100
    konto=konto-einsatz
    SPUT wurfbude$
    GOSUB wurfbude
  ENDIF
  IF geworfen=zahl
    OUT 2,7
    PUT 240,170,gewonnen$
    PAUSE 100
    gewinn=0
    gewinn=einsatz*zahl
    konto=konto+gewinn
    SPUT wurfbude$
    GOSUB wurfbude
  ENDIF
  '
RETURN
'
'
PROCEDURE abk
  @schrumpfbox(MOUSEX,MOUSEY,15,15,189,155,261,108)
RETURN
PROCEDURE abg
  @growbox(MOUSEX,MOUSEY,15,15,189,155,261,108)
RETURN
PROCEDURE growbox(xa,ya,b1,h1,xn,yn,b2,h2)
  DPOKE GINTIN,xa
  DPOKE GINTIN+2,ya
  DPOKE GINTIN+4,b1
  DPOKE GINTIN+6,h1
  DPOKE GINTIN+8,xn
  DPOKE GINTIN+10,yn
  DPOKE GINTIN+12,b2
  DPOKE GINTIN+14,h2
  GEMSYS 73+schrumpf%
  schrumpf%=0
RETURN
PROCEDURE schrumpfbox(xa,ya,b1,h1,xn,yn,b2,h2)
  schrumpf%=1
  @growbox(xa,ya,b1,h1,xn,yn,b2,h2)
RETURN
