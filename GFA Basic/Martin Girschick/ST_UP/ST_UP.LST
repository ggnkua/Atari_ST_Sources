.he Name: ON_CUE  /  ST_UP         Datum: \d
.fo von M.Girschick in GFA-Basic 3.5  Seite  #
.n3
REM
REM Dieses Programm steht im Autoordner und startet Programme
REM indem es den Namen der Prg's in das DESKTOP.INF schreibt!
REM
IF BIOS(11,-1)=1 THEN
  PRINT "ST_UP wurde abgebrochen..."
  END
ENDIF
DIM name$(40)
DIM pfad$(40)
DIM ln$(40)
DIM desk$(40)
OPTION BASE 1
'
IF EXIST("ST_UP.SET") THEN
  OPEN "I",#1,"ST_UP.SET"
ELSE
  IF EXIST("C:\AUTO\ST_UP.SET") THEN
    OPEN "I",#1,"C:\AUTO\ST_UP.SET"
  ELSE
    PRINT "Keine Setupdatei (ST_UP.SET) vorhanden!"
    PRINT "Taste drÅcken..."
    ~INP(2)
    END
  ENDIF
ENDIF
setl=1
LINE INPUT #1,wart$
LINE INPUT #1,stand$
LINE INPUT #1,datei$
WHILE NOT EOF(#1)
  LINE INPUT #1,name$(setl)
  EXIT IF EOF(#1)
  LINE INPUT #1,pfad$(setl)
  INC setl
  EXIT IF setl=30
WEND
CLOSE
FOR conv=1 TO setl
  ln$(conv)=SPACE$(30)
  LSET ln$(conv)=name$(conv)
NEXT conv
REM ΩΩ Von Magir                                       ESC ΩΩ
REM
'
'
CLS
PRINT "      Bitte wÑhlen sie die zu startende Datei:"
PRINT "      ----------------------------------------"
PRINT "      von Martin Girschick             ESC    "
PRINT
FOR pr=65 TO 77
  PRINT CHR$(pr);"  ";ln$(pr-64);CHR$(pr+13);"  ";ln$(pr-51)
NEXT pr
PRINT
PRINT "Bitte drÅcken sie A-Z oder warten sie:";
'
w=VAL(wart$)
FOR ia=1 TO w
  wa$=INKEY$
  EXIT IF wa$<>""
  EXIT IF MOUSEK=1
NEXT ia
wa$=UPPER$(wa$)
'
' Pfadname wird ermittelt
'
welcherpfad=(ASC(wa$)-64)
IF welcherpfad<0 OR welcherpfad>40 THEN
  prog$=stand$
ELSE
  prog$=pfad$(welcherpfad)
ENDIF
'
CLS
PRINT
PRINT "  Updating DESKTOP.INF..."
PRINT "  Autostart Programm ist:"
PRINT "  "+CHR$(27)+"p"+prog$+CHR$(27)+"q"
PRINT
'
' Das DESKTOP.INF wird gelesen
'
IF EXIST(datei$) THEN
  OPEN "I",#1,datei$
ELSE
  PRINT "Keine Datei:"+datei$+" vorhanden!"
  PRINT "Bitte Taste drÅcken..."
  ~INP(2)
  END
ENDIF
RECALL #1,desk$(),50,wo
CLOSE
'
' Suche nach der Autostartzeile
' und ihre Korrektur
'
dfound=FALSE
FOR s=1 TO wo
  IF LEFT$(desk$(s),2)="#Z" THEN
    IF prog$="" THEN
      DELETE desk$(s)
      DEC wo
    ELSE
      desk$(s)="#Z 01 "+prog$+"@"
    ENDIF
    dfound=TRUE
  ENDIF
NEXT s
IF dfound=FALSE THEN
  INC wo
  desk$(wo)="#Z 01 "+prog$+"@"
ENDIF
'
' Datei wird wieder geschrieben
'
OPEN "O",#1,datei$
STORE #1,desk$(),wo
CLOSE
PRINT "Fertig!"
END
