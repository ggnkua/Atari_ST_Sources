$U-,s&,s<,P<,E#xt%=2-SGN(XBIOS(4))yt%=MIN(2,3-XBIOS(4))IF xt%=2ALERT 3," |High or Medium.|Bye bye.",1,"OK",al%ENDENDIF' ON ERROR GOSUB fel' ON BREAK CONTGOSUB initMENU menue$()DOON MENU KEY GOSUB keyON MENU GOSUB rull_gardinON MENUk%=MOUSEKIF k% AND MENU(1)<>40GOSUB buttonENDIFLOOP> PROCEDURE initmeny_dat:DATA Desk,  Program info. ,---------------------,a,a,a,a,a,a,"",""DATA ***DIM bufer$(150),bf_nam$(150),lng%(150)DIM menue$(80)s1$=CHR$(27)+"p"s2$=CHR$(27)+"q"file$="A:\*.*"vir_tes&=1RESTORE meny_datCLR i%REPEATREAD menue$(i%)INC i%UNTIL menue$(i%-1)="***"DEFMOUSE 3GOSUB meny_dataGOSUB deskGOSUB bildGOSUB chow_blockGOSUB update_panelRETURN' ##############################MENYN######> PROCEDURE rull_gardinLOCAL a$a$=menue$(MENU(0))MENU OFFMENU KILLWHILE MOUSEKWENDDEFMOUSE 3SHOWMIF a$="  Program info. "GRAPHMODE 1GOSUB infoENDIFGOSUB menu_valRETURN> PROCEDURE buttonMOUSE x%,y%,k%' IF x%>447/xt% AND x%<553/xt% AND y%>25/yt% AND y%<53/yt%' @menue(menu_ant%,540/xt%,30/yt%,560/xt%,300/yt%,*meny$(),*selekt%)' ENDIF' Popupp menynIF k%=2@menue(menu_ant%,0,0,639/xt%,399/yt%,meny$(),selekt%)ENDIF' Meny blocketIF k%=1 AND x%>20/xt% AND x%/xt%<160 AND y%>60/yt% AND y%<369/yt%my%=INT((y%-83/yt%)/13*yt%)+1GOSUB me_testENDIF' Buffert blocketIF k%=1 AND x%>440 AND x%<628 AND y%>385/yt%-bufer%*10/yt% AND y%<385/yt%bfi%=INT((y%-385/yt%+bufer%*10/yt%)/10*yt%)+1zset%=1FOR i%=1 TO bfi%ADD zset%,lng%(i%)NEXT i%PUT 438,370/yt%-bufer%*10/yt%,zeilen$@blinker(1,441,385-bufer%*10+(bfi%-1)*10-2*(yt%-1),626,395-bufer%*10+(bfi%-1)*10)REPEATUNTIL MOUSEK=0ENDIFIF selekt%<>0GOSUB menu_valENDIFRETURN> PROCEDURE menu_valMENU KILLREPEATUNTIL MOUSEK=0SELECT selekt%CASE 1INC vir_tes&IF vir_tes& AND 1meny$(1)=RIGHT$(meny$(1),LEN(meny$(1))-1)GOSUB mark_on(1,"+")ELSEGOSUB mark_off(1,"+")meny$(1)=" "+meny$(1)ENDIFGOTO nolCASE 2ALERT 0,"                          ",1,"Fr†n Syn|Fr†n Dis",al%IF al%=1DEFMOUSE 2GOSUB frn_syntELSEdeskGOSUB frn_diskENDIFCASE 3ALERT 0,"                          ",0,"Till Synt|Till Disk",al%IF al%=1DEFMOUSE 2GOSUB till_syntELSEdeskDEFMOUSE 2GOSUB till_diskENDIFCASE 4CLSGOSUB dirreCASE 5GOSUB delet_filCASE 7GOSUB snoppaCASE 8GOSUB buff_buffCASE 10DEFMOUSE 2GOSUB 4_8CASE 11DEFMOUSE 2GOSUB 8_4CASE 12GOSUB 7_8CASE 13GOSUB 8_7CASE 15e$=bufer$(bfi%)GOSUB wbuff(e$)bufer$(bfi%)=e$CASE 16ALERT 0,"       CLEAR Buffert        ",3,"ALLA Buf|En Buffer|Cancel",al%IF al%=1ERASE bufer$(),bf_nam$()DIM bufer$(50),bf_nam$(50)CLR bufer%,bfi%ELSE IF al%=2DELETE bf_nam$(bfi%)DELETE bufer$(bfi%)DEC bufer%bfi%=bufer%ENDIFCASE 17GOSUB verifyCASE 18GOSUB dela_uppCASE 19GOSUB check_sumCASE 20ALERT 1,"Ska vi l„mna BILD KLINIKEN|till sitt ”de?",1,"Ja|Nej",al%IF al%=1EDITENDIFENDSELECT'GOSUB desk !Gr† fin rutaGRAPHMODE 1DEFFILL 1,1,0DEFLINE 1,0DEFTEXT 1,0,0,13/yt%PUT 10,32/yt%,titel$PUT 10,77/yt%,m.bild$GOSUB chow_block'nol:IF bfi%@blinker(1,441,385-bufer%*10+(bfi%-1)*10-2*(yt%-1),626,395-bufer%*10+(bfi%-1)*10)ENDIFIF bfi%GOSUB mark_off(3,"-")GOSUB mark_off(7,"-")GOSUB mark_off(8,"-")GOSUB mark_off(10,"-")GOSUB mark_off(11,"-")GOSUB mark_off(12,"-")GOSUB mark_off(13,"-")GOSUB mark_off(16,"-")GOSUB mark_off(17,"-")GOSUB mark_off(18,"-")GOSUB mark_off(19,"-")ELSEGOSUB mark_on(3,"-")GOSUB mark_on(7,"-")GOSUB mark_on(8,"-")GOSUB mark_on(10,"-")GOSUB mark_on(11,"-")GOSUB mark_on(12,"-")GOSUB mark_on(13,"-")GOSUB mark_on(16,"-")GOSUB mark_on(17,"-")GOSUB mark_on(18,"-")GOSUB mark_on(19,"-")ENDIFGOSUB update_panelCLR selekt%DEFMOUSE 3MENU menue$()RETURN> PROCEDURE key' PRINT MENU(13)!4=Control,2=shift,8=alternate,1=shift2' PRINT BYTE(MENU(14))!ASCII' PRINT SHR(MENU(14),8)!Tangent nr.my%=SHR(MENU(14),8)-58GOSUB me_testIF selekt%<>0GOSUB menu_valENDIFRETURN> PROCEDURE me_testIF my%>0 AND my%=<menu_ant%IF LEFT$(meny$(my%),1)<>"-"@blinker(0,16,83+(my%-1)*13,161,97+(my%-1)*13)selekt%=my%ENDIFENDIFRETURN> PROCEDURE mark_off(ma%,ma$)IF LEFT$(meny$(ma%),1)=ma$meny$(ma%)=RIGHT$(meny$(ma%),LEN(meny$(ma%))-1)ENDIFRETURN> PROCEDURE mark_on(ma%,ma$)IF LEFT$(meny$(ma%),1)<>ma$meny$(ma%)=ma$+meny$(ma%)ENDIFRETURN> PROCEDURE infoDEFFILL 1,2,8PBOX 116,52,556,333DEFFILL 1,0,0PBOX 114,50,554,331BOX 116,52,552,329'DEFFILL 1,2,8PBOX 132,85,542,101DEFFILL 1,2,2PBOX 130,83,540,99DEFFILL 1,0,0DEFTEXT 1,4,0,26/yt%@stext(170,92/yt%,"Midi Kliniken",4,4)!4 4 St†r f”r skuggans vinkelDEFTEXT ,0,,4/yt%+(yt%-1)TEXT 450,86/yt%,"By Dominique "+CHR$(189)DEFTEXT 3,1,0,13/yt%PRINT AT(21,8);"Detta lilla prog. hanterar MIDI dumpar"PRINT AT(21,9);"fr†n syntar."PRINT AT(21,10);"Ett bra verkty att unders”ka"PRINT AT(21,11);"system exclusive dumpar fr†n synt"PRINT AT(21,12);"om man kan lite om synten redan"PRINT AT(21,13);"annars kan det vara lite knepigt."PRINT AT(27,14);"Lycka till."PRINT AT(27,15);"Monocrom Program."PRINT AT(21,17);"Skriven p† synten By Dr.Dominique."PRINT AT(21,18);"Om ni har n†gra fr†gor s† ring."PRINT AT(21,19);"Tele:0755/50622"PRINT AT(54,20);CHR$(189);"Oktober 1990."REPEATUNTIL MOUSEK=1 OR LEN(INKEY$)'DEFFILL 1,2,8PBOX 173,73,453,210DEFFILL 1,0,0PBOX 170,70,450,207BOX 172,72,448,205DEFTEXT 1,16,0,13TEXT 200,90,"Om Programeraren:"DEFTEXT 1,0,0,6TEXT 200,110,"Tackt & Ton + Ryttm & Musik:"DEFTEXT 1,0,0,6TEXT 200,128,"Dominique Terrac"TEXT 200,136,"Busske nr 7"TEXT 200,144,"153 00 J„rna"TEXT 200,162,"Logik och Programmide':"TEXT 200,177,"Doping Power"TEXT 200,185,"LSD Tripp"TEXT 175,200,CHR$(189)+"1990 SENILO All Rights feeling."REPEATUNTIL MOUSEK=1 OR LEN(INKEY$)RETURN> PROCEDURE dirreDEFMOUSE 2SHOWMREPEAThead(1," Directory fr†n disk. Anvend * ")VOID FSEL_INPUT(file$,namdir$,o%)head(0,"")CLSEXIT IF o%=0IF ASC(namdir$)=0namdir$="*.*"ELSEo%=RINSTR(namdir$,".")IF o%=0namdir$=namdir$+".*"GOSUB str000(namdir$)ENDIFENDIFo%=RINSTR(file$,"\")o$=LEFT$(file$,o%)+namdir$IF EXIST(o$)FILES o$i%=DFREE(GEMDOS(25))PRINT s1$;"    Du har "+STR$(i%)+" Byte fritt p† disk "+CHR$(drive%+65);"    ";s2$DEFMOUSE 3REPEATUNTIL MOUSEK OR LEN(INKEY$)ELSEALERT 1,"Hittade inte filen|"+o$,1,"OK",al%ENDIFUNTIL 0=0RETURN> PROCEDURE delet_filDOhead(1," DELETE FIL ")VOID FSEL_INPUT(file$,namdel$,o%)head(0,"")EXIT IF o%=0o%=RINSTR(file$,"\")o$=LEFT$(file$,o%)+namdel$IF EXIST(o$)ALERT 3,"  Kill fil ?  |"+o$+" ",2," Ja | Nej ",al%IF al%=1KILL o$ENDIFELSEALERT 1,"Hittade inte filen|"+o$,1,"OK",al%ENDIFLOOPRETURN' #####POPPUP MENYN####> PROCEDURE menue(mmx%,mxl%,myo%,mxr%,myu%,VAR f.adr$(),v.adr%)LOCAL mmen$,msk%,m.key$,yi%,yi2%,mrs%,m.i%,lsr%LOCAL mxl2%,mxr2%,myo2%,myu2%DIM dum$(1)SWAP f.adr$(),dum$()mxl2%=MIN(MAX(MOUSEX-(68/xt%),mxl%),mxr%-(136/xt%))mxr2%=mxl2%+(136/xt%)myo2%=MIN(MAX(MOUSEY-(6/yt%),myo%),myu%-(18+mmx%*18)/yt%)myu2%=myo2%+((18+mmx%*18)/yt%)mxl%=MIN(mxl%,mxl2%)myo%=MIN(myo%,myo2%)GET MAX(0,mxl2%),MAX(0,myo2%),MIN((639/xt%),mxr2%),MIN(myu2%,399/yt%),mmen$DEFTEXT 1,0,0,8-2*yt%DEFFILL 1,0,0GRAPHMODE 1PBOX mxl2%,myo2%,mxr2%,myu2%BOX mxl2%+(1/xt%),myo2%+(1/yt%),mxr2%-(1/xt%),myu2%-(1/yt%)DEFFILL 1,2,4PBOX mxl2%+(6/xt%),myo2%+(6/yt%),mxr2%-(6/xt%),myu2%-(6/yt%)DEFFILL 1,0,0FOR m.i%=1 TO mmx%GRAPHMODE 1PBOX mxl2%+(13/xt%),myo2%-6/yt%+m.i%*18/yt%,mxr2%-(13/xt%),myo2%+6/yt%+m.i%*18/yt%GRAPHMODE 2IF LEFT$(dum$(m.i%))="-"DEFTEXT ,2TEXT mxl2%+(20/xt%),myo2%+3/yt%+m.i%*18/yt%,100/xt%,RIGHT$(dum$(m.i%),LEN(dum$(m.i%))-1)ELSEDEFTEXT ,0TEXT mxl2%+(20/xt%),myo2%+3/yt%+m.i%*18/yt%-1+yt%,100/xt%,dum$(m.i%)ENDIFNEXT m.i%DEFMOUSE 3DEFFILL 1,1,1GRAPHMODE 3BOUNDARY 0             ! fr V3.0REPEATMOUSE xko.x%,yko.y%,msk%yi%=INT((yko.y%-(myo2%-(8/yt%)))/(18/yt%))IF xko.x%>mxl2%+(12/xt%) AND yi%>0 AND xko.x%<mxr2%-(13/xt%) AND yi%<=(mmx%)IF LEFT$(dum$(yi%))<>"-"PBOX mxl2%+(14/xt%),myo2%-(5/yt%)+yi%*(18/yt%)-1+yt%,mxr2%-(14/xt%)+1-xt%,myo2%+(5/yt%)+yi%*(18/yt%)ENDIFREPEATyi2%=INT((MOUSEY-(myo2%-(8/yt%)))/(18/yt%))msk%=MOUSEKm.key$=INKEY$ON MENUUNTIL MOUSEX<mxl2%+(12/xt%) OR MOUSEX>mxr2%-(13/xt%) OR yi%<>yi2% OR msk%>0 OR m.key$>""IF LEFT$(dum$(yi%))<>"-"PBOX mxl2%+(14/xt%),myo2%-(5/yt%)+yi%*(18/yt%)-1+yt%,mxr2%-(14/xt%)+1-xt%,myo2%+(5/yt%)+yi%*(18/yt%)ELSECLR msk%ENDIFELSECLR yi2%ENDIFEXIT IF (MOUSEX<mxl% OR MOUSEX>mxr% OR MOUSEY<myo% OR MOUSEY>myu%) AND yi2%<=mmx%m.key$=INKEY$UNTIL (msk%>0 OR m.key$>"") AND yi2%<=mmx%DEFFILL 1,0,0GRAPHMODE 1PUT MAX(0,mxl2%),MAX(0,myo2%),mmen$BOUNDARY 1            ! fr V3.0SWAP f.adr$(),dum$()ERASE dum$()v.adr%=yi2%PAUSE 5RETURN' ###################DISK RUTIN#> PROCEDURE frn_diskREPEATIF vir_tes& AND 1GOSUB boot_testENDIFhead(1,"Load dump fr†n disk")VOID FSEL_INPUT(file$,dnam$,o%)head(0,"")EXIT IF o%=0o%=RINSTR(file$,"\")o$=LEFT$(file$,o%)+dnam$IF EXIST(o$)OPEN "I",#1,o$size%=LOF(#1)CLOSE #1IF zise%<32701DEFMOUSE 2INC bufer%e$=STRING$(size%," ")tiptext("NAMN: "+o$+".   Fil size "+STR$(size%)+".")BLOAD o$,VARPTR(e$)bufer$(bufer%)=e$'    e$=INPUT$(LOF(#1),#1)DEFMOUSE 3bfi%=bufer%o%=RINSTR(dnam$,".")IF o%bf_nam$(bufer%)=LEFT$(dnam$,o%-1)ELSEbf_nam$(bufer%)=dnam$ENDIFELSEALERT 1,"F”r stor fil.|MAX 32700 Byte.",1,"OK",al%ENDIFELSEALERT 1,"Hittade inte filen|"+o$,1,"OK",al%ENDIFUNTIL 0=0RETURN> PROCEDURE till_diskREPEATIF vir_tes& AND 1GOSUB boot_testENDIFe$=bufer$(bfi%)dnam$=bf_nam$(bfi%)head(1,"Save dump till disk.")VOID FSEL_INPUT(file$,dnam$,o%)head(0,"")a%=RINSTR(dnam$,".")IF a%bf_nam$(bfi%)=LEFT$(dnam$,a%-1)ELSEbf_nam$(bfi%)=dnam$ENDIFEXIT IF o%=0o%=RINSTR(file$,"\")o$=LEFT$(file$,o%)+dnam$a%=LEN(e$)o%=DFREE(0)IF o%>a%GOSUB backuppBSAVE o$,VARPTR(e$),a%ELSEALERT 3,"F†r inte plats|mer p† disken",1,"OK",al%ENDIFUNTIL 0=0DEFMOUSE 3RETURN> PROCEDURE boot_testa$=SPACE$(512)VOID @rw_sek(2,VARPTR(a$),1,0,0)IF LEFT$(a$,2)<>MKI$(0)ALERT 1,"    OBSERVERA!|Det fins n†got skumt|p† BOOT sektorn.|Checka upp det.",1,"OK",al%ENDIFRETURNDEFFN rw_sek(r%,s%,a%,s3%,d%)=BIOS(4,r%,L:s%,a%,s3%,d%)> PROCEDURE backuppIF EXIST(o$)ALERT 3,"Ska jag g”ra en backupp|p† den gammla filen?",0," Ja.| Nej.",alz%IF alz%=1i%=RINSTR(o$,".")o1$=LEFT$(o$,i%)+"BAK"IF EXIST(o1$)=-1KILL o1$ENDIFNAME o$ AS o1$ENDIFENDIFRETURN' ##############################> PROCEDURE frn_syntCLR i%,e$a$=INPMID$tiptext(" Send en dump fr†n synten.Jag ventar! ")tim%=TIMERDEFMOUSE 2PAUSE 7IF BIOS(1,3)=0PRINT "1*********!"REPEATUNTIL tim%+1200<TIMER OR BIOS(1,3)=-1 ! BIOS(1,3) „r sama som INP?(3).GOSUB midiinGOSUB data_to_bELSEPRINT "2*********!"REPEATe$=INPMID$a%=INSTR(e$,CHR$(240))UNTIL a% OR tim%+1200<TIMERIF a%GOSUB midiin1GOSUB data_to_bENDIFENDIFOUT 2,7RETURN> PROCEDURE data_to_bREPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0bufer$(bfi%)=e$bf_nam$(bfi%)="Syntdu"+STR$(bfi%)bufer%=bfi%tiptext(" Dumpsize: "+STR$(LEN(bufer$(bfi%)))+". Press key or mous. ")DEFMOUSE 3REPEATUNTIL MOUSEK OR LEN(INKEY$)DEFMOUSE 3RETURN> PROCEDURE midiinREPEATREPEATa$=INPMID$e$=e$+a$UNTIL INP?(3)=0tim%=TIMERREPEATUNTIL tim%+200<TIMER OR INP?(3)=-1UNTIL INP?(3)=0RETURN> PROCEDURE midiin1REPEATREPEATa$=INPMID$e$=e$+a$'    UNTIL INP?(3)=0 OR INSTR(a$,CHR$(254))UNTIL BIOS(1,3)=0tim%=TIMERREPEATUNTIL tim%+200<TIMER OR INP?(3)=-1'  UNTIL INP?(3)=0UNTIL INSTR(a$,CHR$(254))a%=RINSTR(e$,CHR$(254))e$=LEFT$(e$,a%-1)RETURN' ***Laddar in Data set***> PROCEDURE data_setmidi1:           !DT1DATA 240,65,16,22,18RESTORE midi1FOR mis%=1 TO 5READ a%(mis%)NEXT mis%RETURN> PROCEDURE satelit_formGOSUB sysex_forme$=CHR$(&H46)+CHR$(&H52)+CHR$(0)+CHR$(&H24)+e$RETURN> PROCEDURE sysex_forme$=CHR$(&HF0)+CHR$(&H42)+CHR$(&H30)+CHR$(&H24)+e$e$=e$+CHR$(&HF7)RETURN> PROCEDURE com_prgALERT 4,"/\/\-+-/\/\",0,"Combi|Progr",al%IF al%=1GOSUB combiELSEGOSUB progENDIFGOSUB satelit_formRETURN> PROCEDURE combie$=CHR$(&H4D)+CHR$(0)+e$GOSUB satelit_formRETURN> PROCEDURE proge$=CHR$(&H4C)+CHR$(0)+e$GOSUB satelit_formRETURN' ####################> PROCEDURE till_syntALERT 3,"Ska vi senda till synten?",1,"OK|Cancel",al%IF al%=1a$=bufer$(bfi%)a%=LEN(a$)VOID XBIOS(12,a%,L:VARPTR(a$))ENDIFRETURN> PROCEDURE check_suma$=bufer$(bfi%)CLR check%FOR ch%=1 TO LEN(a$)check%=check%+ASC(MID$(a$,ch%,1))NEXT ch%a%=NOT check%INC a%b%=a% AND 127check%=b%a$=a$+CHR$(check%)REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0te$="chsm"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer$(bfi%)=a$bufer%=bfi%RETURN' ###################################> PROCEDURE snoppae$=bufer$(bfi%)namn$=bf_nam$(bfi%)ALERT 0,"       Snoppa av Dump.        ",0," Left.| Right.|Cancel",al%IF al%=1DEFFILL 1,2,8DEFTEXT 1,0,0,13/yt%GET 117,87/yt%,450,200/yt%,o$'  PBOX 120,90/yt%,360,160/yt%PBOX 120,90/yt%,450,200/yt%DEFFILL 1,0,0PBOX 117,87/yt%,447,197/yt%BOX 119,89/yt%,445,195/yt%TEXT 135,115/yt%,"Hur m†nga byte ska snoppas fr†n left?"TEXT 135,130/yt%,"13 f”r satellite dump fr†n synt."TEXT 135,145/yt%,"8 f”r direkt dump fr†n synt."PRINT AT(18,11);snopp$=STR$(snopp%)FORM INPUT 8 AS snopp$snopp%=VAL(snopp$)PUT 117,87/yt%,o$snop$=LEFT$(e$,snopp%)e$=RIGHT$(e$,LEN(e$)-snopp%)REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0bufer$(bfi%)=snop$te$="_S"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$INC bfi%bufer$(bfi%)=e$te$="_L"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer%=bfi%ELSE IF al%=2DEFFILL 1,2,8DEFTEXT 1,0,0,13/yt%GET 117,87/yt%,450,200/yt%,o$'  PBOX 120,90/yt%,360,160/yt%PBOX 120,90/yt%,450,200/yt%DEFFILL 1,0,0PBOX 117,87/yt%,447,197/yt%BOX 119,89/yt%,445,195/yt%TEXT 135,130/yt%,"Hur m†nga byte ska snoppas fr†n right?"PRINT AT(18,11);snopp$=STR$(snopp%)FORM INPUT 8 AS snopp$snopp%=VAL(snopp$)PUT 117,87/yt%,o$snop$=RIGHT$(e$,snopp%)e$=LEFT$(e$,LEN(e$)-snopp%)REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0bufer$(bfi%)=snop$te$="_S"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$INC bfi%bufer$(bfi%)=e$te$="_R"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer%=bfi%ENDIFRETURN> PROCEDURE buff_buffGOSUB tiptext(" Med vilken Buffert ")a$=bufer$(bfi%)REPEATMOUSE x%,y%,k%UNTIL k%IF x%>440 AND x%<628 AND y%>385/yt%-bufer%*10/yt% AND y%<385/yt%bfi%=INT((y%-385/yt%+bufer%*10/yt%)/10*yt%)+1zset%=1FOR i%=1 TO bfi%ADD zset%,lng%(i%)NEXT i%PUT 438,370/yt%-bufer%*10/yt%,zeilen$@blinker(1,441,385-bufer%*10+(bfi%-1)*10-2*(yt%-1),626,395-bufer%*10+(bfi%-1)*10)b$=bufer$(bfi%)REPEATUNTIL MOUSEK=0REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0bufer$(bfi%)=a$+b$bf_nam$(bfi%)="Buff_Buff"bufer%=bfi%ENDIFRETURN> PROCEDURE 4_8' ------- Roland U220-BANK. -------tiptext("Arbetar  ! G”r 4 bits byte till 8 bits byte.")CLR c$e$=bufer$(bfi%)namn$=bf_nam$(bfi%)a%=LEN(e$)vh=11/a%DEFMOUSE 2FOR i%=1 TO a% STEP 2LINE 200,(190+i%*vh)/yt%,210,(190+i%*vh)/yt%a%=ASC(MID$(e$,i%+1,1))b%=ASC(MID$(e$,i%,1))IF a%<16 OR b%<16c$=c$+CHR$(a%*16+b%)ELSEc$=c$+MID$(e$,i%,2)ENDIFNEXT i%REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0te$="_4_8"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer$(bfi%)=c$bufer%=bfi%RETURN> PROCEDURE 8_4tiptext("Arbetar  ! G”r 8 bits byte till 4 bits byte.")CLR c$e$=bufer$(bfi%)namn$=bf_nam$(bfi%)a%=LEN(e$)vh=11/a%DEFMOUSE 2FOR i%=1 TO a%LINE 200,(190+i%*vh)/yt%,210,(190+i%*vh)/yt%a%=ASC(MID$(e$,i%,1)) AND &HFb%=ASC(MID$(e$,i%,1)) AND &HF0IF a%<16 OR b%<16c$=c$+CHR$(a%)+CHR$(b%)ELSEc$=c$+MID$(e$,i%,1)ENDIFNEXT i%REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0te$="_8_4"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer$(bfi%)=c$bufer%=bfi%'  bufer$(bfi%)=MKD$(&HF041102B)+MKF$(&H12001000)+c$RETURN'> PROCEDURE 7_8DEFMOUSE 2tiptext("Arbetar! G”r 7 bits byte till 8 bits byte. ")e$=bufer$(bfi%)namn$=bf_nam$(bfi%)a%=LEN(e$)CLR a$FOR s%=1 TO a% STEP 8byt1%=ASC(MID$(e$,s%,1))byt7$=MID$(e$,s%+1,7)FOR is%=1 TO 7by1_7%=ASC(MID$(byt7$,is%,1))IF BTST(byt1%,is%-1)bi8%=BSET(by1_7%,7)MID$(byt7$,is%,1)=CHR$(bi8%)ENDIFNEXT is%a$=a$+byt7$NEXT s%REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0te$="_7_8"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer$(bfi%)=a$bufer%=bfi%OUT 2,7DEFMOUSE 3RETURN> PROCEDURE 8_7tiptext("Arbetar! G”r 8 bits byte till 7 bits byte. ")DEFMOUSE 2e$=bufer$(bfi%)namn$=bf_nam$(bfi%)a%=LEN(e$)CLR a$FOR s%=1 TO a% STEP 7byt7$=MID$(e$,s%,7)CLR byt1%FOR is8%=1 TO 7byt1_8%=ASC(MID$(byt7$,is8%,1))IF BTST(byt1_8%,7)byt1%=BSET(byt1%,is8%-1)byt1_8%=BCLR(byt1_8%,7)MID$(byt7$,is8%,1)=CHR$(byt1_8%)ENDIFNEXT is8%a$=a$+CHR$(byt1%)+byt7$NEXT s%REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0te$="_8_7"GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer$(bfi%)=a$bufer%=bfi%OUT 2,7DEFMOUSE 3RETURN> PROCEDURE verifyGOSUB tiptext(" Med vilken Buffert ")a$=bufer$(bfi%)REPEATMOUSE x%,y%,k%UNTIL k%IF x%>440 AND x%<628 AND y%>385/yt%-bufer%*10/yt% AND y%<385/yt%bfi%=INT((y%-385/yt%+bufer%*10/yt%)/10*yt%)+1zset%=1FOR i%=1 TO bfi%ADD zset%,lng%(i%)NEXT i%PUT 438,370/yt%-bufer%*10/yt%,zeilen$@blinker(1,441,385-bufer%*10+(bfi%-1)*10-2*(yt%-1),626,395-bufer%*10+(bfi%-1)*10)b$=bufer$(bfi%)REPEATUNTIL MOUSEK=0tiptext("   Verify   ")a%=LEN(a$)b%=LEN(b$)flag!=0c%=MAX(a%,b%)FOR i%=1 TO c%IF MID$(a$,i%,1)<>MID$(b$,i%,1)flag!=1d%=i%EXIT IF i%>0ENDIFNEXT i%IF flag!ALERT 3,"Dom „r inte lika.|Olikheten burjar vid "+STR$(d%),1,"OK",al%ELSEALERT 3,"Dom „r exakt lika.",1,"OK",al%ENDIFENDIFRETURN> PROCEDURE dela_uppe$=bufer$(bfi%)namn$=bf_nam$(bfi%)CLR i%,ct%REPEATINC i%IF ASC(MID$(e$,i%,1))=&HF0a%=i%REPEATINC a%UNTIL ASC(MID$(e$,a%,1))=&HF7INC ct%REPEATINC bfi%UNTIL LEN(bufer$(bfi%))=0bufer$(bfi%)=MID$(e$,i%,a%-i%+1)te$="Med"+STR$(ct%)GOSUB fnamn(namn$,te$)bf_nam$(bfi%)=te$bufer%=bfi%i%=a%ENDIFUNTIL i%>=LEN(e$)RETURN> PROCEDURE fnamn(na$,VAR te$)DOn$=na$+te$EXIT IF LEN(n$)<9na$=LEFT$(na$,LEN(na$)-1)LOOPte$=n$RETURN' ---------------------------------------------------------------' e$=SPACE$(512)' VOID BIOS(4,2,L:VARPTR(e$),1,0,0)> PROCEDURE wbuff(VAR du$)deskOPENW 0DEFTEXT ,,,6/yt%+(yt%-1)LOCAL j%,byte%,wi$,flag!GRAPHMODE 1DEFFILL ,0,0PBOX 35,0,571,369/yt%BOX 35,0,572,370/yt%PRINT AT(6,2);"1  2  3  4  5  6  7  8  9  0  1  2  3  4  5    123456789012345"PRINT AT(6,3);"--------------------------------------------   ---------------"size%=LEN(du$)a%=1REPEATDEFMOUSE 2wi$=MID$(du$,a%,600)CLR flag!FOR j%=0 TO 39PRINT AT(6,CRSLIN);FOR i%=0 TO 14byte%=ASC(MID$(wi$,1+i%+j%*15))IF a%+(1+i%+j%*15)<size%+2PRINT HEX$(byte%,2);" ";ELSEDEFTEXT ,2PRINT HEX$(byte%,2);" ";ENDIFDEFTEXT ,0NEXT i%PRINT "|"NEXT j%PRINT AT(1,3)FOR j%=0 TO 39PRINT AT(53,CRSLIN);FOR i%=0 TO 14byte%=ASC(MID$(wi$,1+i%+j%*15))IF byte%=0OUT 5,ASC(".")ELSEOUT 5,byte%ENDIFNEXT i%PRINT "|";j%+1NEXT j%GOSUB buffvalPRINT AT(2,3)UNTIL a%=0CLSCLOSEW 0RETURN> PROCEDURE buffvalREPEATDEFFILL 1,2,6DEFTEXT 1,0,0,6/yt%+(yt%-1)PBOX 39,349/yt%,567,364/yt%PRINT AT(9,45);" STR.SIZE ";size%;"    | BYTES ";a%+599;" "PRINT AT(44,45);" TILLBAKA | NEXT | EXIT ";IF a%=1DEFTEXT ,2PRINT AT(45,45);"TILLBAKA"ENDIFIF a%+600>size%DEFTEXT ,2PRINT AT(55,45);" NEXT"ENDIFDEFTEXT ,0DEFMOUSE 3REPEATMOUSE x%,y%,k%xm%=((x%)/8.3)+1ym%=((y%)/8.2)+1UNTIL k%=1IF xm%>6 AND xm%<66 AND ym%>3 AND ym%<46IF ym%<42IF xm%<49' edit ruta hexidecGOSUB hexedflag!=-1ELSE' edit ruta ASCI cod' GOSUB asciedENDIFELSEIF ym%>43 AND xm%>8 AND xm%<65SOUND 2,15,2,7,2SOUND 1,0flag!=-1SELECT xm%CASE 9 TO 22@blinker(1,(8*8.2)-2,43*8.2,(23*8.2)+1,(44*8.2)+1)' SIZEsiz$=STR$(size%)PRINT AT(19,45);FORM INPUT 5 AS siz$siz%=VAL(siz$)IF siz%>size%du$=du$+STRING$(siz%-size%,0)ELSEdu$=LEFT$(du$,siz%)ENDIFsize%=VAL(siz$)CASE 42 TO 52@blinker(1,(42*8.2)-2,43*8.2,(52*8.2)+1,(44*8.2)+1)' TILLBAKAIF a%<>1SUB a%,600ELSEflag!=0ENDIFCASE 52 TO 59@blinker(1,(52*8.2),43*8.2,(59*8.2)+2,(44*8.2)+1)' NEXTIF a%+599<size%ADD a%,600ELSEflag!=0ENDIFCASE 59 TO 66@blinker(1,(59*8.2)+1,43*8.2,(65*8.2)+4,(44*8.2)+1)' EXITCLR a%DEFAULTflag!=0ENDSELECTENDIFENDIFELSEflag!=0ENDIFUNTIL flag!RETURN> PROCEDURE hexedrad%=ym%-4@blinker(0,(3*8.2),(ym%-1)*8.2,(49*8.2),((ym%-1)*8.2)+8)CLR rad$FOR i%=0 TO 14rad$=rad$+HEX$(ASC(MID$(du$,a%+(rad%*15)+i%,1)),2)+" "NEXT i%rad$=LEFT$(rad$,LEN(rad$)-1)PRINT AT(6,rad%+4);FORM INPUT 44 AS rad$rad$=UPPER$(rad$)CLR raad$FOR i%=1 TO 44 STEP 3ra%=VAL("&H"+MID$(rad$,i%,2))raad$=raad$+CHR$(ra%)NEXT i%MID$(du$,a%+(rad%*15),15)=raad$RETURN> PROCEDURE asciedrad%=ym%-4CLR rad$rad$=MID$(du$,a%+(rad%*15),15)PRINT AT(13,rad%+4);FORM INPUT 44 AS rad$!  ----Problem----rad$=UPPER$(rad$)CLR raad$MID$(du$,a%+(rad%*15),15)=raad$RETURN'' ###########################HJŽRPRUTINER######################################> PROCEDURE deskGRAPHMODE 1DEFFILL ,2,9PBOX -1,0/yt%,640,400/yt%DEFFILL ,2,8PBOX 7,27/yt%,636,396/yt%DEFFILL ,2,4PBOX 3,23/yt%,632,392/yt%DEFFILL ,0,0RETURN> PROCEDURE bildSETCOLOR 1,0,7,0SETCOLOR 2,7,0,0DEFFILL 3,2,8PBOX 12,34/yt%,406,71/yt%DEFFILL 1,2,2PBOX 10,32/yt%,404,69/yt%DEFTEXT ,4,,26/yt%@stext(16,61/yt%,"    MIDI kliniken.  v.1",4,4)!4 4 St†r f”r skuggans vinkelGET 10,32/yt%,406,71/yt%,titel$GRAPHMODE 1DEFFILL 1,2,8PBOX 12,79/yt%,170,385/yt%DEFFILL ,0,0PBOX 10,77/yt%,168,383/yt%BOX 12,77/yt%+2,166,383/yt%-2FOR i%=84 TO 369 STEP 13BOX 16,i%/yt%-1,162,(i%+21)/yt%PBOX 16,i%/yt%-1,161,(i%+21)/yt%-1NEXT i%GET 10,77/yt%,170,385/yt%,m.bild$RETURNPROCEDURE update_panelGRAPHMODE 1DEFTEXT 3,0,0,6/yt%+(yt%-1)' DEFTEXT 3,0,,6/yt%i%=92CLR s%REPEATINC s%IF LEFT$(meny$(s%))="-"DEFTEXT ,2,,6/yt%+(yt%-1)TEXT 20,i%/yt%,RIGHT$(meny$(s%),LEN(meny$(s%))-1)DEFTEXT ,0,,6/yt%+(yt%-1)ELSETEXT 20,i%/yt%,meny$(s%)ENDIFADD i%,13UNTIL s%=menu_ant%RETURN> PROCEDURE stext(s.xt%,s.yt%,s.txt$,s.xo%,s.yo%)GRAPHMODE 2TEXT s.xt%-1,s.yt%,s.txt$TEXT s.xt%+1,s.yt%,s.txt$TEXT s.xt%,s.yt%-1,s.txt$TEXT s.xt%,s.yt%+1,s.txt$TEXT s.xt%+s.xo%,s.yt%+s.yo%,s.txt$GRAPHMODE 3TEXT s.xt%,s.yt%,s.xl%,s.txt$GRAPHMODE 1RETURN> PROCEDURE tiptext(tip$)LOCAL tln%GRAPHMODE 1DEFFILL ,0,0DEFTEXT ,0,,13/yt%tln%=LEN(tip$)*4PBOX 320-tln%-6,190/yt%-5,320+tln%+6,220/yt%+5BOX 320-tln%-3,190/yt%-2,320+tln%+3,220/yt%+2BOX 320-tln%-3,190/yt%-2,320+tln%+4,220/yt%+3TEXT 320-tln%,212/yt%,tip$RETURN> PROCEDURE head(h.flg%,h.txt$)LOCAL h.res%,h.hlf%,h.dis%,h.re%,h.bxr%h.txt$=LEFT$(h.txt$,MIN(38,LEN(h.txt$)))IF xt%<>2h.re%=1ENDIFIF h.flg%=1h.hlf%=LEN(h.txt$)*4h.dis%=2-yt%IF xt%<>2h.bxr%=481ELSEh.bxr%=319ENDIFDEFTEXT 1,0,,13/yt%GET 158*h.re%,0,h.bxr%,399/yt%/6,h.bg$DEFFILL 1,2,2PBOX 158*h.re%,16/yt%+h.dis%*16,h.bxr%,(50/yt%-h.dis%*12)+h.dis%*16DEFFILL 1,0,0PBOX 320-h.hlf%-2,16/yt%+h.dis%*16,320+h.hlf%+2,(50/yt%-h.dis%*12)+h.dis%*16TEXT 320-h.hlf%,(44/yt%-h.dis%*10)+h.dis%*16,h.txt$ELSEPUT 158*h.re%,0,h.bg$CLR h.bg$ENDIFRETURN> PROCEDURE blinker(b.flg%,bxl%,byo%,bxr%,byu%)DEFFILL 1,2,8GRAPHMODE 3PBOX bxl%,byo%/yt%,bxr%,byu%/yt%IF b.flg%=0REPEATUNTIL MOUSEK=0PBOX bxl%,byo%/yt%,bxr%,byu%/yt%ENDIFGRAPHMODE 1RETURN> PROCEDURE chow_blockCOLOR 2DEFFILL 1,2,8bu%=MIN(bufer%,35)PBOX 438,370/yt%-bu%*10/yt%,630,390/yt%DEFFILL 1,0,0PBOX 438,370/yt%-bu%*10/yt%,628,388/yt%BOX 440,370/yt%-bu%*10/yt%+2/yt%,626,380/yt%-bu%*10/yt%+2/yt%BOX 440,380/yt%-bu%*10/yt%+4/yt%,626,388/yt%-2/yt%DEFTEXT 1,0,0,6/yt%+(yt%-1)GRAPHMODE 2TEXT 494,386/yt%-10/yt%*bu%-6/yt%,STR$(bufer%)+" BUFFERTS"FOR i%=bu% DOWNTO 1TEXT 444,386/yt%-10/yt%*(bu%-i%)-3/yt%,bf_nam$(i%)+" "+STR$(LEN(bufer$(i%)))NEXT i%COLOR 1GRAPHMODE 1GET 438,370/yt%-bu%*10/yt%,630,390/yt%,zeilen$RETURN> PROCEDURE meny_dataERASE meny$()CLR i%RESTORE m.datasREPEATINC i%READ a$UNTIL a$="***"menu_ant%=i%-1DIM meny$(menu_ant%)RESTORE m.datasFOR i%=1 TO menu_ant%READ meny$(i%)NEXT i%CLR synt%RETURNm.datas:DATA +Virus check. F1DATA Load dump.    F2DATA -Save dump.    F3DATA Directory     F4DATA Delete fil    F5DATA ------------------DATA -Snoppa.       F7DATA -Buff + Buff.  F8DATA ------------------DATA -4 till 8.    F10DATA -8 till 4.DATA -7 till 8 bits.DATA -8 till 7 bits.DATA ------------------DATA Show DataDATA -CLEAR Buffert.DATA -Verify Buff.DATA -Dela upp dem.DATA -R„kna ut checksumDATA EXITDATA ***'DATA 40,Kawai,41,Roland,42,Korg,43,Yamaha,44,Casio,46,Kamiya Studio,47,Akai> PROCEDURE str000(VAR qa$)LOCAL x$a%=LEN(qa$)FOR i%=1 TO a%b$=MID$(qa$,i%,1)IF ASC(b$)x$=x$+b$ENDIFNEXT i%SWAP x$,qa$RETURN> PROCEDURE felALERT 2,"Error "+STR$(ERR)+"   ",1,"OK",al%RESUME menueRETURN' #############################TEST RUTIN#####################################> PROCEDURE labbloado$="A:\M3RSOUND.DAT"WHILE EXIST(o$)=0ALERT 3,"Jag hittar inte SOUNSOR.DAT|Har du slarvat bort den?|Stoppa in Sound Sortering|orginal Disken s† f†r vi se.",1,"OK",al%WENDe$=STRING$(7500," ")BLOAD o$,VARPTR(e$)GOSUB sound_data(byt$(),byt%)FOR i%=1 TO byt%bank$(i%,1)=byt$(i%)NEXT i%bank%(1)=byt%bank$(aso2%,1)="TESTBANK"RETURNREM ##########################################################################REM ####                You have hardly reached the END                   ####REM ##########################################################################