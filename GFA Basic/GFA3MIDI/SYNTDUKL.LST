t%=MIN(2,3-XBIOS(4))xt%=2-SGN(XBIOS(4))yt%=MIN(2,3-XBIOS(4))GOSUB meny_dataGOSUB deskGOSUB bildGOSUB update_panelGOSUB menuPROCEDURE menuDODEFMOUSE 3DEFFILL ,2,8PBOX 447/xt%,28/yt%,553/xt%,56/yt%DEFFILL ,0,0PBOX 444/xt%,25/yt%,550/xt%,53/yt%DEFFILL ,0,0BOX 446/xt%,27/yt%,548/xt%,51/yt%PRINT AT(60,3);" MENU "REPEATMOUSE x%,y%,k%IF x%>447/xt% AND x%<553/xt% AND y%>25/yt% AND y%<53/yt%@menue(menu_ant%,540/xt%,30/yt%,560/xt%,330/yt%,*meny$(),*selekt%)ENDIF' IF MOUSEK=2' @menue(menu_ant%,0,0,639/xt%,399/yt%,*meny$(),*selekt%)' ENDIFIF k%=1 AND x%>20/xt% AND x%/xt%<160 AND y%>60/yt% AND y%<348/yt%my%=INT((y%-62/t%)/13*t%)@blinker(0,16,62+my%*13,161,76+my%*13)selekt%=my%+1ENDIFUNTIL selekt%<>0SELECT selekt%CASE 1GOSUB meny_dataALERT 0,"                          ",0,"Fr†n synt|fr†n disk",al%IF al%=1DEFMOUSE 2GOSUB frn_syntmeny$(4)=RIGHT$(meny$(4),LEN(meny$(4))-1)meny$(9)=RIGHT$(meny$(9),LEN(meny$(9))-1)ELSEdeskGOSUB frn_diskmeny$(4)=RIGHT$(meny$(4),LEN(meny$(4))-1)meny$(9)=RIGHT$(meny$(9),LEN(meny$(9))-1)ENDIFCASE 2ALERT 0,"                          ",0,"Till synt|Till disk",al%IF al%=1DEFMOUSE 2GOSUB till_syntELSEdeskDEFMOUSE 2GOSUB till_diskENDIFCASE 4GOSUB snoppameny$(4)="-"+meny$(4)meny$(6)=RIGHT$(meny$(6),LEN(meny$(6))-1)meny$(10)=RIGHT$(meny$(10),LEN(meny$(10))-1)CASE 6DEFMOUSE 2GOSUB 4_8meny$(6)="-"+meny$(6)meny$(7)=RIGHT$(meny$(7),LEN(meny$(7))-1)meny$(12)=RIGHT$(meny$(12),LEN(meny$(12))-1)CASE 7DEFMOUSE 2GOSUB 8_4meny$(2)=RIGHT$(meny$(2),LEN(meny$(2))-1)meny$(12)=RIGHT$(meny$(12),LEN(meny$(12))-1)meny$(7)="-"+meny$(7)CASE 9wbuff(ab$)CASE 10wbuff(bb$)CASE 11wbuff(cb$)CASE 12wbuff(db$)CASE 13wbuff(eb$)CASE 15ALERT 1,"Vill du hoppa ur?",2,"Ja|Nejjj",al%IF al%=2GOTO nolENDIFDEFAULTGOTO nolENDSELECTGOSUB deskPUT 10,11/t%,tt$PUT 10,56/t%,m.bild$PUT 555,10/t%,cd$PUT 538,370/t%-cz%*10/t%,zeilen$GOSUB update_panelEXIT IF selekt%=15nol:CLR selekt%LOOPRETURNPROCEDURE menue(mmx%,mxl%,myo%,mxr%,myu%,f.adr%,v.adr%)LOCAL mmen$,msk%,m.key$,yi%,yi2%,mrs%,m.i%,lsr%LOCAL mxl2%,mxr2%,myo2%,myu2%DIM dum$(1)SWAP *f.adr%,dum$()mxl2%=MIN(MAX(MOUSEX-(68/xt%),mxl%),mxr%-(136/xt%))mxr2%=mxl2%+(136/xt%)myo2%=MIN(MAX(MOUSEY-(6/yt%),myo%),myu%-(18+mmx%*18)/yt%)myu2%=myo2%+((18+mmx%*18)/yt%)mxl%=MIN(mxl%,mxl2%)myo%=MIN(myo%,myo2%)GET MAX(0,mxl2%),MAX(0,myo2%),MIN((639/xt%),mxr2%),MIN(myu2%,399/yt%),mmen$DEFTEXT 1,0,0,8-2*yt%DEFFILL 1,0,0GRAPHMODE 1PBOX mxl2%,myo2%,mxr2%,myu2%BOX mxl2%+(1/xt%),myo2%+(1/yt%),mxr2%-(1/xt%),myu2%-(1/yt%)DEFFILL 1,2,4PBOX mxl2%+(6/xt%),myo2%+(6/yt%),mxr2%-(6/xt%),myu2%-(6/yt%)DEFFILL 1,0,0FOR m.i%=1 TO mmx%GRAPHMODE 1PBOX mxl2%+(13/xt%),myo2%-6/yt%+m.i%*18/yt%,mxr2%-(13/xt%),myo2%+6/yt%+m.i%*18/yt%GRAPHMODE 2IF LEFT$(dum$(m.i%))="-"DEFTEXT ,2TEXT mxl2%+(20/xt%),myo2%+3/yt%+m.i%*18/yt%,100/xt%,RIGHT$(dum$(m.i%),LEN(dum$(m.i%))-1)ELSEDEFTEXT ,0TEXT mxl2%+(20/xt%),myo2%+3/yt%+m.i%*18/yt%-1+yt%,100/xt%,dum$(m.i%)ENDIFNEXT m.i%DEFMOUSE 3DEFFILL 1,1,1GRAPHMODE 3BOUNDARY 0             ! fr V3.0REPEATON MENUMOUSE xko.x%,yko.y%,msk%yi%=INT((yko.y%-(myo2%-(8/yt%)))/(18/yt%))IF xko.x%>mxl2%+(12/xt%) AND yi%>0 AND xko.x%<mxr2%-(13/xt%) AND yi%<=(mmx%)IF LEFT$(dum$(yi%))<>"-"PBOX mxl2%+(14/xt%),myo2%-(5/yt%)+yi%*(18/yt%)-1+yt%,mxr2%-(14/xt%)+1-xt%,myo2%+(5/yt%)+yi%*(18/yt%)ENDIFREPEATyi2%=INT((MOUSEY-(myo2%-(8/yt%)))/(18/yt%))msk%=MOUSEKm.key$=INKEY$ON MENUUNTIL MOUSEX<mxl2%+(12/xt%) OR MOUSEX>mxr2%-(13/xt%) OR yi%<>yi2% OR msk%>0 OR m.key$>""IF LEFT$(dum$(yi%))<>"-"PBOX mxl2%+(14/xt%),myo2%-(5/yt%)+yi%*(18/yt%)-1+yt%,mxr2%-(14/xt%)+1-xt%,myo2%+(5/yt%)+yi%*(18/yt%)ELSECLR msk%ENDIFELSECLR yi2%ENDIFEXIT IF (MOUSEX<mxl% OR MOUSEX>mxr% OR MOUSEY<myo% OR MOUSEY>myu%) AND yi2%<=mmx%m.key$=INKEY$UNTIL (msk%>0 OR m.key$>"") AND yi2%<=mmx%DEFMOUSE 0DEFFILL 1,0,0GRAPHMODE 1PUT MAX(0,mxl2%),MAX(0,myo2%),mmen$BOUNDARY 1            ! fr V3.0SWAP *f.adr%,dum$()ERASE dum$()*v.adr%=yi2%PAUSE 5RETURNPROCEDURE frn_diskfile$="A:\*.*"DEFTEXT 1,0,0,13head(1,"Load dump fr†n disk")FILESELECT file$,dnam$,o$IF LEN(o$)<>0d%=RINSTR(o$,"\")file$=LEFT$(o$,d%)+"*.*"dnam$=RIGHT$(o$,LEN(o$)-d%) !Namn & efternamn.OPEN "I",#1,o$size%=LOF(#1)CLOSE #1' start%=MALLOC(size%)IF zise%<32000DEFMOUSE 2e$=STRING$(size%," ")tiptext("NAMN: "+dnam$+".   Fil size "+STR$(size%)+".      (Key or Mous)")BLOAD o$,VARPTR(e$)ab$=e$DEFMOUSE 3pressELSEALERT 1,"F”r stor fil.|MAX 32000 Byte.",1,"OK",al%ENDIF'  a%=MFREE(start1%)ENDIF'  start1%=MALLOC(zise1%)' a%=MFREE(start1%)RETURNPROCEDURE frn_syntsynt%=1CLR i%tiptext(" Send en dump fr†n synten.Jag ventar! ")tim%=TIMERDEFMOUSE 2REPEATUNTIL tim%+1200<TIMER OR BIOS(1,3)=-1 ! BIOS(1,3) „r sama som INP?(3).IF BIOS(1,3)=-1status%=BIOS(2,3)+256        ! An offset of 256 is always necessaryIF status%=240               ! In an earlier version the offset wasGOSUB midiinab$=CHR$(&HF0)+e$tiptext(" Dumpsize: "+STR$(LEN(e$))+". Press key or mous. ")DEFMOUSE 3GOSUB pressENDIFENDIFRETURNPROCEDURE midiinCLR e$REPEATCLR i%REPEATINC i%a$(i%)=INPMID$UNTIL INP?(3)=0FOR r%=1 TO i%b%=LEN(a$(r%))e$=e$+a$(r%)'      PRINT AT(1,21);"LEN";b%NEXT r%r%=LEN(e$)LINE 100,(116+r%*0.005)/t%,110,(116+r%*0.005)/t%tim%=TIMERREPEATUNTIL tim%+200<TIMER OR INP?(3)=-1UNTIL INP?(3)=0RETURNPROCEDURE till_diskREPEATfile$="A:\*.*"FILESELECT file$,dnam$,o$EXIT IF LEN(o$)=0GOSUB backuppa%=LEN(db$)BSAVE o$,VARPTR(db$),a%UNTIL 0=0DEFMOUSE 3RETURNPROCEDURE backuppIF EXIST(o$)=-1ALERT 3,"Ska jag g”ra en backupp|p† den gammla filen?",0," Ja.| Nej.",alz%IF alz%=1i%=RINSTR(o$,".")o1$=LEFT$(o$,i%)+"BAK"IF EXIST(o1$)=-1KILL o1$ENDIFNAME o$ AS o1$ENDIFENDIFRETURNPROCEDURE till_syntRETURNPROCEDURE snoppaIF synt%=0e$=RIGHT$(e$,LEN(e$)-13)ELSEe$=RIGHT$(e$,LEN(e$)-8)ENDIFbb$=e$RETURNPROCEDURE 4_8' ---------- H„mta ord som ligger kontenuerligt i U220-BANK. -------tiptext("Arbetar! G”r 4 bits byte till 8 bits byte.")CLR c$a%=LEN(bb$)vh=11/a%DEFMOUSE 2FOR i%=1 TO a% STEP 2LINE 100,(116+i%*vh)/t%,110,(116+i%*vh)/t%a%=ASC(MID$(bb$,i%+1,1))b%=ASC(MID$(bb$,i%,1))IF a%<16 OR b%<16c$=c$+CHR$(a%*16+b%)ELSEc$=c$+MID$(cb$,i%,2)ENDIFNEXT i%cb$=c$RETURNPROCEDURE 8_4tiptext("Arbetar! G”r 8 bits byte till 4 bits byte.")CLR c$a%=LEN(cb$)vh=11/a%DEFMOUSE 2FOR i%=1 TO a%LINE 100,(116+i%*vh)/t%,110,(116+i%*vh)/t%a%=ASC(MID$(cb$,i%,1)) AND &HFb%=ASC(MID$(cb$,i%,1)) AND &HF0IF a%<16 OR b%<16c$=c$+CHR$(a%)+CHR$(b%)ELSEc$=c$+MID$(cb$,i%,1)ENDIFNEXT i%db$=MKD$(&HF041102B)+MKF$(&H12001000)+c$RETURN' ---------------------------------------------------------------' e$=SPACE$(512)' VOID BIOS(4,2,L:VARPTR(e$),1,0,0)PROCEDURE wbuff(du$)deskOPENW 0DEFTEXT ,,,6LOCAL j%,byte%,wi$,flag!GRAPHMODE 1DEFFILL ,0,0PBOX 35,0,571,369BOX 35,0,572,370PRINT AT(6,2);"1  2  3  4  5  6  7  8  9  0  1  2  3  4  5    123456789012345"PRINT AT(6,3);"--------------------------------------------   ---------------"size%=LEN(du$)a%=1REPEATDEFMOUSE 2wi$=MID$(du$,a%,600)FOR j%=0 TO 39PRINT AT(6,CRSLIN);FOR i%=0 TO 14byte%=ASC(MID$(wi$,1+i%+j%*15))PRINT HEX$(byte%,2);" ";NEXT i%PRINT "|"NEXT j%PRINT AT(1,3)FOR j%=0 TO 39PRINT AT(53,CRSLIN);FOR i%=0 TO 14byte%=ASC(MID$(wi$,1+i%+j%*15))IF byte%=0OUT 5,ASC(".")ELSEOUT 5,byte%ENDIFNEXT i%PRINT "|";j%+1NEXT j%DEFFILL 1,2,6DEFTEXT 1,0,0,6PBOX 39,349,567,364DEFFILL ,0,0PRINT AT(9,45);" BYTES ";a%+599;" AV ";size%;" "PRINT AT(44,45);" TILLBAKA | NEXT | EXIT ";IF a%=1DEFTEXT ,2,,6PRINT AT(45,45);"TILLBAKA"DEFTEXT ,0,,6ENDIFIF a%+601>size%DEFTEXT ,2,,6PRINT AT(55,45);" NEXT"DEFTEXT ,0,,6ENDIFDEFMOUSE 3REPEATREPEATMOUSE x%,y%,k%UNTIL k%=1IF y%>350 AND x%>345 AND x%<536SOUND 2,15,2,7,2SOUND 1,0flag!=-1SELECT x%CASE 345 TO 427' TILLBAKAIF a%<>1SUB a%,600ELSEflag!=0ENDIFCASE 428 TO 484' NEXTIF a%+601<size%ADD a%,600ELSEflag!=0ENDIFCASE 485 TO 535' EXITCLR a%ENDSELECTELSEflag!=0ENDIFUNTIL flag!PRINT AT(2,3)UNTIL a%=0CLSCLOSEW 0RETURN'PROCEDURE press'  PBOX -1,-1,640,16' TEXT 230,13,"KLICK MOUSE or KEY."REPEATUNTIL INKEY$=" " OR MOUSEKRETURNPROCEDURE mus_testPRINT AT(17,10);x%;" ";y%;" "TEXT x%-12,y%+3," *"RETURN'PROCEDURE deskGRAPHMODE 1DEFFILL ,2,8PBOX 7,7/t%,636,396/t%DEFFILL ,2,4PBOX 3,3/t%,632,392/t%DEFFILL ,0,0RETURNPROCEDURE update_panelDEFTEXT 3,0,,6/t%i%=71CLR s%REPEATINC s%IF LEFT$(meny$(s%))="-"DEFTEXT ,2,,6TEXT 20,i%/t%,RIGHT$(meny$(s%),LEN(meny$(s%))-1)DEFTEXT ,0,,6ELSETEXT 20,i%/t%,meny$(s%)ENDIFADD i%,13UNTIL s%=menu_ant%RETURNPROCEDURE bildSETCOLOR 1,0,7,0SETCOLOR 2,7,0,0DEFFILL 3,2,8PBOX 12,13/t%,406,50/t%DEFFILL 1,2,2PBOX 10,11/t%,404,48/t%DEFTEXT ,4,,26/t%@stext(16,40/t%,"  Synt dumps kliniken.",4,4)!4 4 St†r f”r skuggans vinkelGET 10,11/t%,406,50/t%,tt$GRAPHMODE 1DEFFILL 1,2,8PBOX 12,58/t%,170,364/t%DEFFILL ,0,0PBOX 10,56/t%,168,362/t%BOX 12,56/t%+2,166,362/t%-2FOR i%=63 TO 348 STEP 13BOX 16,i%/t%-1,162,(i%+21)/t%PBOX 16,i%/t%-1,161,(i%+21)/t%-1NEXT i%GET 10,56/t%,170,365/t%,m.bild$GRAPHMODE 1DEFTEXT ,17,,6-2*(t%-1)DEFFILL ,2,8PBOX 558,13/t%,629,61/t%DEFFILL ,0,0PBOX 555,10/t%,626,58/t%BOX 567,21/t%,585,12/t%BOX 569,19/t%,583,14/t%PBOX 595,11/t%,621,45/t%GET 555,10/t%,629,61/t%,cd$DEFFILL ,2,8PBOX 538,370/t%-cz%*10/t%,630,390/t%DEFFILL ,0,0PBOX 538,370/t%-cz%*10/t%,628,388/t%BOX 540,370/t%-cz%*10/t%+2/t%,626,380/t%-cz%*10/t%+2/t%BOX 540,380/t%-cz%*10/t%+4/t%,626,388/t%-2/t%DEFTEXT ,0,,6/t%+(t%-1)GRAPHMODE 1TEXT 544,386/t%-10/t%*cz%-6/t%,"Try <HELP>"FOR i%=cz% DOWNTO 1TEXT 544,386/t%-10/t%*(cz%-i%)-3/t%,pre$(i%)NEXT i%GET 538,370/t%-cz%*10/t%,630,390/t%,zeilen$GRAPHMODE 1RETURNPROCEDURE stext(s.xt%,s.yt%,s.txt$,s.xo%,s.yo%)GRAPHMODE 2TEXT s.xt%-1,s.yt%,s.txt$TEXT s.xt%+1,s.yt%,s.txt$TEXT s.xt%,s.yt%-1,s.txt$TEXT s.xt%,s.yt%+1,s.txt$TEXT s.xt%+s.xo%,s.yt%+s.yo%,s.txt$GRAPHMODE 3TEXT s.xt%,s.yt%,s.xl%,s.txt$GRAPHMODE 1RETURN' PROCEDURE dcolorPROCEDURE tiptext(tip$)LOCAL tln%GRAPHMODE 1DEFFILL ,0,0DEFTEXT ,0,,13/t%tln%=LEN(tip$)*4PBOX 320/xt%-tln%-6,190/yt%-5,320/xt%+tln%+6,220/yt%+5BOX 320/xt%-tln%-3,190/yt%-2,320/xt%+tln%+3,220/yt%+2BOX 320/xt%-tln%-3,190/yt%-2,320/xt%+tln%+4,220/yt%+3TEXT 320/xt%-tln%,212/yt%,tip$GRAPHMODE 1RETURNPROCEDURE head(h.flg%,h.txt$)LOCAL h.res%,h.hlf%,h.dis%,h.re%,h.bxr%h.txt$=LEFT$(h.txt$,MIN(38,LEN(h.txt$)))IF xt%<>2h.re%=1ENDIFIF h.flg%=1h.hlf%=LEN(h.txt$)*4h.dis%=2-yt%IF xt%<>2h.bxr%=481ELSEh.bxr%=319ENDIFGRAPHMODE 1DEFTEXT 1,0,,13GET 158*h.re%,0,h.bxr%,399/yt%/6,h.bg$DEFFILL 1,2,2PBOX 158*h.re%,16/yt%+h.dis%*16,h.bxr%,(50/yt%-h.dis%*12)+h.dis%*16DEFFILL 1,0,0PBOX 320/xt%-h.hlf%-2,16/yt%+h.dis%*16,320/xt%+h.hlf%+2,(50/yt%-h.dis%*12)+h.dis%*16TEXT 320/xt%-h.hlf%,(44/yt%-h.dis%*10)+h.dis%*16,h.txt$ELSEPUT 158*h.re%,0,h.bg$CLR h.bg$ENDIFRETURNPROCEDURE blinker(b.flg%,bxl%,byo%,bxr%,byu%)DEFFILL 1,2,8GRAPHMODE 3PBOX bxl%/xt%,byo%/yt%,bxr%/xt%,byu%/yt%IF b.flg%=0PAUSE 10PBOX bxl%/xt%,byo%/yt%,bxr%/xt%,byu%/yt%ENDIFGRAPHMODE 1RETURN'PROCEDURE meny_dataERASE meny$(),a$()DIM a$(2000)CLR i%RESTORE m.datasREPEATINC i%READ a$UNTIL a$="**"menu_ant%=i%-1DIM meny$(menu_ant%)RESTORE m.datasFOR i%=1 TO menu_ant%READ meny$(i%)NEXT i%CLR synt%RETURNm.datas:DATA Load dump.DATA -Save dump.DATA ------------------DATA -SnoppaDATA ------------------DATA -4 till 8.DATA -8 till 4.DATA ------------------DATA -A Till bild.DATA -B Till bild.DATA -C Till bild.DATA -D Till bild.DATA -E Till bild.DATA ------------------DATA EXITDATA **