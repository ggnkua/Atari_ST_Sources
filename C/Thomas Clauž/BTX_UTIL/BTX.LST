PRINT AT(1,10);" BTX-Manager-Utility Ω *TCS*"
'
FOR i=1 TO 8
  GET (60+i)*8,0,(60+i)*8+7,15,b$
  FOR ii=16 TO 25
    TEXT 100,100,CHR$(ii)
    GET 100,87,107,102,a$
    PUT 0,19,a$
    PUT 0,35,b$
    aas!=TRUE
    FOR iix=19 TO 34
      FOR ix=0 TO 7
        IF POINT(ix,iix)<>POINT(ix,iix+16)
          aas!=FALSE
        ENDIF
        EXIT IF NOT aas!
      NEXT ix
      EXIT IF NOT aas!
    NEXT iix
    IF aas!
      d$=d$+STR$(ii-16)
    ENDIF
    EXIT IF aas!
  NEXT ii
NEXT i
@fuell2(6,"0",d$,*d$)
a=VAL(LEFT$(d$,2))*3600+VAL(MID$(d$,3,2))*60+VAL(RIGHT$(d$,2))
IF a>0
  @fuell1(6," ",STR$(a),*a$)
  PRINT "Online-Dauer:  ";a$;" Sek."
  @fuell1(2," ",STR$(INT(a/480)+1),*b$)
  PRINT "Zeitt.  8 Min:";b$;" Einh."
  @fuell1(2," ",STR$(INT(a/720)+1),*c$)
  PRINT "Zeitt. 12 Min:";c$;" Einh."
  IF EXIST("gebÅhren.btx")
    OPEN "A",#1,"gebÅhren.BTX"
  ELSE
    OPEN "O",#1,"gebÅhren.BTX"
    PRINT #1,"Mailbox                  Online-Zeit        GebÅhreneinheiten im"
    PRINT #1,"                        Datum     Zeit  Minuten   Sek.  8 12  BTX-GebÅhren   R M"
    PRINT #1,"---------------    ---------- --------  ------- ------ -- --  ------------------"
  ENDIF
  d$=LEFT$(d$,2)+":"+MID$(d$,3,2)+":"+RIGHT$(d$,2)
  e$="BTX            am: "+DATE$+" "+TIME$+" "+d$+" "+a$+" "+b$+" "+c$
  WHILE LEN(e$)<80
    e$=e$+" "
  WEND
  PRINT #1,e$
  CLOSE #1
ENDIF
PROCEDURE fuell1(laenge.%,mit_was$,ziel$,rueckgabe%)
  IF LEN(ziel$)<laenge.%
    ziel$=STRING$(laenge.%-LEN(ziel$),mit_was$)+ziel$
  ENDIF
  *rueckgabe%=LEFT$(ziel$,laenge.%)
RETURN
PROCEDURE fuell2(laenge.%,mit_was$,ziel$,rueckgabe%)
  IF LEN(ziel$)<laenge.%
    ziel$=ziel$+STRING$(laenge.%-LEN(ziel$),mit_was$)
  ENDIF
  *rueckgabe%=LEFT$(ziel$,laenge.%)
RETURN
