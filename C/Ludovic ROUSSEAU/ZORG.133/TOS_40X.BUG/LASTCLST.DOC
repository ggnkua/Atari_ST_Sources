ZORG, Copyright Ludovic Rousseau 1993, 1994


  Le GEMDOS du TOS 4.0? (TOS du Falcon030) est bugg‚ (En tout cas au moins la
version 4.02).

  Ce Bug empŠche le GEMDOS de pouvoir acc‚der … un fichier qui utilise le
dernier cluster du disque. Comme aprŠs une r‚organisation les fichiers se
trouvent … la fin du disque, ce cluster est automatiquement utilis‚ par un
fichier. Ce fichier n'est donc plus accessible (le systŠme rend une taille de
-1 pour ce fichier).

  Pour r‚soudre le problŠme il faut lire le fichier autrement que par l'appel
GEMDOS Fread() par exemple en utlisant l'appel BIOS Rwabs() qui "attaque" le
disque … un niveau beaucoup plus bas et sans passer par le systŠme de
fichiers.


  J'ai hacker un petit programme pour cela. Il s'agit vraiment d'un hack, en
particulier le programme ne sait r‚cup‚rer qu'un fichier contig (de toute
fa‡on le fichier est contig aprŠs une r‚organisation).
  L'interface est trŠs primaire. Il faut donner en particulier la taille du
fichier en octet et le num‚ro de secteur de d‚but du fichier. Ces informations
peuvent ˆtre r‚cup‚r‚es grƒce … ZORG (qui n'est pas bugg‚ lui :-) ). Le plus
simple est de se mettre … la fin du disque, de demander le nom de fichier
correspondant au secteur (Control-J) puis d'‚diter le r‚pertoire contenant ce
fichier (Control-X) pour r‚cup‚rer la taille du fichier en question. Le premier
secteur du fichier peut ˆtre trouv‚ en remontant dans le disque … partir de la
fin jusqu'au d‚but du fichier ou en regardant le cluster de d‚part du fichier
donn‚ dans l'entr‚e du r‚pertoire (il faut convertir le num‚ro de cluster en
num‚ro de secteur).

  Ces indications ne sont pas trŠs claires mais si le TOS n'‚tait pas bugg‚
elles en seraient pas n‚cessaires.

J'ai mis les sources au cas o— quelqu'un se d‚ciderait … am‚liorer le
programme.




				Ludovic Rousseau Novembre 1994.
