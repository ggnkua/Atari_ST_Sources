
	SCRDUMP/XALTHELP
	GEMDUMP

geschrieben von Th. Morus Walter
(c) 1994 by Never Ready Software, Morus Walter

Dieses Programm ist FREEWARE!

Th. Morus Walter
Schulstr. 22
93080 Pentling

e-mail: morus.walter@rphs1.physik.uni-regensburg.de

 - - - - -

Die Verwendung des Programmes geschieht auf eigene Gefahr.
Der Autor gibt keine Garantie fÅr irgendwas!

 - - - - -

SCRDUMP.ACC/XALTHELP.PRG sowie GEMDUMP.ACC sind zwei Varianten eines
xIMG-Screendump-Programmes.
Beide Varianten erlauben die Speicherung des (gesammten) Bildschirms
in eine (x)Image-Datei via ALT/HELP sowie die Speicherung des Bildschirms,
eines Fensters oder eines - mittels Maus festzulegenden - Rechtecks.
Die TOS-Hardcopy lÑût sich (ab Tos1.4) mittels CTRL/ALT/HELP weiterhin
aufrufen.

Stellt sich natÅrlich die Frage worin der Unterschied zwischen den
Varianten liegt:

XALTHELP.PRG ist ein residentes Programm (das man im allgemeinen im
Auto-Ordner starten wird), das das ALT/HELP-Flag abfragt und gegebenenfalls
den Screendump durchfÅhrt. SCRDUMP.ACC dient lediglich zum Einstellen
der Parameter von XALTHELP.PRG und zum Aufruf fÅr das Speichern von
Fensterinhalten oder Rechtecken.
Diese Vorgehensweise hat zwar den Vorteil, daû der ALT/HELP-Dump
jederzeit aufgerufen werden kann, verwendet aber GEMDOS-Routinen
im Interupt (was nicht erlaubt ist, meistens aber doch gut geht).
ACHTUNG! 'meistens aber doch gut geht' ist natÅrlich keinerlei Garantie.
Ich habe ein Ñhnliches Screendump-Programm lange Zeit verwendet und
bin dabei nie abgestÅrzt. Allerdings sollte man darauf verzichten
Screendumps ausgerechnet dann aufzurufen, wenn man davon ausgehen kann,
daû das GEMDOS gerade am werkeln ist, also insbesondere nicht wÑhrend
Dateioperationen. Beim Testen mit XALTHELP ist es mir problemlos
gelungen unter solchen UmstÑnden AbstÅrze zu verursachen.
(z.B.: Aufruf von wc *.* in der Mupfel (Gemini); drÅckt man dann
ALT/HELP so ist ein Absturz ziemlich sicher.)
Der Bildschirm wird in XALTHELP mittels LineA-Variablen und Xbios-Funktionen
angesprochen; dies ist natÅrlich nicht GEM-konform und lÑuft deshalb
nur in original ST (TT?,Falcon?) und verwandten Bildschirmmodi (z.B.
Overscan) nicht aber mit Graphikkarten.

GEMDUMP.ACC ist demgegenÅber ein 99% GEM-konformes und legales Programm.
(zum letzten Prozent s.u.).
Intern wird in der VBL-Routine zum Abfragen des ALT/HELP-Flags lediglich
ein Flag gesetzt, das Accessory fragt dieses Flag regelmÑûig (Timer-Event)
ab und fÅhrt gegebenenfalls den Screendump durch.
Nachteil dieses Verfahrens ist, daû man auf die Funktion des Timerevents
angewiesen ist. Unter Single-Tasking-Tos ist dies beispielsweise immer dann
NICHT der Fall, wenn Programme lÑngere Berechnungen durchfÅhren ohne
den GEM-Evntmanager aufzurufen, wenn man TOS-Programme laufen lÑût...
Kurz, immer dann, wenn kooperatives Multitasking (MultiGEM, Mag!X 1.x)
versagt, dann versagt auch GEMDUMP.
Unter Mag!X 2.0 (prÑemtives Multitasking) (und vermutlich auf MultiTOS)
sieht es besser aus. Hier sind (abgesehen vom Single-Start eines Programmes
unter Mag!X, wo ja Accessories abgeschaltet werden) kaum EinschrÑnkungen
zu erwarten.
Wird der Screendump mittels ALT/HELP ausgelîst und das Accessory kann nicht
innerhalb einer Sekunde den Dump durchfÅhren, so wird der ALT/HELP-Aufruf
ignoriert.
Beim Aufruf via ALT/HELP - und das ist das letzte Prozent nichtkonformitÑt -
wird der Bildschirmzugriff nicht mittels
	wind_update(BEG_UPDATE)/wind_update(END_UPDATE)
angemeldet (wie es sein sollte), weil nur so ein aktueller Screendump
auch dann mîglich ist, wenn ein anderes Programm den Bildschirmzugriff belegt.

Zusammenfassung:
wenn Sie ein SingleTaskingTos, einen ST in Original (oder Overscan)-Auflîsung
und womîglich wenig Speicher haben, so sollten Sie die XALTHELP/SCRDUMP
Variante zumindest einmal ausprobieren.
ES SEI HIER ABER NOCHMALS AUSDRUECKLICH DARAUF HINGEWIESEN, DASS ES IN
SELTENEN FAELLEN STATT EINES SCREENDUMPS AUCH BOMBEN GEBEN KANN.
Ansonsten ist GEMDUMP wohl vorzuziehen.

Bedienung:
==========
Die beiden Accessories kînnen genauso auch als Programm verwendet werden
(einfach umbenennen).
Die Dialoge sind - bis auf eine zusÑtzliche Option in GEMDUMP - gleich.
Im Dialog kann zunÑchst der Pfad und (Rumpf-)Name der Bilder festgelegt
werden. Dieser wird beim Speichern um eine Nummer und die Endung '.IMG'
ergÑnzt. Mit dem Button links Åber dem Namensfeld kann man den Dateiselector
zur Einstellung des Pfades aufrufen.
Mit dem Button 'Bildnummer zurÅcksetzen' kann an erreichen, daû beim
öbernehmen der Einstellung die Nummer des nÑchsten Bildes wieder auf
0 gesetzt wird, mit dem Button 'X-Imgage schreiben' kann man wÑhlen
ob eine einfache GEM-Image-Datei ohne Farben (Button nicht selektiert)
oder eine XImage-Datei mit Farben geschrieben werden soll.
In GEMDUMP kann man mit einem weiteren Button einstellen, ob die
Abfrage des ALT/HELP-Flags eingeschaltet sein soll (ist sie dies
nicht, kann man natÅrlich keinen Screendump via ALT/HELP aufrufen;
dafÅr spart man sich die zehnmal in der Sekunde auftretenden Timerevents).

Zum Verlassen des Dialoges gibt es sechs Button:

'Abbruch' verlÑût den Dialog, ohne irgendwelche Aktionen.
In allen anderen FÑllen werden die eingestellten Optionen eingelesen.
Bei 'Setzen' ist dies die einzige AktivitÑt, bei 'Sichern' werden
die Daten in die Programmdatei, die man mittels Dateiselector auswÑhlt,
geschrieben (XALTHELP bzw. GEMDUMP).
'Fenster', 'Rahmen' und 'alles' dienen dem Auslîsen der Hardcopy.
Bei Fenster kann man anschlieûend ein Fenster anklicken und es wird nur
dessen Inhalt gespeichert. Mausklick rechts bricht die Funktion ab. Klickt
man auf den Hintergrund, so wird der ganze Bildschirm ohne MenÅleiste
gespeichert. Ist ein Fenster teilweise Åberdeckt, so werden die öberdeckungen
natÅrlich mit abgespeichert.
Bei 'Rahmen' kann man mittels 'Gummiband' ein Rechteck aufziehen, dessen
Inhalt dann abgespeichert wird,
bei 'alles' wird der ganze Bildschirm (wie beim ALT/HELP-Aufruf) abgespeichert.

Tritt beim Speichern ein Fehler auf (zuwenig Speicher frei, Dateifehler...),
so wird dieser natÅrlich nur dann gemeldet, wenn der Aufruf vom Accessory
aus erfolgte. Beim ALT/HELP-Aufruf wird das Speichern einfach komentarlos
abgebrochen.

Anmerkungen zur Speicherung der Farben:
bei GEMDUMP werden die Farben wie es sich gehîrt mittels GEM ermittelt,
bei XALTHELP findet das XBIOS Verwendung. Im letzeren Fall werden die
pro Farbe nur die unteren 3 Bit (ST-Modus, fÅr STE wird ein Bit verschlampt)
verwendet.

Anmerkung zu GEMDUMP:
prinzipbedingt benîtigt GEMDUMP zum Speichern eines Bildschirms (oder
eines Teils eine Bildschirm) die doppelte Menge an Speicher, wie
fÅr den Bildschirm (oder den Teil) nîtig ist.
SCRDUMP begnÅgt sich demgegenÅber bei Bildschirmausschnitten mit
der einfachen Grîûe des Blockes, beim Speichern der ganzen Seite
in Åberhaupt kein Speicher nîtig.

Anmerkung zum Installieren:
das Programm kann natÅrlich nur dann funktionieren, wenn kein anderes
Programm das ALT/HELP-Flag ausliest und lîscht.
Beide Programm sind nicht in der Lage, die VBL-Queue zu vergrîûern, wenn
diese bereits voll ist (sollte aber gewîhnlich nicht passieren). Das
gleiche gilt bie XALTHELP fÅr den Cookie-Eintrag: ist der Cookie-Jar
voll, so kann er von XALTHELP nicht erweitert werden (this is somehow
a bug).
P.S.: installiert wird das Programm natÅrlich dadurch, daû man XALTHELP.PRG
in den AutoOrdner (Position ziemlich egal, bei niedriegen TOS-Versionen
muû vorher ein anderes Programm einen Cookie-Jar anlegen) und SCRDUMP.ACC
ins Wurzelverzeichnis des Bootlaufwerkes (oder von wo auch immer man
die ACCs bootet) kopiert, fÅr GEMDUMP indem man GEMDUMP.ACC zu den ACCs
kopiert.

Patchmîglichkeit bei GEMDUMP:
die HÑufigkeit der Timerevents und die Zeit, die zwischen ALT/HELP-Aufruf
und Speicherung vergehen darf kann im Programm gepatched werden.
Dazu muû man mit einem Diskettenmonitor oder einem anderen geeigneten Mittel
in der Programmdatei die (2 Byte) Integerwerte in (Byte) Position 30 und
32 Ñndern (nach diesen beiden Integern steht ein Magic mit dem Inhalt
'TMMW'). Der erste Wert ist die Zeit fÅr den Timerevent in Millisekunden
(eingestellt ist 100). Der zweite Wert gibt die erlaubte Zeit in 200 Hz
ZÑhler Ticks an, eingestellt ist 200, also ein Sekunde.


noch ein Hinweis:

	NIE WIEDER FASCHISMUS! NIE WIEDER KRIEG!
	WIDER DIE NEUE (UND ALTE) RECHTE!

