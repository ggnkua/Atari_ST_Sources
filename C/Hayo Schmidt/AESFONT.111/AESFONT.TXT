
                     A E S  F o n t  L o a d e r  
                     ---------------------------
                          Shareware-Version


Klappentext

Installiert  neue  AES-Systemfonts und optional  einen  neuen  Default 
Systemfont oder einen neuen Konsolenfont.

Die rsrc-Routinen des AES werden erweitert,  so daû der neue  Iconfont 
korrekt dargestellt wird.

Zielgruppen  dieses  Programms  sind  Besitzer  von  Grafikkarten  und 
entsprechenden Monitoren, Sehbehinderte und Programmierer.

1. Vorwort

Seit  1985 gibt es die Atari Computer mit  GEM-OberflÑche  schon.  Von 
Anfang  an  war ein nachladbares GDOS dabei,  mit dem man  jede  Menge 
schîner und weniger schîner GEM-Fonts seinen Programmen zur  VerfÅgung 
stellen kann.

Was aber haben die Programmautoren anfangs daraus gemacht?  Sie  haben 
recht  - nichts.  Seit einigen Jahren verbreitet sich GDOS aber  immer 
mehr,  besonders  seit es das schnelle NVDI gibt.  Es gibt  inzwischen 
viele  Programme,  besonders  im  Shareware-Bereich,  die  ihre  Text-
ausgaben  mit GEM-Fonts bewerkstelligen.  Eine angenehme  Abwechslung, 
wurde  man doch jahrelang mit immer demselben  'system  font'-Einerlei 
in schwere existenzielle Krisen gestÅrzt.

Doch halt,  was ist das. Da ist ja noch das AES, das nach wie vor stur 
mit  dem 8x8 system font in den niedrigen und dem 8x16 system font  in 
den  hohen Auflîsungen seine Ausgaben tÑtigt.  Dazu kommt  noch  immer 
derselbe Icon-Font.

Das  hat ein Ende,  denn es gibt AESFONT.  Sie brauchen nur  noch  ein 
GDOS, dann kînnen Sie zur Tat schreiten.

2. Einleitung

AESFONT  wird  im Autoordner nach  GDOS  gestartet.  Die  GDOS-Version 
meldet  ein  oder  zwei GDOS-Fonts beim AES  an.   Der  kleinere  Font 
(SMALL)  wird  danach  fÅr die Icontexte und  die  kleine  Schrift  in 
Dialogen verwendet,  der groûe (IBM) fÅr alle Åbrigen Textausgaben des 
AES. 

ZusÑtzlich   kann  der  voreingestellte  Font  fÅr   GEM-Applikationen 
verÑndert werden und ein neuer Font fÅr die Konsolenausgabe angemeldet 
werden.

Dieses  Handbuch  soll  Ihnen  die  Bedienung  erleichtern.   Sie  ist 
gegliedert  in einen Teil,  der dem reinen Anwender die  Mîglichkeiten 
erklÑrt.  Es schlieût sich eine Beschreibung der Programmiererschnitt-
stelle an.

3. Installation:

Kopieren  Sie  AESFONT.PRG  in  den  Autoordner und AESFONT.CNF in das
Wurzelverzeichnis ihres Bootlaufwerks. Kopieren Sie die Fonts in ihren
GDOS-Fontordner  (z.B.  \GEMSYS). Nennen Sie ihr bisheriges ASSIGN.SYS
in  ASSIGN.OLD  um  und  ersetzen  es  durch  das  ASSIGN.SYS  aus der
AESFONT-Distribution.   Tragen   Sie   in   ASSIGN.SYS  den  korrekten
GDOS-Pfad ein. Voreingestellt ist 'PATH=\GEMSYS\'.

FÅhren Sie jetzt einen Reset aus. Der Rechner lÑuft hoch. Jetzt sollte 
zunÑchst  GDOS  starten  und spÑter  AESFONT.  Wenn  alles  gut  geht, 
erscheint  jetzt der Desktop mit einem neuen Satz Fonts.

Wenn nicht,  ÅberprÅfen Sie,  ob das GDOS richtig installiert ist,  es 
muû vor AESFONT gestartet werden.  Benennen Sie ggf. den Autoordner um 
und kopieren alle Programme einzeln in der gewÅnschten Reihenfolge  in 
einen   neuen   Autoordner.   Einfacher  ist   die   Benutzung   eines 
AUTOSORT.PRG.

Wenn   es  immer  noch  nicht  geht,   schalten  Sie   alle   weiteren 
Autoordnerprogramme  aus und probieren es erneut.  Irgendein  Programm 
kînnte  unvertrÑglich sein.  Versuchen Sie ggf.  rauszufinden  welches 
und  schicken  eine  Fehlermeldung an die  am  Ende  dieses  Handbuchs 
angegebene Adresse.

Wenn  es  immer  noch nicht funktioniert,  setzen  Sie  sich  mit  dem 
Programmautoren  in  Verbindung.  Schildern Sie mîglichst  genau  ihre 
Probleme.  Im unwahrscheinlichen Fall,  daû es stÑndig AbstÅrze  gibt, 
wird  AESFONT  duch  DrÅcken der '*-'Taste  der  numerischen  Tastatur 
abgebrochen.

Die  ausgelieferte  Shareware-Version enthÑlt  verschiedene  Beispiel-
installationen als CNF-Dateien,  die ausprobiert werden  kînnen.  Wenn 
Ihnen eine gefÑllt,  kînnen Sie eine aus alt und neu kombinierte GDOS-
Installation herstellen.  Stellen Sie fest,  welche Fonts Sie fÅr  das 
AES verwenden.  Tragen Sie diese Fonts im ASSIGN.OLD ein und speichern 
die  Datei  als ASSIGN.SYS ab.  Dabei wird das  Test-ASSIGN.SYS  Åber-
schrieben.

Wer   lieber   eine  eigene  Installation  zusammenstellt   und   alle 
Mîglichkeiten  ausschîpfen  will,  muû  nun aufmerksam  den  Rest  des 
Handbuchs durchlesen.  GenÅgsamere Zeitgenossen kînnen es erstmal weg-
legen, verpassen aber auch eine Menge.

4. Spezielle Probleme mit anderen Systemerweiterungen

Beim   Betrieb  mit  MiNT  sollte  AESFONT  mîglichst  nach   MINT.PRG 
gestartet werden. Bei MultiTOS ist das allerdings nicht zwingend.

5. Konfigurationsvariablen von AESFONTæ

Sie  kînnen die Funktionen Åber  Environmentvariablen oder  Åber  eine 
Konfigurationsdatei steuern.

5.1. Environmentvariablen

Environmentvariablen werden von dazu bestimmten  Autoordner-Programmen 
gesetzt.  Wie  das gemacht wird,  entnehmen sie bitte  der  jeweiligen 
Programmanleitung (z.B.  SETENV,  OVERSCAN,  JCNBOOT, MINT, MultiTOS). 
AESFONT wertet das Environment des AES aus, nicht sein eigenes.

5.2. Konfigurationsdatei

Es  kann auch eine Datei namens AESFONT.CNF in  das  Wurzelverzeichnis 
des Bootlaufwerkes gelegt werden. Sie muû folgendes Format aufweisen:

1. der Name der Environmentvariablen in Groûbuchstaben
2. ein Gleichheitszeichen
3. der Wert der Variablen in Ziffern
4. beliebiger Kommentar
5. CR/LF.

Die Datei kann mit jedem Åblichen Editor erstellt werden.  Wichtig ist 
nur  die Trennung der Zeilen durch CR/LF.  FÅhrende  Leerzeichen  sind 
nicht erlaubt.

Beispiel:

AF_VERBOSE=1        * Es darf geschwatzt werden
AF_FONTID=15        * Typewriter
AF_FONTHEIGHT=12    
AF_SMALLID=22       * Rufus 5 pt
AF_SMALLHEIGHT=5
AF_WINDOWPATCH=1

Ausgewertet  wird  zunÑchst die CNF-Datei und  dann  die  Environment-
variablen.  Es gilt der zuletzt gesetzte Wert.  Alle Werte werden ggf. 
von MultiTOS-Einstellungen Åberdeckt.

5.3. Die Konfigurationsvariablen im einzelnen

Groûer AES-Font (IBM):

AF_FONTID      Font ID des groûen AES-Fonts (IBM).  Gilt auch fÅr  den 
               SMALL-Font, wenn dieser nicht explizit gesetzt wird.

AF_FONTHEIGHT  Hîhe des Fonts (IBM) im absolute mode (vst_height).

AF_FONTPOINT   Hîhe im points mode (vst_point).
               HEIGHT und POINT sind alternativ zu verwenden.

Kleiner AES-Font (SMALL):

AF_SMALLID     Font ID des kleinen Icon-Fonts (SMALL).

AF_SMALLHEIGHT Hîhe im absolute mode.

AF_SMALLPOINT  Hîhe im points mode (alternativ).

Default Font:

AF_DEFAULTID   Font  ID  des Default Fonts,  d.h.  des Fonts  mit  dem 
               GEM-Applikationen von Haus aus arbeiten.

AF_DEFAULTHEIGHT
               Hîhe im absolute mode.

AF_DEFAULTPOINT
               Hîhe im points mode.

Console Font (Bios, Gemdos und VDI-Escape):

AF_CONID       Font  ID  eines neuen Fonts  fÅr  die  Console.
     Hinweis:  Der  Font darf kein Vektorfont sein und  muû  unbedingt 
               eine  feste  Breite von 8 Pixeln fÅr alle  255  Zeichen 
               besitzen.  Bei Benutzung eines GDOS,  das  Fontswapping 
               beherrscht,  muû  der Font im ASSIGN.SYS  als  resident 
               angemeldet werden.  Wenn das GDOS das nicht kann,  ver-
               bietet sich eine Benutzung  dieser Variablen.

AF_CONHEIGHT   Hîhe im absolute mode.

AF_CONPOINT    Hîhe im points mode (alternativ).

     Hinweis:  FÅr den Console-Font gilt,  daû nicht  notwendigerweise 
               die aktuell eingestellte Grîûe verwendet wird,  sondern 
               der     zugrundeliegende    GDOS-Font     in     seiner 
               ursprÅnglichen Grîûe.
     WARNUNG:  Die Benutzung der Console-Funktionen erfolgt auf  eige-
               ne Gefahr.  Sie ist als Schmankerl gedacht und wird auf  
               nachladbaren  Bildschirmtreibern  wahrscheinlich  nicht 
               korrekt laufen.

Sonstige Optionen:

AF_VERBOSE     GeschwÑtzigkeit.  Wenn =  1,  dann werden  ausfÅhrliche 
               Informationen  Åber den Programmablauf auf der  Console 
               ausgegeben.  Als Hilfe zur Fehlersuche gedacht.  Sollte 
               als erste Variable gesetzt werden.

     WARNUNG:  Darf   auf   keinen  Fall   unter   AutoSwitch-OverScan 
               angestellt  werden,  da  Ñltere  Treiber  einen  Fehler 
               enthalten,  der Daten im RAM schwer  beschÑdigt!  Unter 
               MultiTOS  ist  es  bisweilen  ebenfalls  zu   AbstÅrzen 
               gekommen.

AF_ALIGNMENT   Neues   vertikales   Alignment   fÅr   den    AES-Font. 
               Eingabeparameter  fÅr  vst_alignment.  Setzt  die  AES-
               Fonts  in  der  vertikalen  hoch  bzw.   runter.   Wird 
               eigentlich nicht benîtigt.

AF_NODESKFIX   Wenn Wert = 1,  kein Fixen der Desktop-Resourcen im RAM 
               oder der DESKICON.RSC bzw.  DESKCICON.RSC.  Bietet sich 
               an fÅr Leute,  die niemals den Atari-Desktop zu Gesicht 
               bekommen,  weil  sie lieber Gemini,  Ease oder  Neodesk 
               benutzen.  Auûerdem  bei  der Verwendung  von  MultiTOS 
               sinnvollerweise  in MINT.CNF,  da der Fix dort  ohnehin 
               ÅberflÅssig ist.

AF_WINDOWPATCH Wenn  Wert = 1,  wird verhindert,  daû Fenster  in  die 
               MenÅzeile hinein geîffnet werden.

AF_GETINFOPATCH Wenn Wert = 1,  werden  bei  appl_getinfo Typ 0 und  1 
               die  von  AESFONT angemeldeten Fonts  als  RÅckgabewert 
               eingetragen.
     Hinweis:  Da sowohl unter MagiC!  als auch unter MultiTOS falsche 
               RÅckgabewerte  kommen,  sollte dieser Patch  auf  jeden 
               Fall eingeschaltet sein.

AF_1WPATCH     Patch  fÅr  1st  Word,   der  work_out[47/48]  auf  die 
               Grîûe des  Default  Fonts und work_out[45/46]  auf  die 
               Grîûe des Icon Fonts setzt. Wert muû = 1 sein.
     Hinweis:  Da  1st Word+ diese Parameter  als  Grîûeneinstellungen 
               fÅr  seine Textausgaben verwendet und gleichzeitig  die 
               Koordinaten   anhand   von   graf_handle()   errechnet, 
               nur  sinnvoll,  wenn   AES-Font  und  Default  Font  in 
               gleichen   Grîûen   vorliegen  und   zwar   fÅr   beide 
               Fontgrîûen.

AF_NOWORK10    Wenn Wert = 1,  wird ein Patch ausgeschaltet,  der  den 
               Wert von work_out[10] beim v_opnvwk()  korrigiert.  Der 
               Patch  macht Gebrauch von negativen  Line  A-Variablen. 
               Alle bekannten offiziellen VDI-Versionen enthalten  den 
               entsprechenden  Fehler.  Einzige  Auswirkung  ist,  daû 
               einige  Programme zu viele Fonts zur  Auswahl  stellen, 
               wobei die ÅberzÑhligen immer nur den Systemfont  reprÑ-
               sentieren.

"Verbotene" Konfigurationsvariablen:

AF_FLYHACK     Hack,  um  mit Programmen  zurechtzukommen,  die  starr 
               eine  der 3 Systemfontgrîûen  einsetzen.  Das  betrifft 
               vor allem Fliegende Dialoge.
               Wenn der Wert 1 ist,  werden diverse vst_height-Aufrufe 
               mit den Grîûen 4,  6 und 13 auf die  korrespondierenden 
               Grîûen  des  AES-Fonts  gesetzt und  der  AES-Font  als 
               aktueller eingestellt.
               Ist der Wert 2,  dann wird vor allen  vst_point-Aufrufe 
               von 8,  9 und 10 Punkten der korrespondierende AES-Font 
               eingestellt.  Daû dabei tatsÑchlich die richtige  Grîûe 
               eingestellt wird, ist nicht gesagt.
               Bei einem Wert von 3 werden beide Hacks eingeschaltet.

     WARNUNG:  Diese  Funktion  sollte  nicht  im  tÑglichen   Betrieb 
               benutzt werden,  sie dient lediglich dazu,  die leichte 
               Anpaûbarkeit  vieler  Programme an  AESFONT  zu  demon-
               strieren.

AF_LOADHACK    Wenn Wert = 1,  wird bei jedem vst_load_fonts die  Zahl 
               der  zusÑtzlichen Fonts vom ersten Ladeversuch  zurÅck-
               geben.  Wenn AF_DEFAULTID gesetzt ist und ein  Programm 
               die GDOS-Fonts nicht findet, hilft dieser Hack.

AF_UNLOAD      Wenn Wert <> 0,  werden  die Fonts nach Ermittlung  der 
               Daten wieder entladen (Testfunktion fÅr MultiTOS).

AF_CHAMHACK    Der  Wert  gibt die Verzîgerung gemessen  in  Bios-Auf-
               rufen  an,  mit der der  Trap #2-Handler  reinstalliert 
               wird.  
               Notwendig  ist das im Zusammenhang mit  ChamÑleon  1.19 
               und  AF_DEFAULTID.  Beim Nachladen von Accessories  mit 
               eigener virtueller Workstation,  gibt es einen  totalen 
               Systemabsturz. Wenn AF_CHAMHACK >=8 ist, geht es trotz-
               dem  (ohne  GewÑhr).   
               Bei  Anwesenheit von NVDI ist AF_CHAMHACK  auf  mindes-
               tens 3 gestellt.

Bei  allen HEIGHT,  POINT und ID-Funktionen fÅhrt ein Wert von  0  zum 
Ignorieren  der entsprechenden Funktion.  Alle nicht  genannten  Werte 
fÅhren zu unvorhersehbaren Resultaten.

5.4. Beispielkonfiguration

Die  folgende Konfiguration wÅrde den Typewriter aus  dem  Atari-GDOS-
Paket  und  den sattsam bekannten 6x6 system font  als  AES-Fonts  an-
melden.  Auûerdem wÅrden die Konsolenausgaben mit dem 8x8 system  font 
erfolgen.  Ein  Fixen der Desktop-Resource im RAM findet nicht  statt. 
Die  Farbe  des  AES-Fonts ist 5.  1st Word wird  mit  dem  Typewriter 
ausgeben  (hoch- und tiefgestellte Texte sind aber unleserlich).

AF_FONTID=15
AF_FONTHEIGHT=12
AF_SMALLID=1
AF_SMALLHEIGHT=4
AF_CONID=1
AF_CONHEIGHT=6
AF_NODESKFIX=1
AF_COLOR=5
AF_1WPATCH=1

5.5. Die optimale Konfiguration

Man sollte in jedem Fall versuchen,  die Eingriffe von AESFONT in  das 
VDI zu minimieren.  Unvermeidlich ist in jedem Fall,  daû wÑhrend  des 
ôffnens der Workstation seitens des AES umfangreiche zusÑtzliche  VDI-
Aufrufe  erfolgen.  Vermeidbar  ist aber,  daû  wÑhrend  der  weiteren 
Laufzeit  VDI-Aufrufe manipuliert werden.  Dazu muû man auf die  Vari-
ablen AF_SMALLID,  AF_DEFAULTID. AF_DEFAULTHEIGHT, AF_DEFAULTPOINT und 
AF_1WPATCH verzichten.

Der Grund liegt darin,  daû AESFONT bestimmte VDI-Aufrufe abfÑngt  und 
vor oder nach diesen eigene VDI-Aufrufe absetzt.  Diese Art rekursiven 
Aufrufs des Trap #2 kînnte theoretisch Trap-Handler anderer  Programme 
Åberfordern, wenn diese etwas nachlÑssig geschrieben sind.

Die ErgÑnzungen der rsrc-Routinen des AES sind stÑndig aktiv.  Nur der 
WINDOWPATCH  und der GETINFOPATCH kînnen  beeinfluût  werden.  Da  das 
Abfangen  der AES-Aufrufe auf dem saubersten mîglichen  Wege  erfolgt, 
sind hier bei allen TOS-Versionen keine Probleme zu befÅrchten.

Wenn der VDI-Bildschirmtreiber negative Line A-Variablen nicht  unter-
stÅtzt, kann der Konsolenfont nicht manipuliert werden und AF_NOWORK10 
muû  auf 1 gesetzt werden.  Dieser Fall dÅrfte hîchstens  bei  Grafik-
karten auftreten.

6. Fonts in AESFONTæ

Sinnvoll  verwendet  kînnen  alle  unproportionalen  GDOS-Fonts,  auch 
Vektorfonts.  Das sind solche, die nur Zeichen gleicher Breite enthal-
ten,   also   etwa  der  beim  Atari-GDOS   mitgelieferte   Typewriter 
(ATTP10.FNT).

6.1 AES-Fonts

Bei der Zusammenstellung von SMALL und IBM-Font ist zu  beachten,  daû 
das BreitenverhÑltnis mîglichst 4:3 betragen sollte.  Das hÑngt  damit 
zusammen,  daû  dies  bei den Systemfonts des TOS auch der  Fall  ist. 
Wenn  dieses  VerhÑltnis nicht erreicht werden kann,  so  ist  ein  zu 
hoher Wert,  also etwa 9:6,  gÅnstiger als ein zu niedriger. Je grîûer 
die  Abweichung ist,  desto unschîner erscheinen die Textausgaben  mit 
dem SMALL-Font in Dialogen.

Zur   Hîhe   ist  zu  sagen,   daû  ein  VerhÑltnis  von   4:3   nicht 
unterschritten   werden  sollte.   Als  grober  Richtwert   kann   ein 
VerhÑltnis von etwa 2:1 angegeben werden.

Der IBM-Font sollte alle Atari-Spezialzeichen enthalten,  die z.B. die 
Fensterelemente symbolisieren.  FÅr MagiC! braucht man eine Spezialan-
passung fÅr den Backdropbutton, wie bei den mitgelieferten Fonts.

Auûerdem   sollten  beide  Fonts  die  gleiche  ID   haben,   um   dem 
Betriebssystem  unnîtige  Eingriffe  durch  AESFONT  zu  ersparen  und 
Anwendungsprogramme nicht zu Åberfordern.  Also sollte man im  Zweifel 
die ID per Diskettenmonitor oder Fonteditor anpassen.

Auflîsungswechsel  kann  man  Åberstehen,  indem man  nur  die  POINT-
Konfigurationsvariablen verwendet und in ASSIGN.SYS die der  Auflîsung 
entsprechenden  Fonts  eintrÑgt.   Z.B.  ATTP10.FNT  fÅr  ST-HIGH  und 
ATTP10CG.FNT fÅr ST-MID.

6.2 Default Font
 
Wird ein Font als Default-Font verwendet,  dann sollte zusÑtzlich  zur 
Bedingung  der UnproportionalitÑt unbedingt das sogenannte  Monospaced 
Flag im Fontheader gesetzt sein.

6.3. Konsolenfont

Der  Font fÅr die zeichenorientierten Ausgaben des  BIOS,  GEMDOS  und 
der  VDI-Escape-Funktionen  auf  die  Konsole  (Bildschirm),  muû  ein 
unproportionaler  Font  mit 8 Pixeln Breite und  gesetztem  Monospaced 
Flag sein. Alle anderen werden abgelehnt.

6.4. Verzeichnis der mitgelieferten Fonts

Zur  Zeit  werden  3  Fontkombinationen  mitgeliefert.  Sie  sind  den 
Systemfonts  des  TOS nachempfunden,  so daû keine  groûe  Umgewîhnung 
nîtig ist.

SMALL-Font                         IBM-Font
Dateiname  ID  Fontname            Dateiname    ID  Fontname

AES5X6.FNT 257 aes font 5x5 7x12   AES7X12.FNT  257 aes font 5x5 7x12
AES7X8.FNT 513 aes font 7x8 10x20  AES10X20.FNT 513 aes font 7x8 10x20
AES9X9.FNT 769 aes font 9x9 12x24  AES12X24.FNT 769 aes font 9x9 12x24

Die  gÅnstigste Kombination ist 9x9 und 12x24 aes font,  da  hier  das 
BreitenverhÑltnis exakt 4 zu 3 betrÑgt.

7. Fallstricke und Bugs in AESFONT

Leider ist es nicht zu umgehen,  einige undokumentierte Eigenschaften, 
wie das Auslesen der Resource-Adresse im global-Feld, zuverwenden.

Wird AESFONT im Autoordner vor MiNT gestartet,  wird die  DESKICON.RSC 
bei TOS 2.0x und 3.0x nicht gefixed.  Dadurch sind dann die  Icontexte 
nicht vollstÑndig sichtbar. Abhilfe: AESFONT von MiNT starten lassen.

Der  Desktop des TOS 1.0 lÑuft nicht korrekt,  da er die Resourcen  in 
einem unbekannten,  bereits relozierten Format enthÑlt.  Die Icontexte 
sind  nur eingeschrÑnkt lesbar.  Es wird immerhin  eine  Fehlermeldung 
"AESFONT: unbekanntes Desktopresource Format" (mit Glocke) ausgegeben, 
die allerdings nach ca. 3/10 Sekunden vom GEM gelîscht wird.

Da  die Desktîppe aus der Vor-MultiTOS-éra (Steinzeit)  die  AES-Funk-
tionen nicht Åber Trap #2 aufrufen,  muû von AESFONT beim Startup  des 
GEM an den Desktop-Resourcen gehackt werden.  Deren Adresse ist  zudem 
nicht  bekannt.  Es kann also sein,  daû AESFONT bei  bestimmten  Kon-
figurationen die Resource nicht findet.  Ich bitte fÅr diesen Fall  um 
Bug-Reports.  Nach menschlichem Ermessen sollten alle offiziellen TOS-
Versionen ab TOS 1.04 vernÅnftig laufen.

Die  Fixroutine fÅr die DESKCICN.RSC auf dem Falcon funktioniert  zwar 
inzwischen.   Sie   ist   aber   streng   betrachtet   nicht   korrekt 
implementiert.

Unter MultiTOS wird ÅberflÅssigerweise nach einer RAM-Kopie der  Desk-
top-Resource  gesucht  und zum GlÅck nicht  gefunden.  Es  ist  leider 
nicht mîglich,  die Anwesenheit von MultiTOS vor dem ersten AES-Aufruf 
zu erkennen. Die Desktopresource-Fixfunktion ist aber abschaltbar.

Da G_*TEXT-Objekte an den SMALL-Font angepaût werden mÅssen,  kann  es 
in  seltenen FÑllen vorkommen,  daû diese ca.  2 Pixel  auûerhalb  des 
Mutterobjektes weitergezeichnet werden.  Damit muû man entweder leben, 
oder  die Mutterobjekte im Resource Construction Set auf  Zeichenkoor-
dinaten  snappen  lassen.  Alternativ  kînnen  die  Mutterobjekte  als 
G_*TEXT mit leerem SMALL-Text definiert werden.

8. Bugs der Anderen (natÅrlich viel mehr):

Das  XCONTROL.ACC kommt mit grîûeren Systemfonts  nicht  zurecht.  Wir 
warten jetzt alle auf Ersatz.

Programme, die Ñltere Versionen der FlyDials von J. Reschke verwenden, 
stÅrzen  beim Aufruf von Dialogen mit "Kreisverkehrszeichen" ab  (z.B. 
Gemini 1.21).  Das ist ein seit lÑngerer Zeit behobener Fehler  dieser 
Dialoglibrary gewesen.

Einige  Programme,  wie 1st Word setzen eine öbereinstimmung von  AES- 
und Default-Font voraus.  Sonst schreiben sie einen ziemlichen  Unsinn 
in das Textfenster. Diesem vermeidbaren Fehler hat Atari durch falsche 
VorschlÑge fÅr Entwickler (in Atari.RSC) selber Vorschub geleistet.

Andere Programme (u.a.  viele GFA-Basic-Compilate, Pure C 1.0, Tempus) 
stellen  die MenÅs nicht korrekt dar,  weil sie sie falsch  berechnen. 
Probleme haben auch einige Fileselector-Substitute.

Einige  Accessories wie OverUtil und ProCalc rufen  rsrc_obfix()  auf, 
obwohl  sie  die Resource noch nicht  vollstÑndig  umgerechnet  haben. 
ob_spec  enthÑlt statt eines Zeigers noch einen Index,  was  eindeutig  
ein Bug ist.  AESFONT quittiert das bei gesetztem AF_VERBOSE durch ein 
Klingelzeichen,  jedesmal wenn ein solcher Aufruf kommt.  Dieser  wird 
selbstverstÑndlich nicht nicht durch die Fixroutinen bearbeitet.  Mit-
unter gibt das ein heftiges Gebimmel beim Systemstart.

Ein besonders gefÑhrlicher Fehler steckt im ChamÑleon 1.19.  Das ganze 
System  stÅrzt  ab,  wenn  vom Accessory  eine  virtuelle  Workstation 
geîffnet wird.  Das ganze passiert nur bei AF_DEFAULT-Funktionen. Hier 
geht  der rekursive Aufruf von VDI-Funktionen verschÑrft in die  Hose. 
Als  Ausweg bietet sich die AF_CHAMHACK-Option an.  Es ist am  sicher-
sten,  Åberhaupt  keine Accessories mit dem ChamÑleon  zu  laden,  die 
eine virtuelle Workstation îffnen.

Einige  Ñltere Programme werten die Anzahl der  SystemzeichensÑtze  in 
work_out[10] nicht aus. So kommt es, daû bei angestelltem AF_DEFAULTID 
die GDOS-Fonts nicht mehr erkannt werden.

Magxdesk  berechnet die Umrisse der Desktop-Icons falsch,  so daû  die 
Icons unvollstÑndig verschoben werden und "Schmutz" auf dem Bildschirm 
verbleibt.

Und vieles mehr,  was nicht korrekt lÑuft. Sauber programmierte Appli-
kationen haben keine Probleme.  Positive Beispiele sind MUtility, GEM-
Draw, Kandinsky, IdeaList und der MultiTos-Desktop.

Viele GEM-Fonts haben einen Fehler im Aufbau des  Fontheaders.  Dieser 
macht  sich  durch  ein ungewolltes  unterstreichen  bei  invertierter 
Textausgabe bemerkbar.  Gegenmittel ist das Freeware-Programm  FONTFIX 
von J. Reschke. Verursacher dieses Fehlers ist Åbrigens der Fonteditor 
Fontz!.

AMCGDOS/AMCLIGHT mag es nicht,  wenn die Fonts mit einer ID nicht  der 
Grîûe  nach  in ASSIGN.SYS eingetragen  werden.  Leider  richtet  sich 
ASSIGN.PRG nach der alphabetischen Reihenfolge,  so daû bei Verwendung 
dieses  Utilities  die  beigelegten  AESxxXxx-Fonts  von  Hand   nach-
zusortieren sind.

8.1 KompatibilitÑtsliste:

Viele Programme machen hier und da kleinere bis grîûere Probleme.  Die 
Liste zeigt nur die besonders guten und die groben Ausreiûer.

nicht funktionierende    Grund

Gemini 1.21              Fly Dials by J. Reschke stÅrzen ab.
Rufus 1.06               dito
FontEdit.ACC 2.1         mÅllt den Bildschirm voll

gut funktionierende

DESKTOP                  
MUtil 1.0 und 2.1
PumpUp                   
FontSelector
Multifont                
ACopy 1.2
MDisk 6.92               
1st View
Treeview                 
Idealist 3.10
Turtle 3.20
Kandinsky 
7up 2.2
DB-Point 2.14

bei entsprechender Einstellung gut funktionierende

1st Word       
1st Word Plus  AF_1WPATCH, AF_DEFAULTID = AF_FONTID = AF_SMALLID,
               AF_DEFAULTHEIGHT = AF_FONTHEIGHT, hohe Auflîsung
Gemini 1.99    AF_FLYHACK=1

8.2. Workarounds fÅr spezielle Probleme

Wenn's  auch  Schweiû und TrÑnen kostet,  man kriegt  fast  alles  zum 
Laufen,  was auflîsungsunabhÑngig programmiert ist. Um es ganz klar zu 
sagen,  die folgenden VorschlÑge haben etwas vom Nylonstrumpf, der als 
Keilriemenersatz dient.

1st Word (Plus):
IBM und Default Font mÅssen gleich sein,  IBM und SMALL die gleiche ID 
haben. AF_1WPATCH und AF_WINDOWPATCH werden auf 1 gesetzt.

DR-RCS:
Wenn AF_1WPATCH gesetzt ist,  kann man das RCS mit alternativen  Fonts 
bedienen.  Trotzdem  sollte  man  Resourcen  auf  jeden  Fall  nur  in 
Standardauflîsungen bearbeiten.

Fly Dials [vor 1994] (J. Reschke / Gemini 1.2, Rufus 1.2):
IBM und Default Font mÅssen gleich sein.

Magic Dials [vor 1993] (Peter Hellinger):
IBM und Default Font mÅssen gleich sein.

MultiTOS:
MultiTOS-Verwender  sollten  AF_GETINFOPATCH  einschalten,  damit  die 
richtigen  Font-IDs gemeldet werden.  Da nicht davon  auszugehen  ist, 
daû  Atari  diesen  Bug beseitigt,  wird das vermutlich  bis  in  alle 
Ewigkeit gelten, zumindest aber bis Version 1.08.

MagiC!:
FÅr MagiC gilt ebenfalls daû AF_GETINFOPATCH eingeschaltet werden muû, 
da sonst falsche Werte zurÅckgegeben werden.

9. Hinweise fÅr Programmierer:

9.1. Traps

AESFONT hÑngt in Trap #1,  Trap #2 und Trap #13.  Die XBRA-Kennung ist 
'AFnt'.

Andere VDI-Traphandler,  die sich hinter den Trap hÑngen, mÅssen damit 
rechnen,  daû aus einem VDI-Aufruf heraus ein weiterer rekursiver VDI-
Aufruf (z.B.  von AESFONT) abgesetzt wird.  Es ist also dafÅr Sorge zu 
tragen,  daû man damit zurechtkommt.  Eine Mîglichkeit ist eine  Sema-
phore,  die einen rekursiven Aufruf abweist.  Die bessere  Mîglichkeit 
ist  die  Programmierung eines vollstÑndig reentrant gehaltenen  Trap-
handlers.

AESFONT  1.1 benutzt fÅr Bios,  Gemdos und VDI  Semaphoren.  Der  AES-
Traphandler ist reentrant, so daû das Programm auch mit MagiC! lÑuft.

9.1. Das Programmierinterface

Prinzipiell sollten die Werte aus appl_getinfo verwendet werden,  wenn 
diese Funktion im AES vorhanden ist.

DarÅberhinaus richtet AESFONT 2 Cookies ein. 

Erstens  den Cookie 'SMAL',  der im niederwertigen Wort die Grîûe  des 
Iconfonts (C-Definition:  SMALL) im absolute mode enthÑlt. Im Highword 
enthÑlt  er - optional, aber implementiert - die Grîûe des  IBM-Fonts. 
Das war ein Vorschlag,  der vor einiger Zeit im Mausnetz gemacht wurde 
und zur AbwÑrtskompatibilitÑt enthalten ist.  Die Dialog-Library  Ruby 
von Markus Nick verwendet diesen Cookie.

FÅr AESFONT gibt es ein weiteres Verfahren.  Der zweite Cookie hat die 
Kennung 'AFnt'. Dieser enthÑlt einen Zeiger auf folgende Struktur:

struct
{
     long af_magic;
     int  version;
     int  installed;
     int  cdecl (*afnt_getinfo)(int af_gtype, int *af_gout1,
                 int *af_gout2, int *af_gout3, int *af_gout4);
}AFNT;

TatsÑchlich ist die Struktur noch etwas lÑnger.  Der Zugriff auf diese 
internen   Variablen   wird  aber  nur  bei   Vorlage   guter   GrÅnde 
offengelegt.

Wichtig ist,  zunÑchst die Versionsnummer abzufragen.  Das Lowbyte von 
version  gibt die Versionsnummer des Programms an.  0x0019  wÑre  z.B. 
die Version 1.9,  nÑchste Versionsnummer wÑre 0x0020 (2.0).  

Das  Highbyte von version gibt die  Revision  der  Cookieschnittstelle 
an.  Bei  einer énderung wird diese Zahl  erhîht.  Diese  Beschreibung 
gilt ab V 0.5, Schnittstelle nrevision 0 (0x0005).

Der  Grund fÅr diese etwas komplizierte Definition  liegt  darin,  daû 
zwei  AESFONT-Zweige existieren.  Der eine enthÑlt die Fonts  im  Pro-
grammcode (V 0.0 bis 0.9),  der andere lÑdt sie Åber GDOS (ab  V 1.0).  
Diese  Versionsnummern  haben demnach keinen Einfluû auf  die  Cookie-
schnittstelle.

installed  ist 0,  solange AESFONT zwar geladen,  die Fonts aber  noch 
nicht angemeldet sind.

Man  erkennt,  daû  in  der  Struktur ein  Zeiger  auf  eine  Funktion 
definiert ist. Diese wird Åber folgenden Prototyp definiert (Pure C):

int cdecl (*afnt_getinfo)(int af_gtype, int *af_gout1, int *af_gout2,
                                        int *af_gout3, int *af_gout4);

Nach  Zuweisung des Wertes aus der Struktur,  kann die  Funktion  ganz 
normal aufgerufen werden:

af_greturn = afnt_getinfo(af_gtype, &af_gout1, &af_gout2,
                                    &af_gout3, &af_gout4);

Parameter:

af_gtype - Get information type

           0 - IBM Font Information
               af_gout1 - Fonthîhe
               af_gout2 - Font ID
               af_gout3 - 1 wenn FSM-Font, sonst 0
               af_gout4 - reserviert

           1 - SMALL Font Information
               af_gout1 - Fonthîhe
               af_gout2 - Font ID
               af_gout3 - 1 wenn FSM-Font, sonst 0
               af_gout4 - reserviert

af_greturn - kodierter Returnwert
           1 - kein Fehler
           0 - Fehler     (Achtung, das muû beachtet werden!)

Die   éhnlichkeiten   mit  der  appl_getinfo-Funktion   ist   durchaus 
beabsichtigt. Wenn appl_getinfo existiert, ist diese zu verwenden. Sie 
gibt  -  wenn  sie fehlerfrei implementiert ist - in  jedem  Fall  die 
korrekten  Werte  zurÅck.  Die RÅckgabewerte von  afnt_getinfo  kînnen 
dagegen vom Betriebssystem ungÅltig gemacht werden.

Damit  sollte  es mîglich sein,  alle von  AESFONT  verÑnderten  Werte 
abzufragen.

9.2. Generelle RatschlÑge

Diese RatschlÑge zu beachten kann nicht schaden, auch wenn man AESFONT 
gar nicht explizit unterstÅtzen mîchte.

9.2.1. Resourcen

Allgemein  sollte  man sich bemÅhen,  alle Objekte  in  Resourcen  auf 
Zeichenkoordinaten  snappen zu lassen.  Eine Korrektur der  Maûe  oder 
der  Position  um 1 Pixel stellt danach kein Problem  dar.  Das  wilde 
Erstellen  von Dialogboxen im Panel-Modus fÅhrt dagegen  zu  unschînen 
Ergebnissen, wenn die AES-Fontgrîûe verÑndert wird.

9.2.2. Fonts

Wer  nicht  davon ausgeht,  daû AES-Fonts und  Default  Font  dasselbe 
sind, kann weder bei AESFONT noch bei MultiTOS auf die Nase fallen.

Der  Default  Font  ist derjenige,  den man  nach  dem  ôffnen  seiner 
virtuellen Workstation mit vqt_attributes erfragen kann.

Welches  die  AES-Fonts  sind,  kann  man  auch  ohne  spezielle  AES-
Funktionen  herausfinden.  Es ist allerdings relativ  kompliziert  und 
kommt seinerseits nicht ohne Annahmen aus.

Die  korrekte Methode die Grîûe der AES-Fonts zu  ermitteln,  ist  der 
Aufruf der appl_getinfo-Funktion, die ab AES 4.0 existiert. Nach einer 
allgemein befolgten Konvention existiert appl_getinfo ebenfalls,  wenn 
appl_find("?AGI") als RÅckgabewert 0 ergibt.  ?AGI wird von AESFONT ab 
den  Versionen  0.6  bzw.  1.1 wenn notwendig  in  das  Betriebssystem 
integriert.

AusfÅhrliche  Beispiele  zu  dem Gesagten   liegen  als  C-Quelle  dem 
Programmpaket bei.

Man sollte es tunlichst unterlassen,  Annahmen darÅber zu machen,  was 
die Werte in work_out[45]-[48] bedeuten. Der Autor von AESFONT seiner-
seits  nimmt  an,  daû  es sich um die Grîûen des  kleinsten  und  des 
grîûten  Fontfaces des Systemfonts mit der Nummer 1 in  seiner  natÅr-
lichen Grîûe handelt. Nicht verstanden? War auch nicht beabsichtigt.

10. Der FONTselector

Der FONTselector 1.0 ist wahlweise ein Accessory oder Programm fÅr den 
AES Font Loader.  Mit  ihm  lassen sich die  aktuell  geladenen  Fonts 
anzeigen und Einstellungen fÅr AESFONT tÑtigen.

Der  aktuell  gÅltige Default Font kann  mit  Applikation  eingestellt 
werden,  der  aktuell  gÅltige AES Font mit Resource und  der  aktuell 
gÅltige Konsolenfont Åber Console.
 
Die globalen Einstellungen fÅr AESFONT erreichen Sie Åber MenÅs...  -> 
AESFONT...  oder  F6.  Die  dort getÑtigten  Einstellungen  kînnen  in 
AESFONT.CNF abgespeichert werden.  Vorsicht:  Die alten  Einstellungen 
werden dabei Åberschrieben.

Eine vollstÑndige,  aktuelle Anleitung fÅr FONTselector 1.0 liegt z.Z. 
nicht vor und es ist fraglich, ob es jemals eine solche geben wird.

11. Disclaimer:

Es wird lediglich zugesichert,  daû das Programm in der Lage ist,  auf 
den  Rechnerserien Atari ST und TT unter TOS 1.0 bis 3.06 und bei  den 
MagiC-Versionen  2.0 und 3.0 einen neuen Font beim AES anzumelden  und 
daû dieser im wesentlichen korrekt dargestellt wird.

DarÅberhinausgehende Programmeigenschaften mÅssen nicht unbedingt  auf 
jedem System funktionieren.

Jegliche Haftung ist ausgeschlossen.

12. Verwertungsrechte:

Alle  Rechte  an dem Programm und der Dokumentation  liegen  bei  Hayo 
Schmidt.

Die  Versionen ab 1.0 des AES Font Loader sind Shareware.  Sie  dÅrfen 
den  AES Font Loader  3 Wochen lang kostenlos  testen.  Wenn  Sie  das 
Programm weiterhin nutzen mîchten, mÅssen Sie die Shareware-GebÅhr von 
DM  30.-  entrichten.  Damit erhalten Sie gleichzeitig  die  Nutzungs-
berechtigung fÅr das FONTselector-Accessory.

Wenn  Sie  die  GebÅhr  nicht  entrichten,  mÅssen  Sie  das  Programm 
lîschen.  Eine  lÑngerfristige Benutzung ohne Zahlung  der  Shareware-
GebÅhr entspricht der widerrechtlichen Benutzung einer Raubkopie.  Die 
Archivierung einer nicht installierten Version ist erlaubt.

FÅr geizige,  aber ehrliche Menschen sei an dieser Stelle der  Hinweis 
auf  die AESFONT-Versionen bis 0.99 erlaubt.  Diese sind Freeware  und 
dÅrfen unentgeltich benutzt werden.

Sie  kînnen einen Scheck an die unten angegebene Adresse  senden  oder 
eine  öberweisung auf das Konto Nr. 56 62 671 bei der  Deutschen  Bank 
Hamburg,  BLZ 200 700 00 tÑtigen.  DafÅr erhalten Sie die registrierte 
Version  von  AESFONT.PRG.  Bitte  beachten Sie,  da·  ich  durch  die 
öberweisung nicht automatisch Ihre Adresse erhalte.

Die Verbreitung der vollstÑndigen Version auf Shareware-Disketten  und 
CD-ROM ist unter Beachtung folgender EinschrÑnkungen erlaubt:

- Die Programmversion darf bei Aufnahme in die Diskettensammlung  oder 
  beim Premastering der CD-ROM nicht Ñlter als 1 Jahr sein.  Das Datum 
  wird beim Start von AESFONT.PRG ausgegeben.
- Disketten dÅrfen maximal DM 10.- kosten und mÅssen zu mindestens 50% 
  mit Daten gefÅllt sein.
- AESFONT  darf  nicht ohne Genehmigung als  Zugabe  zu  kommerziellen 
  Programmen  oder Hardware (z.B.  Grafikkarten,  Monitore)  beigelegt 
  werden.
- Das  Sharewareprinzip muû in den Begleittexten verstÑndlich  erklÑrt 
  werden.
- Der Autor wird vor der Aufnahme in der Sammlung informiert,  um ggf. 
  rechtzeitig eine neue Version zusenden zu kînnen.

Die kostenfreie Verbreitung Åber private Diskettenkopien und Mailboxen 
mit einer JahresgebÅhr unter DM 125.- ist uneingeschrÑnkt erlaubt.

Jegliche darÅberhinausgehende Weiterverbreitung mu· genehmigt  werden. 
Wer  dagegen  verstî·t,  wird auf Unterlassung  und  Schadenersatz  in 
Anspruch genommen.


Fehlermeldungen und konstruktive Kritik an:

E-Mail:
   Hayo Schmidt @ HH          MausNet
   Hayo_Schmidt@hh.maus.de    Internet
   100305,1424                CompuServe

Gelbe P*st:
   Hayo Schmidt
   Grotiusweg 1
   22587 Hamburg

Hamburg 04/95  v1.11

