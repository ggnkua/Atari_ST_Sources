   V1.1                                                          08.05.95
   
   Liebe ATARI-Freunde,

   Der FONTselector ist Bestandteil des AES Font Loader-Paketes. Das Paket 
   ist zu privaten Zwecken frei kopierbar und darf  weitergegeben  werden. 
   Die  dauerhafte Nutzung erfordert die Zahlung der SHAREWARE-GebÅhr  fÅr 
   AESFONT.

   Der FONTselector  ist  ein  kombiniertes  Accessory/Programm,  d.h  Sie 
   kînnen es als ACC oder als PRG starten.

   Der FONTselector ermîglicht die Auswahl von geladenen GDOS-Fonts.

   Der FONTselector arbeitet auflîsungsunabhÑngig.

   Der FONTselector wurde in Pure-C geschrieben.


   Hier nun eine kurze Beschreibung der Elemente des Dialogfensters:
   ----------------------------------------------------------------- 
    
   Das  FONTselector-Fenster  funktioniert im Grundsatz  genauso  wie  das 
   Kontrollfeld,  d.h. Sie kînnen die Box innerhalb des Bildschirms belie-
   big verschieben.

   ZusÑtzlich ist eine Tastatursteuerung integriert.

   Im  'FONT #'-Feld wird die Font-Identifikation des  Fonts  eingestellt. 
   Dazu sind die Pfeile anzuklicken.
   Tasten: Cursor links/rechts.

   Der  aktuelle  Zeichensatz  kann gleichfalls Åber  das  Popup-MenÅ  des 
   FONTselector-Image eingestellt werden.
   Taste: F5

   Mit 'POINTS' wird die Zeichengrîûe eingestellt.
   Tasten: Cursor hoch/runter.

   Im  Beispieltext (graues Feld rechts oben) wird der aktuelle  Font  mit 
   den eingestellten Textattributen Grîûe angezeigt. 
   Darunter steht der Name des Fonts.
   Durch Doppelklick auf das Feld wird eine Tabelle des angezeigten  Fonts 
   gezeigt.
   Taste: F1.
   FONTselector 1.1   beherrscht  die  FONT_CHANGED-Message  gemÑ·   Font-
   Protokoll Rev. 3 von Christian Grunenberg. Man mu· lediglich das Objekt 
   mit dem Beispieltext auf das  Fenster einer Anwendung ziehen,  die  das 
   Protokoll beherrscht.  Wenn gleichzeitig eine Shifttaste gedrÅckt wird, 
   Åbernehmen alle Fenster der Applikation den neuen Font.

   Durch  Doppelklick  auf das FONTselector-Logo erhÑlt man  eine  Tabelle 
   des Default-System-Fonts.
   Taste: F3.

   'Fonts  laden' fÅhrt ein vst_load_fonts() fÅr die  VDI-Workstation  von 
   FONTSLCT durch.
   Taste: Insert.

   'Fonts entladen' fÅhrt ein vst_unload_fonts() durch.
   Taste: Delete.

   'SPEZIALEFFEKTE' stellt die Texteffekte wie kursiv und fett ein.
   Tasten: erster Buchstabe.

   'EINSTELLEN FöR' stellt den aktuellen Font ein als
          'Resource' fÅr  MenÅs und  GEM-Dialoge.  Ist  disabled, 
             wenn die Grîûe des Fonts nicht stimmt.
          Taste: R.
          'Applikation'  - Setzt im Zusammenhang mit AESFONT  einen  neuen 
             Default  Font fÅr neugeîffnete  virtuelle  Workstations.  Der 
             Wert wird beim Sichern von AESFONT.DNF mitgespeichert.
          Taste: Return.
          'Console' - meldet mit v_fontinit() einen 8 Pixel breiten, fixen 
             Font als Console-Font an.
          Taste: C.

   Im 'MODUS'-Feld wird eingestellt,  ob die Einstellung  im 'points' mode 
   (vst_points())  oder im 'absolute' mode (vst_height())  erfolgen  soll. 
   Mit dem selektierten 'points'-Knopf kann ein Popup mit den  verfÅgbaren 
   Punktgrî·en des aktuellen Fonts aufgerufen werden.
   Tasten: erster Buchstabe.

   öber  'MenÅs...'  werden weitere Features  des  FONTselector  erreicht. 
   Taste: F4
   
     Text Inqiry...                                          Taste: ^I
          Inquire Attributes     RÅckgabewerte von vqt_attributes()
          Inquire Fontinfo       RÅckgabewerte von vqt_fontinfo()
          ------------------
          AuszÅge neg. Line A    wichtige negative Line A-Variablen
          aktueller Fontheader   Daten aus dem aktuellem Fontheader
          ----------------------
          Abbruch
     --------------
     aktueller Font              Tabelle eingestellter Font  Taste: F1
     Systemfont                  Tabelle Default Systemfont  Taste: F3
     Console Font                Tabelle Console Font        Taste: F2
     -------------- 
     Parameter...                Parameterdialog FONTselectorTaste: ^P
     Hilfe                                                   Taste: HELP
     --------------
     AESFONT...                  Einstellungsdialog AESFONT  Taste: F6
     --------------
     Abbruch


   Parameterdialog
     'Neg. Line A und v_fontinit verwenden'  ist  nur bei  Verwendung  eines 
          Standard-VDI sinnvoll.  Mit NVDI sollte der Eintrag deselektiert 
          sein.  In  diesem Falle ist auch der Console-Button  nicht  mehr 
          vorhanden.
     'Dauerhaftes Malloc (actPD anpassen)' ist nur mit einem Single-TOS  und 
          ohne Verwendung von AESFONT sinnvoll.  Mit diesem Hack kann  der 
          FONTselector dort GDOS-Fonts dauerhaft laden.
     'GDOS-Fonts fÅr das AES' brauchen nur geladen werden, wenn kein AESFONT 
          lÑuft und der Standard-AES-Font gegen einen Font gleicher  Grîûe 
          ersetzt werden soll.
     'GDOS-Fonts automatisch laden' heiût,  daû beim Start des  FONTselector 
          ein vst_load_fonts() durchgefÅhrt wird.
     'Redraw-Buffer'  beschleunigt den Redraw der Zeichentabellen etwas  und 
          kostet im Gegenzug etwas Speicherplatz.
     'Cookie-Installation'
          'automatisch'  FOse-Cookie wird automatisch installiert
          'nachfragen'   Alert-Nachfrage
          'nein'         es wird kein Cookie installiert
   FÅr den Betrieb als Hilfsprogramm fÅr AESFONT ist der FOse-Cookie nicht 
   notwendig.

   Einstellungsdialog AESFONT
     GeschwÑtzigkeit             setzt AF_VERBOSE
     appl_getinfo berichtigen    setzt AF_GETINFOPATCH
     work_out[45-48] anpassen    setzt AF_1STWPATCH
     work_out[10] berichtigen    setzt AF_NOWORK10
     vst_load_font immer <>0     setzt AF_LOADHACK
     Fensterposition anpassen    setzt AF_WINDOWPATCH
     Fixen der Desktop Resource im RAM stellt diese Option an oder aus
     AES-Font                    setzt Werte des groûen AES-Fonts
     SMALL-Font                  setzt Werte des Icon-Fonts
     Fliegende Dialoge  A P      setzt AF_FLYHACK (Absolute/Points mode)
     Verzîgerungszahl            setzt AF_CHAMHACK
   Die Einstellung kann mit Sichern in AESFONT.CNF gespeichert werden, mit 
   OK vorÅbergehend Åbernommen oder mit Abbruch verworfen werden.

   Die Help-Taste liefert einige Seiten Hilfstext.

   Die  Esc-Taste zeichnet das FONTselector-Fenster neu,  Shift-Esc  fÅhrt 
   einen Redraw fÅr den gesamten Arbeitsbereich des Bildschirms aus.

   Mit dem Schlieûfeld des Fensters wird das Fenster geschlossen.
   Tasten: Ctrl-U, Ctrl-C

   Die  meisten Objekte der Resource kînnen mit einem RCS gesetzt  werden. 
   Sie  werden beim Erststart als FONTselector-Voreinstellungen  beachtet.  
   In   'FONT#'  und  'POINTS'  stehen  die  jeweiligen  Maximalwerte  des 
   Nummernkreises. Der MODUS und die SCHRIFTART werden beachtet.

   Die Datenstruktur von FONTselector

   Der  FONTselector  besitzt  eine interne  Datenstruktur,  auf  die  aus 
   anderen Programmen heraus zugegriffen werden kann.  Die folgende  Doku-
   mentation hat mehr historischen Charakter, aber wenn es schon drin ist, 
   warum  soll ich es rauswerfen.  Anwendungsprogrammierer sollten  lieber 
   auf  die Fontselekoren mit UFSL-,  xFSL- oder vollstÑndiger  Drag&Drop-
   Fontprotokoll-Schnittstelle zurÅckgreifen.

   Bei Accessory-Betrieb kann die Adresse dieser Struktur Åber die Message 
   0xF05E  und Sub-msgcode 1 in Wort 3 des Åbergebenen  Buffers  abgefragt 
   werden  (mittels  appl_write()).  Man erhÑlt dann  die  Message  0xF05E 
   zurÅck mit Sub-msgcode 2 und der Adresse in Wort 4 und 5.

   Der  Cookie   mit  der Kennung 'FOse' wird  vom  Programm  FOSEINST.PRG 
   installiert,  das  am besten aus dem Auto-Ordner  gestartet  wird.  Das 
   Programm installiert zusÑtzlich die Datenstruktur  resident.  Ansonsten 
   startet  der  FONTselector das Programm nach,  wenn es  im  Auto-Ordner  
   oder im FONTSLCT-Ordner zu finden ist.  Das Programm ist nicht zwingend 
   notwendig,   wenn   man  auf  den  Cookie-Eintrag  und  die   residente 
   Speicherung  der Datenstruktur verzichten kann.  Der Cookie 'FOse'  und 
   enthÑlt einen Zeiger auf die programminterne Datenstruktur.

   Auf  die  Struktur   kann aus  anderen  Programmen  heraus  zugegriffen 
   werden.   Dadurch   kann  in  anderen  Programmen  Åber  FONTSLCT   ein 
   bestimmter  Font und eine Grîûe ausgewÑhlt werden.  Auûerdem ist  diese 
   Datenstruktur  das ElefantengedÑchtnis,  wenn Sie den FONTselector  nur 
   als  Programm  verwenden   -  alle  Einstellungen  bleiben  auch   nach 
   Programmende erhalten.

   Wenn  Sie  das  Dialogfenster an  einer  bestimmten  Stelle  erscheinen 
   lassen wollen,  dann kînnen Sie die X- und Y-Koordinate des  Dialogfel-
   des - entsprechend den Koordinaten des Arbeitsbereiches des Fensters  - 
   manipulieren.

   Offset    Typ    Zugriff      Inhalt      Bedeutung
   
    0        LONG   read only    "FOse"      Kennung - zur  öberprÅfung 
                                             der GÅltigkeit des Zeigers. 
    4        LONG   read only    $00010000   Versionsnummer.


    8        WORD   read only    $....       Font-ID des im  Beispiel-
                                             fenster dargestellten Fonts.
   10        WORD   read only    $....       Fonthîhe.

   12        WORD   read/write   $....       Texteffekt.
                                                 
   14        WORD   read/write   $0001       Modus: points   = 1
                              o. $0000              absolute = 0.
                                           
   16        WORD   read         $....       Font-ID des Application-
                                             Fonts.
   18        WORD   read         $....       Fonthîhe.

   20        WORD   read         $....       Texteffekt.

   22        WORD   read         $0000       Modus.
                              o. $0001       

   24        WORD   read only    $....       Font-ID des Resource-Fonts.
                                             
   26        WORD   read only    $....       Fonthîhe.

   28        WORD   read only    $....       Texteffekt.


   30        WORD   read/write   $....       X-Koordinate der Dialogbox.

   32        WORD   read/write   $....       Y-Koordinate.

   34        WORD   read only    $....       Breite.

   36        WORD   read only    $....       Hîhe.


   38        WORD   read/write   $....       VDI-Handle von FONTSLCT.

   40        WORD   read only    $....       Handle des Fensters.


                                
   Bei den Texthîhenmodi gilt der Wert 1 fÅr den points mode,  0  fÅr  den 
   absolute mode.  Alle anderen Werte fÅhren dazu, daû der aktuelle Status 
   der 'MODUS'-Buttons gilt.  FÅr Resourcen ist der Modus natÅrlich  immer 
   absolute.

   Auf  die Datenstruktur soll aus anderen Programmen zugegriffen  werden. 
   Es  bleibt dabei dem Programmierer Åberlassen,  ob er  den  angezeigten 
   Beispielfont oder den gewÑhlten Application-Font verwendet.

   Die  mit  'write'  gekennzeichneten Werte kînnen  auch  extern  gesetzt 
   werden. Nach VerÑnderung der Werte ist ein Redraw auszulîsen.

   Der  VDI-Handle   kann  auf den  eines  anderen  Programmes   umgebogen 
   werden,  wodurch der FONTselector de facto auf einer fremden  VWorksta-
   tion arbeitet.  Der Handle kann durch den Wert -1 wieder  zurÅckgesetzt 
   werden.  Der VDI-Handle  ist beim Schlieûen der VWorkstation auf  jeden 
   Fall rÅckzusetzten.

   Wenn FONTSLCT.PRG mit pexec() gestartet wird,  kann durch die  öbergabe 
   des  Kommandos  'X'  (1  Zeichen) die  Ausgabe  der  meisten  Meldungen 
   unterdrÅckt werden.  Hierzu gehîrt insbesondere der Alert, wenn sie den 
   VDI-Handle  vom FONTselector auf den eigenen umbiegen.  Die  mîglicher-
   weise geladenen GDOS-Fonts werden beim terminieren nicht entladen.

   Als Beispiel kînnen Sie sich das Programm FOSEEXMP.GFA ansehen.

   Da alle GDOS-Versionen unter AMCGDOS 4.0  die Wanze enthalten,  daû mit 
   vst_load_fonts()  erstmalig  geladene Fonts in  der  Speicherverwaltung  
   die gerade geladene Hauptapplikation als Owner verpaût bekommen,  biegt 
   FONTSLCT.ACC vor dem Aufruf 'load fonts' den aktuellen Prozeûdeskriptor 
   auf  die  eigene Basepage (was laut Atari illegal  ist),  wenn  das  im 
   Parameter-Dialog entsprechend eingestellt wurde. Ansonsten wÅrden unter 
   Single-TOS nach dem Verlassen der Hauptapplikation die Speicherbereiche 
   mit den Fonts wieder freigegeben und diese Åberschrieben, was natÅrlich 
   beim nÑchsten Ausgabeversuch mit diesen Fonts zum Absturz fÅhrte.

   Warnung:
   -------- 
   FONTselector  darf mit dem Accessory 'The Chameleon'  installiert  wer-
   den.   Jedoch   kann  der  FONTselector   auûerhalb  des   GEM-Desktops 
   FOSEINST.PR?  nicht nachladen,  da es dann zum Absturz kÑme.  Also  ist 
   FOSEINST vorher zu starten.
   Auf  meiner  Konfiguration (TOS 1.4) stÅrzte in diesem Fall  jede  lau-
   fende  Hauptapplikation ab,  nicht jedoch der FONTselector.  Der  Grund 
   dafÅr  liegt  im Dunkeln des TOS,  aber es wird wohl nicht  ohne  Grund 
   davor gewarnt pexec() aus Accessories aufzurufen.
   Desgleichen   stÅrzt  das  System ab,  wenn  zwei  Accessories  in  der 
   Bootphase ein pexec() durchfÅhren (vermutlich deswegen!?).

   Im folgenden ein Zitat des Atari Programmierers Allan Pratt:

   C. Kaernbach's question was why his accessory, which basically did
   a Pexec from a file selector, didn't always work.  The answer is that
   it works when used within a program which has returned enough memory to
   the OS for the child.  Why might it bomb?  Because if a program has
   returned a *little* memory to the OS (only about 2K), a bug in Pexec 
   shows up that breaks the memory manager.  Accessories are strange beasts
   anyway, so for the most part combining two strange beasts (Accessories
   and Pexec) is bad news.

   /----------------------------------------------\
   | Opinions expressed above do not necessarily  | -- Allan Pratt, Atari Corp.
   | reflect those of Atari Corp. or anyone else. |    ...lll-lcc!atari!apratt
   \----------------------------------------------/    (APRATT on GEnie)

   Es  muû  hier  zugegeben  werden,  daû FOseINST  in  das  letzte  obere 
   Kilobyte des Speicher gequetscht wird,  um eine  Speicherfragmentierung 
   zu   vermeiden.   Das  sind  etwas   fragwÅrdige   Optimierungsversuche 
   meinerseits gewesen, aber es funktioniert nach wie vor.
   Demnach  ist  bei AbstÅrzen dieses Accessories in der  Bootphase  immer 
   zunÑchst ein Versuch mit FOseINST im Auto-Ordner zu machen.

   Disclaimer:
   ----------- 
   FÅr  die  FunktionsfÑhgkeit dieses Software-Produktes wird  weder  eine 
   GewÑhr  gegeben,  noch  kann  eine Haftung  fÅr  eventuell  auftretende 
   SchÑden an Ihrer Hard- und Software Åbernommen werden.

   Adresse:
   -------- 
   Hayo Schmidt
   Grotiusweg 1
   22587 Hamburg

   EMail:
   ------
   MausNet: Hayo Schmidt@HH
   
   Bankverbindung:
   --------------- 
   Deutsche Bank Hamburg, Bankleitzahl 200 700 00, Konto-Nr. 56 62 671


   ---------------------------------------- 
   [˝FONTselector is a trademark of HayoSoft]

