*******************************************************
* THE DIGISYNTH SCREEN FROM THE LOST BOYS MIND BOMB   *
* FEW THINGS ABOUT THIS SCREEN:-                      *
* FIRST I DIDN'T WRITE THE DIGISYNTH REPLAY ROUTINES  *
* ROB POVEY DID, CONSEQUENTLY I DON'T REALLY UNDERSTAND*
* THEM ALL THAT WELL SO TO A LARGE EXTENT YOU'LL HAVE *
* TO FIGURE IT OUT FOR YOURSELF. SECONDLY PLAYING THIS*
* DIGISYNTH TAKES BETWEEN 40 AND 50 % CPU TIME.       *
* THIRDLY IT USES ALL THE REGISTERS EXCEPT D6,D7,A5,A6*
* THUS IT IS QUITE HARD TO PROGRAM A DECENT SCREEN    *
* WHILE PLAYING A QUARTET TUNE......                  *
*******************************************************
	
	CLR.L -(SP)			SET SUPERVISOR
	MOVE.W #$20,-(SP)
	TRAP #1
	ADD.L #6,SP

	MOVE.L D0,OLDSP			SAVE USER STACK
	LEA MYSTACK(PC),A7		PUT IN OUR STACK
	MOVE.L	$FFFF8200.W,OLDPHYS	NOTE SCREEN ADDRESS
	
	MOVEQ #$12,D0			TURN OFF MOUSE AND JOYSTICKS
	BSR IKBD
	MOVEQ #$1A,D0
	BSR IKBD

	JSR MAKEUPSTARS			MAKE UP THE STARS FROM THE DATA
	JSR SHIFTER			PRE SHIFT FONTS
	JSR CLEARSCREEN			CLEAR THE WORK SCREENS
	MOVEM.L PALETTE(PC),D0-D7	PUT IN PALETTE
	MOVEM.L D0-D7,$FFFF8240.W
	LEA TEXT,A6			PUT UP TEXT AT TOP OF SCREEN
	BSR MOVE_TEXT
	BSR DO_SIGN			PUT ON 'MEGACOOL' SIGN
	LEA SONG5,A6			MOVE SONG NUMBER 5 INTO PLAY BUFFER
	BSR MOVEIT

	BSR SAVEOLDMFP			PRESERVE INTERRUPTS
	BSR START			START TUNE
	MOVE.L #VBL,$70.W		PUT IN VBL
	MOVE.W #$2300,SR		ALL SYSTEMS GO!
LOOP		
	CMP.B #$39,KBUFF		QUIT?
	BEQ.S END
	CMP.B #$3B,KBUFF		TUNE 1
	BEQ TUNE1
	CMP.B #$3C,KBUFF		TUNE 2
	BEQ TUNE2
	CMP.B #$3D,KBUFF		TUNE 3
	BEQ TUNE3		
	CMP.B #$3E,KBUFF		TUNE 4
	BEQ TUNE4
	CMP.B #$3F,KBUFF		TUNE 5
	BEQ TUNE5
	CMP.B #$40,KBUFF		TUNE 6
	BEQ TUNE6
BACK1B

	BRA LOOP			OK BUT KEEP TRYING

END	

	BSR STOP			TURN OFF MUSIC
	
	BSR GETOLDMFP			RESTORE MFP

	MOVEQ #$16,D0			TURN BACK ON MOUSE AND JOYS
	BSR IKBD
	MOVEQ #$8,D0
	BSR IKBD

	MOVE.L	#$7770000,$FFFF8240.W

	MOVE.L	OLDPHYS,$FFFF8200.W

	MOVE.L OLDSP,-(SP)
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADD.L	#6,SP
	CLR.W	-(SP)			AAAAARRRRGGH!
	TRAP	#1

PALETTE	DC.W $000,$000,$333,$333,$555,$555,$413,$555
	DC.W $777,$777,$302,$777,$524,$777,$201,$635
OLDPHYS	DC.L	0

VBL	
	CLR.B 	$FFFFFA1B.W		TIMER B IN 2 LINES
	MOVE.B #2,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L #HBL3,$120.W
	MOVEM.L D6-D7/A5-A6,-(A7)
	MOVE.L #$00000000,$FFFF8240.W
	MOVE.L #$70000,LOGBASE
	MOVE.L #OLDSTARS,OLDSTARPOINT
	JSR SCROLL1			SCROLLER
	JSR ERASESUB			ERASE STARS SUBROUTINE
	JSR STARSSUB			DRAW STARS ROUTINE
	BSR CHANINDS			VOLUME INDICATORS
	MOVE.L #$70000,D7
	LSR.W #8,D7
	MOVE.L D7,$FFFF8200.W
	MOVE.L #VBL1,$70.W
	MOVEM.L (A7)+,D6-D7/A5-A6
	RTE

HCOUNT	DC.W 	62

VBL1
	CLR.W $FFFF8240.W		AS ABOVE BUT FOR OTHER SCREEN
	CLR.B 	$FFFFFA1B.W
	MOVE.B #2,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L #HBL3,$120.W
	MOVEM.L D6-D7/A5-A6,-(A7)
	MOVE.L #$00000000,$FFFF8240.W
	MOVE.L #$78000,LOGBASE
	MOVE.L #OLDSTARS1,OLDSTARPOINT
	JSR SCROLL1
	JSR ERASESUB			ERASE STARS SUBROUTINE
	JSR STARSSUB			DRAW STARS ROUTINE
	BSR CHANINDS
	MOVE.L #$78000,D7
	LSR.W #8,D7
	MOVE.L D7,$FFFF8200.W
	MOVE.L #VBL,$70.W
	MOVEM.L (A7)+,D6-D7/A5-A6
	RTE

MOVEIT
	LEA SONGBUFFER,A5		MOVES A NEW TUNE INTO THE BUFFER
	MOVE.W #2500,D7
MLOOP	MOVE.L (A6)+,(A5)+
	DBF D7,MLOOP
	RTS
************************************
* ROUTINES FOR TUNE CHANGES.       *
************************************

TUNE1
	BSR STOP
	LEA SONG1,A6
	BSR MOVEIT
	LEA TEXT1,A6
	BSR MOVE_TEXT
	BSR START
	BRA BACK1B
TUNE2
	BSR STOP
	LEA SONG2,A6
	BSR MOVEIT
	LEA TEXT2,A6
	BSR MOVE_TEXT
	BSR START
	BRA BACK1B
TUNE3
	BSR STOP
	LEA SONG3,A6
	BSR MOVEIT
	LEA TEXT3,A6
	BSR MOVE_TEXT
	BSR START
	BRA BACK1B
TUNE4
	BSR STOP
	LEA SONG4,A6
	BSR MOVEIT
	LEA TEXT4,A6
	BSR MOVE_TEXT
	BSR START
	BRA BACK1B
TUNE5
	BSR STOP
	LEA SONG5,A6
	BSR MOVEIT
	LEA TEXT5,A6
	BSR MOVE_TEXT
	BSR START
	BRA BACK1B
TUNE6
	BSR STOP
	LEA SONG6,A6
	BSR MOVEIT
	LEA TEXT6,A6
	BSR MOVE_TEXT
	BSR START
	BRA BACK1B

*************************************************
* MOVES A SMALL LINE OF TEXT ONTO TOP OF SCREEN *
*************************************************

MOVE_TEXT
	LEA $701E0,A5
	MOVE.L A6,D6
	MOVE.W #139,D7
MMLOOP1
	MOVE.W (A6)+,(A5)
	LEA 8(A5),A5
	DBF D7,MMLOOP1
	MOVE.L D6,A6
	LEA $781E0,A5
	MOVE.W #139,D7
MMLOOP2
	MOVE.W (A6)+,(A5)
	LEA 8(A5),A5
	DBF D7,MMLOOP2
	RTS

************************************
* PUT ON MEGA COOL SIGN            *
************************************

DO_SIGN
	LEA SIGN,A6
	LEA $70000+(160*16),A5
	MOVE.W #639,D7
DDLOOP1
	MOVE.W (A6)+,(A5)
	LEA 8(A5),A5
	DBF D7,DDLOOP1
	LEA SIGN,A6
	LEA $78000+(160*16),A5
	MOVE.W #639,D7
DDLOOP2
	MOVE.W (A6)+,(A5)
	LEA 8(A5),A5
	DBF D7,DDLOOP2
	RTS

**********************************************
* THE CHANNEL INDICATORS ARE SIMPLY SET EVERY TIME A NEW NOTE IS
* PLAYED. THEY DECAY BY 1 LINE EVERY VBL UNTIL THE REACH THE BOTTOM
***********************************************

CHANINDS
	MOVE.W #%1111111111111110,D7
	MOVE.L LOGBASE,A5
	LEA	13504+3200(A5),A5
	LEA 	480(A5),A6
	MOVE.W CHAN1(PC),D6
	TST.W D6
	BEQ.S CLOOP1
	SUBQ.W #1,CHAN1
CLOOP1	MOVE.W D7,(A5)
	MOVE.W D7,(A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	DBF D6,CLOOP1
	CLR.W (A5)
	CLR.W (A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	CLR.W (A5)
	CLR.W (A6)

	MOVE.L LOGBASE,A5
	LEA	13512+3200(A5),A5
	LEA 	480(A5),A6
	MOVE.W CHAN2(PC),D6
	TST.W D6
	BEQ.S CLOOP2
	SUBQ.W #1,CHAN2
CLOOP2
	MOVE.W D7,(A5)
	MOVE.W D7,(A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	DBF D6,CLOOP2
	CLR.W (A5)
	CLR.W (A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	CLR.W (A5)
	CLR.W (A6)

	MOVE.L LOGBASE,A5
	LEA	13520+3200(A5),A5
	LEA 	480(A5),A6
	MOVE.W CHAN3(PC),D6
	TST.W D6
	BEQ.S CLOOP3
	SUBQ.W #1,CHAN3
CLOOP3
	MOVE.W D7,(A5)
	MOVE.W D7,(A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	DBF D6,CLOOP3
	CLR.W (A5)
	CLR.W (A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	CLR.W (A5)
	CLR.W (A6)

	MOVE.L LOGBASE,A5
	LEA	13528+3200(A5),A5
	LEA 	480(A5),A6
	MOVE.W CHAN4(PC),D6
	TST.W D6
	BEQ.S CLOOP4
	SUBQ.W #1,CHAN4
CLOOP4
	MOVE.W D7,(A5)
	MOVE.W D7,(A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	DBF D6,CLOOP4
	CLR.W (A5)
	CLR.W (A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	CLR.W (A5)
	CLR.W (A6)

	RTS

***************************************************
* WHEN THE TUNE IS CHANGED IT IS NECESSARY TO ERASE THE INDICATORS
* BEFOR STARTING THE NEXT TUNE 
****************************************************

ERASEIND
	MOVEQ #0,D7
	LEA	$78000,A5
	LEA	13504+3200(A5),A5
	LEA 	480(A5),A6
	MOVE.W #33,D6
ELOOP1	MOVE.W D7,(A5)
	MOVE.W D7,8(A5)
	MOVE.W D7,16(A5)
	MOVE.W D7,24(A5)
	MOVE.W D7,(A6)
	MOVE.W D7,8(A6)
	MOVE.W D7,16(A6)
	MOVE.W D7,24(A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	DBF D6,ELOOP1

	LEA	$70000,A5
	LEA	13504+3200(A5),A5
	LEA 	480(A5),A6
	MOVE.W #33,D6
ELOOP2	MOVE.W D7,(A5)
	MOVE.W D7,8(A5)
	MOVE.W D7,16(A5)
	MOVE.W D7,24(A5)
	MOVE.W D7,(A6)
	MOVE.W D7,8(A6)
	MOVE.W D7,16(A6)
	MOVE.W D7,24(A6)
	LEA 160(A6),A6
	LEA -160(A5),A5
	DBF D6,ELOOP2
	RTS

*******************************************
* NOW SOME TIMERB ROUTINES                *
*******************************************

HBL3	
	CLR.B 	$FFFFFA1B.W
	MOVE.B #8,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L #HBL2,$120.W
	MOVE.W #$700,$FFFF8242.W
	BCLR #0,$FFFFFA0F.W
	RTE

HBL	
	CLR.B 	$FFFFFA1B.W
	MOVE.B #33,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L #HBL1,$120.W
	MOVE.W #$700,$FFFF8242.W
	BCLR #0,$FFFFFA0F.W
	RTE
HBL2	
	CLR.B 	$FFFFFA1B.W
	MOVE.B #62,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L #HBL,$120.W
	MOVE.L A5,-(A7)
	MOVE.L COLPOINT(PC),A5
	CMP.L #COLTABEND,A5
	BNE.S JKL
	LEA COLTAB,A5
JKL	MOVE.W (A5)+,$FFFF8242.W
	MOVE.L A5,COLPOINT
	MOVE.L (A7)+,A5
	BCLR #0,$FFFFFA0F.W
	RTE
HBL1	
	CLR.B 	$FFFFFA1B.W
	MOVE.B #200,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L #HBL3,$120.W
	MOVE.W #$7,$FFFF8242.W
	BCLR #0,$FFFFFA0F.W
	RTE
	RTE
ALTEND
	CLR.B 	$FFFFFA1B.W
	MOVE.B #200,$FFFFFA21.W
	MOVE.B #8,$FFFFFA1B.W
	MOVE.L (A7)+,A5
	BCLR #0,$FFFFFA0F.W
	RTE

COLPOINT	DC.L COLTAB
COLTAB
	DS.W 100
	DC.W $111,$111,$111,$111
	DC.W $222,$222,$222,$222
	DC.W $333,$333,$333,$333
	DC.W $444,$444,$444,$444
	DC.W $555,$555,$555,$555
	DC.W $666,$666,$666,$666
	DC.W $777,$777,$777,$777
	DC.W $777,$777,$777,$777
	DC.W $777,$777,$777,$777
	DC.W $666,$666,$666,$666
	DC.W $555,$555,$555,$555
	DC.W $444,$444,$444,$444
	DC.W $333,$333,$333,$333
	DC.W $222,$222,$222,$222
	DC.W $111,$111,$111,$111
	DS.W 100
	DC.W $100,$100,$100,$100
	DC.W $200,$200,$200,$200
	DC.W $300,$300,$300,$300
	DC.W $400,$400,$400,$400
	DC.W $500,$500,$500,$500
	DC.W $600,$600,$600,$600
	DC.W $700,$700,$700,$700
	DC.W $700,$700,$700,$700
	DC.W $700,$700,$700,$700
	DC.W $600,$600,$600,$600
	DC.W $500,$500,$500,$500
	DC.W $400,$400,$400,$400
	DC.W $300,$300,$300,$300
	DC.W $200,$200,$200,$200
	DC.W $100,$100,$100,$100
COLTABEND

VBLIND	DC.W 0

OLDVBL	DC.L 0

OLDSP	DC.L 0
	DS.L 100
MYSTACK	DC.L 0	
START	BRA	L4B90E
STOP	BRA	L4B93C
SONGP	DC.L 	SONGBUFFER
VOICEP  DC.L 	VOICESET

KBUFF	DC.W 0

KEYVEC
	MOVE.L 	D7,-(SP)		KEY VECTOR
	MOVE.B 	$FFFFFC00.W,D7
	BTST	#7,D7
	BEQ.S	VECTOREND
	MOVE.B 	$FFFFFC02.W,D7
	MOVE.B 	D7,KBUFF
	BCLR 	#6,$FFFFFA11.W
VECTOREND	
	MOVE.L (A7)+,D7
	RTE

IKBD
	LEA 	$FFFFFC00.W,A0		SEND DAT TO KEYBOARD PROCESSOR
IKLOOP	MOVE.B 	(A0),D1
	BTST	#1,D1	
	BEQ.S IKLOOP
	MOVE.B D0,2(A0)
	RTS

********************************************************
* HERE STARTS THE DIGISYNTH ROUTINE. WORK THIS ONE OUT *
* FOR YOURELF!!!!    I'LL HELP WHERE I CAN             *
********************************************************

L47ECE	LEA	L4B040,A4
	BSR	L47EF8
	LEA	L4B044,A4
	BSR	L47EF8
	LEA	L4B048,A4
	BSR	L47EF8
	LEA	L4B04C,A4
	BSR	L47EF8
	RTS
L47EF8	MOVE.W	#$52,$40(A4)
	MOVE.W	#1,$70(A4)
	MOVEA.L	$A0(A4),A0
	MOVEQ	#0,D0
	BRA	L47F1C
L47F0E	CMPI.W	#$50,(A0)
	BNE	L47F18
	ADDQ.W	#1,D0
L47F18	BSR	L480A0
L47F1C	CMPI.W	#$46,(A0)
	BNE	L47F0E
	TST.W	D0
	BEQ	L47F32
	MOVE.L	$A0(A4),$80(A4)
	RTS
L47F32	MOVE.L	#L47F44,$A0(A4)
	MOVE.L	#L47F44,$80(A4)
	RTS
L47F44	DC.B	0,$52,$27,$10,0,0,0,0
	DC.B	0,0,0,0,0,$46,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0
L47F66	LEA	L47FFC,A1
	MOVEA.L	L4B0E0,A0
	BSR	L48004
	LEA	L47FFE,A1
	MOVEA.L	L4B0E4,A0
	BSR	L48004
	LEA	L48000,A1
	MOVEA.L	L4B0E8,A0
	BSR	L48004
	LEA	L48002,A1
	MOVEA.L	L4B0EC,A0
	BSR	L48004
	RTS
L47FA8	MOVEQ	#0,D0
	MOVE.W	L47FFC,D0
	BEQ	L47FBE
	MOVEA.L	L4B0E0,A1
	BSR	L48058
L47FBE	MOVE.W	L47FFE,D0
	BEQ	L47FD2
	MOVEA.L	L4B0E4,A1
	BSR	L48058
L47FD2	MOVE.W	L48000,D0
	BEQ	L47FE6
	MOVEA.L	L4B0E8,A1
	BSR	L48058
L47FE6	MOVE.W	L48002,D0
	BEQ	L47FFA
	MOVEA.L	L4B0EC,A1
	BSR	L48058
L47FFA	RTS
L47FFC	DC.W 0
L47FFE	DC.W 0
L48000	DC.W 0
L48002	DC.W 0
L48004	CLR.W	(A1)
	MOVEQ	#0,D0
	MOVEA.L	A0,A6
L4800A	CMPI.W	#$46,(A0)
	BEQ	L48056
	CMPI.W	#$6C,(A0)
	BNE	L4801C
	ADDQ.W	#1,D0
L4801C	CMPI.W	#$4C,(A0)
	BNE	L4804E
	SUBQ.W	#1,D0
	BPL	L4804E
	MOVEM.L	D0/A0-A1,-(A7)
	MOVEA.L	A6,A1
	MOVE.L	#$C,D0
	BSR	L4807A
	MOVE.W	#$6C,(A6)
	MOVEM.L	(A7)+,D0/A0-A1
	ADDA.L	#$C,A0
	ADDI.W	#$C,(A1)
	ADDQ.W	#1,D0
L4804E	BSR	L480A0
	BRA	L4800A
L48056	RTS
L48058	MOVEA.L	A1,A0
	BRA	L48062
L4805E	BSR	L480A0
L48062	CMPI.W	#$46,(A0)
	BNE	L4805E
	ADDQ.L	#2,A0
	MOVEA.L	A1,A2
	ADDA.L	D0,A1
L48070	MOVE.W	(A1)+,(A2)+
	CMPA.L	A0,A1
	BNE	L48070
	RTS
L4807A	MOVEA.L	A1,A0
	BRA	L48084
L48080	BSR	L480A0
L48084	CMPI.W	#$46,(A0)
	BNE	L48080
	ADDA.L	#2,A0
	MOVEA.L	A0,A2
	ADDA.L	D0,A2
L48096	MOVE.W	-(A0),-(A2)
	CMPA.L	A0,A1
	BNE	L48096
	RTS
L480A0	CMPI.W	#$46,(A0)
	BEQ	L480AE
	ADDA.L	#$C,A0
L480AE	RTS
************INITIALISATION ROUTINE******************
L480B0	LEA	L4B040,A0
	MOVE.L	#$FF000000,(A0)+
	MOVE.L	#$FF000000,(A0)+
	MOVE.L	#$FF000000,(A0)+
	MOVE.L	#$FF000000,(A0)+
	CLR.L	(A0)+
	CLR.L	(A0)+
	CLR.L	(A0)+
	CLR.L	(A0)+
	MOVE.L	#$1000000,L4B070
	MOVE.L	#$1000000,L4B0D0
	MOVE.L	#$1000000,L4B074
	MOVE.L	#$1000000,L4B0D4
	MOVE.L	#$1000000,L4B078
	MOVE.L	#$1000000,L4B0D8
	MOVE.L	#$1000000,L4B07C
	MOVE.L	#$1000000,L4B0DC
	MOVE.L	#L4B430,L4B0F0
	MOVE.L	#L4B5C4,L4B0F4
	MOVE.L	#L4B758,L4B0F8
	MOVE.L	#L4B8EC,L4B0FC
	MOVE.B	#7,$FFFF8800.W
	MOVE.B	#$C0,D0
	AND.B	$FFFF8800.W,D0
	ORI.B	#$38,D0
	MOVE.B	D0,$FFFF8802.W
	MOVE.B	#0,$FFFF8800.W
	CLR.B	$FFFF8802.W
	MOVE.B	#1,$FFFF8800.W
	CLR.B	$FFFF8802.W
	MOVE.B	#2,$FFFF8800.W
	CLR.B	$FFFF8802.W
	MOVE.B	#3,$FFFF8800.W
	CLR.B	$FFFF8802.W
	MOVE.B	#4,$FFFF8800.W
	CLR.B	$FFFF8802.W
	MOVE.B	#5,$FFFF8800.W
	CLR.B	$FFFF8802.W
	MOVE.W	#$2700,SR
	MOVE.L	$114.W,BL48260
	MOVE.L	#L4AC24,$114.W
	MOVE.L	$118.W,BL4825C
	MOVE.L	#KEYVEC,$118.W
	MOVE.L	L48264,$134.W
	MOVE.L	#VBL,$70.W
	BCLR	#3,$FFFFFA17.W
	BSR	L4AE6E
	BSR	L4AEFE
	MOVE.B	L4826C,$FFFFFA1F.W
	MOVE.B	#1,$FFFFFA19.W
	MOVE.L	#$FF000000,D0
	MOVE.L	#$FF000000,D1
	MOVE.L	#$FF000000,D2
	MOVE.L	#$FF000000,D3
	LEA	L4B040(PC),A0
	LEA	L4B040(PC),A1
	LEA	L4B040(PC),A2
	LEA	L4B040(PC),A3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEA.L	L48268,A4
	CLR.L	L4AF20
	MOVE.W	#$2300,SR
FLUSH	BTST.B #0,$FFFFFC00.W
	BEQ.S LETSGO
	MOVE.B $FFFFFC02.W,D7
	BRA.S FLUSH
LETSGO
	RTS
L4825C	DC.L	0
L48260	DC.L	0
BL4825C	DC.L	0
BL48260	DC.L	0
L48264	DC.L	L48B26
L48268	DC.L 	$FFFF8800
L4826C	DC.B	$2C,0
L4826E	MOVE.B	#7,$FFFF8800.W
	MOVE.B	#7,D0
	OR.B	$FFFF8800.W,D0
	MOVE.B	D0,$FFFF8802
	MOVE.W	#$2700,SR
	MOVE.B	#$E,$FFFF8800.W
	MOVE.B	#6,$FFFF8802.W
	MOVE.L	$134.W,L48264
	MOVE.L	A4,L48268
	MOVE.L	BL4825C,$118.W
	MOVE.L	BL48260,$114.W
	BSR	L4AEB6
	BSET	#3,$FFFFFA17.W
	MOVE.W	#$2300,SR
	RTS

*************THE TIMER A OUTPUT ROUTINE*****************
L48B26	SWAP	D0
	SWAP	D1
	SWAP	D2
	SWAP	D3
	MOVEQ	#0,D4
	MOVE.B	0(A0,D0.W),D5
	MOVE.B	0(A1,D1.W),D4
	ADD.W	D4,D5
	MOVE.B	0(A2,D2.W),D4
	ADD.W	D4,D5
	MOVE.B	0(A3,D3.W),D4
	ADD.W	D4,D5
	SWAP	D0
	SWAP	D1
	SWAP	D2
	SWAP	D3
	LSL.W	#3,D5
	MOVE.L	SOUNDTAB(PC,D5.W),D4
	MOVEP.L	D4,0(A4)
	MOVE.W	SOUNDTAB+4(PC,D5.W),D4
	MOVEP.W	D4,0(A4)
	MOVEQ	#0,D5
	ADD.L	L4B050(PC),D0
	ADDX.W	D5,D5
	ADD.L	L4B054(PC),D1
	ADDX.W	D5,D5
	ADD.L	L4B058(PC),D2
	ADDX.W	D5,D5
	ADD.L	L4B05C(PC),D3
	ADDX.W	D5,D5
	TST.W	D5
	BNE	L4AB82
	RTE
SOUNDTAB
	INCBIN	"DATA2"

*********************ROUTINE TO CHECK WHETHER NOTE SHOULD BE ENDED
*********************OR SUSTAINED

L4AB82	BCLR	#3,D5
	BEQ	L4ABAA
	TST.W	L4B072
	BEQ	L4ABA4
	LEA	L4B040(PC),A0
	MOVE.L	#$1000000,L4B070
L4ABA4	SUB.L	L4B070,D0
L4ABAA	BCLR	#2,D5
	BEQ	L4ABD2
	TST.W	L4B076
	BEQ	L4ABCC
	LEA	L4B040(PC),A1
	MOVE.L	#$1000000,L4B074
L4ABCC	SUB.L	L4B074,D1
L4ABD2	BCLR	#1,D5
	BEQ	L4ABFA
	TST.W	L4B07A
	BEQ	L4ABF4
	LEA	L4B040(PC),A2
	MOVE.L	#$1000000,L4B078
L4ABF4	SUB.L	L4B078(PC),D2
L4ABFA	BCLR	#0,D5
	BEQ	L4AC22
	TST.W	L4B07E
	BEQ	L4AC1C
	LEA	L4B040(PC),A3
	MOVE.L	#$1000000,L4B07C
L4AC1C	SUB.L	L4B07C,D3
L4AC22	RTE
L4AC24
******************THE TIMER C MANAGEMENT ROUTINE

L4AC66	MOVE.W	#$2500,SR
	MOVEM.L	D6-D7/A5-A6,-(A7)
	LEA	L4B040(PC),A5
	BSR	L4ACC4
	LEA	L4B044(PC),A5
	BSR	L4ACC4
	LEA	L4B048(PC),A5
	BSR	L4ACC4
	LEA	L4B04C(PC),A5
	BSR	L4ACC4
	LEA	L4B040(PC),A5
	CLR.W 	FULLVOL
	BSR	L4AD0E
	CMP.W 	#0,FULLVOL
	BEQ.S 	N2
	MOVE.W 	#30,CHAN1
N2	LEA	L4B044(PC),A5
	CLR.W 	FULLVOL
	BSR	L4AD0E
	CMP.W 	#0,FULLVOL
	BEQ.S 	N3
	MOVE.W 	#30,CHAN2
N3	LEA	L4B048(PC),A5
	CLR.W 	FULLVOL
	BSR	L4AD0E
	CMP.W 	#0,FULLVOL
	BEQ.S 	N4
	MOVE.W 	#30,CHAN3
N4	LEA	L4B04C(PC),A5
	CLR.W 	FULLVOL
	BSR.S	L4AD0E
	CMP.W 	#0,FULLVOL
	BEQ.S 	N5
	MOVE.W 	#30,CHAN4
N5	MOVEM.L	(A7)+,D6-D7/A5-A6
	RTE

CHAN1	DC.W 0
CHAN2	DC.W 0
CHAN3	DC.W 0
CHAN4	DC.W 0

L4ACC4	CMPI.W	#$53,$40(A5)
	BNE	L4AD0C
	MOVE.L	$50(A5),D6
	ADD.L	$10(A5),D6
	MOVE.L	D6,$10(A5)
	TST.L	$50(A5)
	BMI	L4ACF8
	CMP.L	$60(A5),D6
	BLT	L4AD0C
	MOVE.W	#$50,$40(A5)
	MOVE.L	$60(A5),$10(A5)
	RTS
L4ACF8	CMP.L	$60(A5),D6
	BGT	L4AD0C
	MOVE.W	#$50,$40(A5)
	MOVE.L	$60(A5),$10(A5)
L4AD0C	RTS
L4AD0E	SUBQ.W	#1,$70(A5)
	BNE	L4AD62
	MOVE.W #1,FULLVOL
L4AD16	MOVEA.L	$80(A5),A6
	ADDI.L	#$C,$80(A5)
	MOVE.W	(A6),D6
	MOVE.W	D6,$40(A5)

	CMP.W	#$50,D6
	BEQ	L4AD64
	CMP.W	#$52,D6		BLANK SOUND?
	BEQ	L4AD86
	CMP.W	#$46,D6		RESTART TRACK
	BEQ	L4ADA4
	CMP.W	#$56,D6		LOOP
	BEQ	L4ADAE
	CMP.W	#$6C,D6
	BEQ	L4ADD2
	CMP.W	#$4C,D6
	BEQ	L4ADE4
	CMP.W	#$53,D6		NEW SAMPLE
	BEQ	L4AE16
L4AD60	RTS
L4AD62	RTS
L4AD64	MOVE.L	0(A5),D6
	MOVE.L	$20(A5),D7
	BSR	L4AE2C
	MOVE.L	$90(A5),$30(A5)
	MOVE.L	4(A6),$10(A5)
	MOVE.W	2(A6),$70(A5)
	BRA.S	L4AD60

L4AD86
	CLR.W FULLVOL
	MOVE.L	#$FF000000,D6		BLANK SOUND
	MOVE.L	#L4B040,D7
	BSR	L4AE2C
	CLR.L	$10(A5)
	MOVE.W	2(A6),$70(A5)
	BRA.S	L4AD60

L4ADA4	MOVE.L	$A0(A5),$80(A5)		RESTART TRACK ROUTINE
	BRA	L4AD16

L4ADAE	MOVEA.L	8(A6),A6		LOOP ROUTINE
	MOVE.L	-4(A6),0(A5)
	NEG.L	0(A5)
	MOVE.L	-8(A6),$90(A5)
	MOVEQ	#0,D7
	MOVE.W	-4(A6),D7
	ADDA.L	D7,A6
	MOVE.L	A6,$20(A5)
	BRA	L4AD16

L4ADD2	MOVEA.L	$B0(A5),A6
	MOVE.L	$80(A5),-(A6)
	CLR.W	-(A6)
	MOVE.L	A6,$B0(A5)
	BRA	L4AD16

L4ADE4	MOVE.W	8(A6),D7
	MOVEA.L	$B0(A5),A6
	MOVE.W	(A6)+,D6
	TST.W	D6
	BNE	L4ADF8
	MOVE.W	D7,D6
	ADDQ.W	#1,D6
L4ADF8	SUBQ.W	#1,D6
	BEQ	L4AE0C
	MOVE.L	(A6),$80(A5)
	MOVE.W	D6,-(A6)
	MOVE.L	A6,$B0(A5)
	BRA	L4AD16

L4AE0C	ADDQ.L	#4,A6
	MOVE.L	A6,$B0(A5)
	BRA	L4AD16

L4AE16	MOVE.L	4(A6),$60(A5)
	MOVE.W	2(A6),$70(A5)
	MOVE.L	8(A6),$50(A5)
	MOVE.W 	#1,FULLVOL
	BRA	L4AD60

L4AE2C	CMPA.L	#L4B040,A5
	BEQ	L4AE56
	CMPA.L	#L4B044,A5
	BEQ	L4AE5C
	CMPA.L	#L4B048,A5
	BEQ	L4AE62
	CMPA.L	#L4B04C,A5
	BEQ	L4AE68
	RTS
L4AE56	MOVE.L	D6,D0
	MOVEA.L	D7,A0
	RTS
L4AE5C	MOVE.L	D6,D1
	MOVEA.L	D7,A1
	RTS
L4AE62	MOVE.L	D6,D2
	MOVEA.L	D7,A2
	RTS
L4AE68	MOVE.L	D6,D3
	MOVEA.L	D7,A3
	RTS
L4AE6E
	MOVE.B	$FFFA07,BL4AF28
	MOVE.B	$FFFA09,BL4AF29
	MOVE.B	$FFFA13,BL4AF2A
	MOVE.B	$FFFA15,BL4AF2B
	MOVE.B	$FFFA1F,BL4AF2C
	MOVE.B	$FFFA19,BL4AF2D
	MOVE.B	$FFFA17,BL4AF2E
	MOVE.B  $FFFFFA1B.W,BOLD1B
	MOVE.B  $FFFFFA21.W,BOLD21
	MOVE.B  $FFFFFA0F.W,BOLD0F
	RTS

SAVEOLDMFP
	MOVE.W #$2700,SR
	MOVE.L	$114.W,L48260
	MOVE.L 	$70.W,OLDVBL
	MOVE.L	$118.W,L4825C
	MOVE.B	$FFFA07,L4AF28
	MOVE.B	$FFFA09,L4AF29
	MOVE.B	$FFFA13,L4AF2A
	MOVE.B	$FFFA15,L4AF2B
	MOVE.B	$FFFA1F,L4AF2C
	MOVE.B	$FFFA19,L4AF2D
	MOVE.B	$FFFA17,L4AF2E
	MOVE.B  $FFFFFA1B.W,OLD1B
	MOVE.B  $FFFFFA21.W,OLD21
	MOVE.B  $FFFFFA0F.W,OLD0F
	MOVE.W #$2300,SR
	RTS
GETOLDMFP
	MOVE.W #$2700,SR
	MOVE.L	L4825C,$118.W
	MOVE.L	L48260,$114.W
	MOVE.L 	OLDVBL,$70.W
	MOVE.B	L4AF2E,$FFFA17
	MOVE.B	L4AF2D,$FFFA19
	MOVE.B	L4AF2C,$FFFA1F
	MOVE.B	L4AF2B,$FFFA15
	MOVE.B	L4AF2A,$FFFA13
	MOVE.B	L4AF29,$FFFA09
	MOVE.B	L4AF28,$FFFA07
	MOVE.B  OLD1B,$FFFFFA1B.W
	MOVE.B  OLD21,$FFFFFA21.W
	MOVE.B  OLD0F,$FFFFFA0F.W
	MOVE.W #$2300,SR
	RTS
L4AEB6
	MOVE.B	BL4AF2E,$FFFA17
	MOVE.B	BL4AF2D,$FFFA19
	MOVE.B	BL4AF2C,$FFFA1F
	MOVE.B	BL4AF2B,$FFFA15
	MOVE.B	BL4AF2A,$FFFA13
	MOVE.B	BL4AF29,$FFFA09
	MOVE.B	BL4AF28,$FFFA07
	MOVE.B  BOLD1B,$FFFFFA1B.W
	MOVE.B  BOLD21,$FFFFFA21.W
	MOVE.B  BOLD0F,$FFFFFA0F.W
	RTS

L4AEFE	MOVE.B	#$21,$FFFA13
	MOVE.B	#$60,$FFFA15
	MOVE.B	#$21,$FFFA07
	MOVE.B	#$60,$FFFA09
	RTS
FULLVOL	DC.W 	0
OLD1B	DC.W	0
OLD21	DC.W 	0
OLD0F	DC.W 	0
BOLD1B	DC.W	0
BOLD21	DC.W 	0
BOLD0F	DC.W 	0
L4AF20	DC.B	0,0,0,0,0,0,0,0
L4AF28	DC.B	0
L4AF29	DC.B	0
L4AF2A	DC.B	0
L4AF2B	DC.B 	0
L4AF2C	DC.B 	0
L4AF2D	DC.B	0
L4AF2E	DC.B	0,0
BL4AF28	DC.B	0
BL4AF29	DC.B	0
BL4AF2A	DC.B	0
BL4AF2B	DC.B 	0
BL4AF2C	DC.B 	0
BL4AF2D	DC.B	0
BL4AF2E	DC.B	0,0

	DC.B	0,0,0,0,0,0,0,0
	DC.B	1,0,0,0,1,0,0,0
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
	DC.B	$80,$80,$80,$80,$80,$80,$80,$80
L4B040	DC.L	0
L4B044	DC.L    0
L4B048	DC.L	0
L4B04C  DC.L    0
L4B050	DC.L	0
L4B054	DC.L	0
L4B058	DC.L	0
L4B05C	DC.L    0
L4B060	DC.L 	L4B040
L4B064	DC.L 	L4B040
L4B068	DC.L 	L4B040
L4B06C	DC.L 	L4B040
L4B070	DC.B	0,0
L4B072	DC.B	0,0
L4B074	DC.B	0,0
L4B076	DC.B	0,0
L4B078	DC.B	0,0
L4B07A	DC.B	0,0
L4B07C	DC.B	0,0
L4B07E	DC.B	0,0
	DC.B	0,0,0,$52,0,0,0,$52
	DC.B	0,0,0,$52,0,0,0,$52
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,1,0,0,0,1
	DC.B	0,0,0,1,0,0,0,1
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
L4B0D0	DC.B	0,0,0,0
L4B0D4	DC.B 	0,0,0,0
L4B0D8	DC.B	0,0,0,0
L4B0DC	DC.B 	0,0,0,0
L4B0E0	DC.B	0,0,0,0
L4B0E4	DC.B 	0,0,0,0
L4B0E8	DC.B	0,0,0,0
L4B0EC	DC.B 	0,0,0,0
L4B0F0	DC.L	L4B430
L4B0F4	DC.L 	L4B5C4
L4B0F8	DC.L	L4B758
L4B0FC	DC.L 	L4B8EC
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
L4B430	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0
L4B5C4	DC.B	0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
L4B758	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0
L4B8EC	DC.B	0,0,0,0

L4B90E	BSR	L4B9D6
	MOVEM.L	L4BAC0,D0-D3
	MOVEM.L	D0-D3,L4B0E0
	BSR	L47ECE
	BSR	L47F66
	CLR.B	KBUFF
	BSR	L480B0
	LEA	KBUFF,A6
	RTS
L4B93C
	CLR.W 	CHAN1
	CLR.W 	CHAN2
	CLR.W 	CHAN3
	CLR.W 	CHAN4
	BSR	ERASEIND
	BSR	L4826E
	BSR	L47FA8
	BSR	L4BA7A
	RTS
L4B94A	CMPI.W	#$46,(A0)
	BEQ	L4B988
	CMPI.W	#$56,(A0)
	BNE	L4B978
	MOVE.L	8(A0),D0
	CLR.L	D1
	LEA	L4BAD0,A1
L4B966	CMP.L	0(A1,D1.L),D0
	BEQ	L4B974
	ADDQ.L	#4,D1
	BRA	L4B966
L4B974	MOVE.L	D1,8(A0)
L4B978	CMPI.W	#$46,(A0)
	BEQ	L4B984
	ADDA.W	#$C,A0
L4B984	BRA	L4B94A
L4B988	RTS
L4B98A	CMPI.W	#$46,(A0)
	BEQ	L4B9D4
	CMPI.W	#$56,(A0)
	BNE	L4B9C4
	MOVE.L	8(A0),D0
	LEA	L4BAD0,A1
	MOVE.L	0(A1,D0.L),8(A0)
	MOVE.L	VOICEP,D0
	ADDI.L	#8,D0
	CMP.L	8(A0),D0
	BNE	L4B9C4
	MOVE.L	0(A1),8(A0)
L4B9C4	CMPI.W	#$46,(A0)
	BEQ	L4B9D0
	ADDA.W	#$C,A0
L4B9D0	BRA	L4B98A
L4B9D4	RTS
L4B9D6	MOVEA.L	VOICEP,A5
	ADDA.W	#$8E,A5
	LEA	L4BAD0,A4
	MOVEQ	#$13,D0
L4B9E8	MOVE.L	(A5)+,D1
	ADD.L	VOICEP,D1
	ADDI.L	#8,D1
	MOVE.L	D1,(A4)+
	DBF	D0,L4B9E8
	MOVEA.L	SONGP,A0
	MOVE.W	(A0),D0
	BSR	L4BAA4
	ADDA.W	#$10,A0
	MOVE.L	A0,L4BAC0
	BSR	L4BA5A
	MOVE.L	A0,L4BAC4
	BSR	L4BA5A
	MOVE.L	A0,L4BAC8
	BSR	L4BA5A
	MOVE.L	A0,L4BACC
	MOVEA.L	L4BAC0,A0
	BSR	L4B98A
	MOVEA.L	L4BAC4,A0
	BSR	L4B98A
	MOVEA.L	L4BAC8,A0
	BSR	L4B98A
	MOVEA.L	L4BACC,A0
	BSR	L4B98A
	RTS
L4BA5A	CMPI.W	#$46,(A0)
	BEQ	L4BA72
	CMPI.W	#$46,(A0)
	BEQ	L4BA6E
	ADDA.W	#$C,A0
L4BA6E	BRA	L4BA5A
L4BA72	ADDA.L	#$C,A0
	RTS
L4BA7A	MOVEA.L	L4BAC0,A0
	BSR	L4B94A
	MOVEA.L	L4BAC4,A0
	BSR	L4B94A
	MOVEA.L	L4BAC8,A0
	BSR	L4B94A
	MOVEA.L	L4BACC,A0
	BSR	L4B94A
	RTS
L4BAA4	MOVE.B	POINT-2(PC,D0.W),L4826C
POINT	RTS
	DC.B	$98,$7A,$66,$58,$4C,$44,$3D,$38
	DC.B	$33,$2F,$2C,$29,$26,$24,$22,$20
	DC.B	$1E,0,0,0,0,0,0,0
L4BAC0	DC.L	0
L4BAC4	DC.L	0
L4BAC8	DC.L	0
L4BACC	DC.L	0
L4BAD0	DS.L 	20

VOICESET
	INCBIN "VOICES\VOICE.SET"
SONG1	INCBIN "SONGS\COOL.4V
SONG2	INCBIN "SONGS\PANINARO.4V
SONG3	INCBIN "SONGS\QUOVADIS.4V
SONG4	INCBIN "SONGS\START.4V
SONG5	INCBIN "SONGS\THEEND2.4V
SONG6	INCBIN "SONGS\THENIGHT.4V

***************CLEAR SCREEN ROUTINE***********************
CLEARSCREEN
	LEA $70000,A0
	MOVE.W #16383,D0
CL_LOOP
	CLR.L (A0)+
	DBF D0,CL_LOOP
	RTS

****ERASE OLD STARS
ERASESUB

	MOVE.L OLDSTARPOINT(PC),A5
	MOVE.L LOGBASE(PC),A6
	MOVEQ #0,D6
	REPT 200
	MOVE.W (A5)+,D7			GET POSITION
	MOVE.W D6,(A6,D7.W)		WIPE EM OUT
	ENDR
	RTS

STARSSUB
	LEA STARS(PC),A5
	MOVE.L OLDSTARPOINT(PC),OLDSTORE
	MOVE.W #199,D7
DRAWLOOP
	MOVE.W	D7,-(A7)
DRAWLOOPB
	MOVE.L (A5)+,A6			GET TABLE POINTER
	MOVE.W (A6)+,D6			GET DATA
	CMP.W #$FFFF,D6			END OF STAR TRACK
	BNE.S CONT
	MOVE.L (A5),-(A5)		PUT START BACK IN
	BRA.S DRAWLOOPB
CONT
	MOVE.W (A6)+,D7			GET SCREEN POS
	MOVE.L A6,-(A5)
	LEA 8(A5),A5
	MOVE.L LOGBASE(PC),A6
	OR.W D6,(A6,D7.W)		SET THE PIXEL
	MOVE.L OLDSTORE(PC),A6		STORE THE POSITION FOR LATER ERASING
	MOVE.W D7,(A6)+
	MOVE.L A6,OLDSTORE
	MOVE.W (A7)+,D7
	DBF D7,DRAWLOOP
	RTS

OLDSTORE
	DC.L	OLDSTARS

****************** THIS ROUTINE MAKES UP THE STARS TRACKS FROM THE INCLUDE DATA FILE

MAKEUPSTARS
	LEA STARS(PC),A0
	MOVEQ #0,D0
	MOVE.W #85,D1
CVLOOP
	MOVE.L (A0),A1
	ADD.L D0,A1
	MOVE.L A1,(A0)
	LEA 8(A0),A0
	MOVE.L (A0),A1
	ADD.L D0,A1
	MOVE.L A1,(A0)
	LEA 8(A0),A0
	ADD.L #4,D0
	DBF D1,CVLOOP

	MOVEQ #0,D0
	MOVE.W #27,D1
CVLOOP1
	MOVE.L (A0),A1
	ADD.L D0,A1
	MOVE.L A1,(A0)
	LEA 8(A0),A0
	ADD.L #12,D0
	DBF D1,CVLOOP1
	RTS

*************************************
* VARIABLES ETC FOR THE STARS
*************************************

LOGBASE		DC.L 0
OLDSTARPOINT	DC.L 0

OLDSTARS	
	DS.W 200

OLDSTARS1
	DS.W 200

STARS	
ADDIT	SET 0
	REPT 200
	DC.L DEFSTARS+ADDIT,DEFSTARS+ADDIT
ADDIT	SET ADDIT+360
	ENDR

FONT2		EQU $68000
FONT1		EQU $5C000

************************************************************
* THIS SCROLL ROUTINE USES THE BUFFERED SCROLL METHOD BUT  *
* OF COURSE HAS ONLY TWO REGISTERS TO WORK WITH            *
************************************************************
 
SCROLL1
	SUBQ.W #1,COUNT			
	BEQ NEWLET			GET NEW LETTER
	NOT.W IND			
	CMP.W #1,IND			ROUTINE 1 OR 2
	BNE SCROLL2

	LEA $76908,A5			MOVE BY ONE WORD (16 PIXELS)
	LEA $76900,A6

	BSR STANDARD

	MOVE.L CHARPOS1,A5
	LEA $76998,A6
	MOVE.L (A5)+,(A6)
	MOVE.L (A5)+,4(A6)
	MOVE.L (A5)+,160(A6)
	MOVE.L (A5)+,164(A6)
	MOVE.L (A5)+,320(A6)
	MOVE.L (A5)+,324(A6)
	MOVE.L (A5)+,480(A6)
	MOVE.L (A5)+,484(A6)
	MOVE.L (A5)+,640(A6)
	MOVE.L (A5)+,644(A6)
	MOVE.L (A5)+,800(A6)
	MOVE.L (A5)+,804(A6)
	MOVE.L (A5)+,960(A6)
	MOVE.L (A5)+,964(A6)
	MOVE.L (A5)+,1120(A6)
	MOVE.L (A5)+,1124(A6)
	MOVE.L (A5)+,1280(A6)
	MOVE.L (A5)+,1284(A6)
	MOVE.L (A5)+,1440(A6)
	MOVE.L (A5)+,1444(A6)
	MOVE.L (A5)+,1600(A6)
	MOVE.L (A5)+,1604(A6)
	MOVE.L (A5)+,1760(A6)
	MOVE.L (A5)+,1764(A6)
	MOVE.L (A5)+,1920(A6)
	MOVE.L (A5)+,1924(A6)
	MOVE.L (A5)+,2080(A6)
	MOVE.L (A5)+,2084(A6)
	MOVE.L (A5)+,2240(A6)
	MOVE.L (A5)+,2244(A6)
	MOVE.L (A5)+,2400(A6)
	MOVE.L (A5)+,2404(A6)
	MOVE.L (A5)+,2560(A6)
	MOVE.L (A5)+,2564(A6)
	MOVE.L (A5)+,2720(A6)
	MOVE.L (A5)+,2724(A6)
	MOVE.L (A5)+,2880(A6)
	MOVE.L (A5)+,2884(A6)
	MOVE.L (A5)+,3040(A6)
	MOVE.L (A5)+,3044(A6)
	MOVE.L (A5)+,3200(A6)
	MOVE.L (A5)+,3204(A6)
	MOVE.L (A5)+,3360(A6)
	MOVE.L (A5)+,3364(A6)
	MOVE.L (A5)+,3520(A6)
	MOVE.L (A5)+,3524(A6)
	MOVE.L (A5)+,3680(A6)
	MOVE.L (A5)+,3684(A6)
	MOVE.L (A5)+,3840(A6)
	MOVE.L (A5)+,3844(A6)
	MOVE.L (A5)+,4000(A6)
	MOVE.L (A5)+,4004(A6)
	MOVE.L (A5)+,4160(A6)
	MOVE.L (A5)+,4164(A6)
	MOVE.L (A5)+,4320(A6)
	MOVE.L (A5)+,4324(A6)
	MOVE.L (A5)+,4480(A6)
	MOVE.L (A5)+,4484(A6)
	MOVE.L (A5)+,4640(A6)
	MOVE.L (A5)+,4644(A6)
	MOVE.L (A5)+,4800(A6)
	MOVE.L (A5)+,4804(A6)
	MOVE.L (A5)+,4960(A6)
	MOVE.L (A5)+,4964(A6)
	MOVE.L A5,CHARPOS1
	RTS

STANDARD
	REPT 1280
	MOVE.L (A5)+,(A6)+
	ENDR
	RTS

SCROLL2
	LEA $78000+$6908,A5
	LEA $78000+$6900,A6

	BSR STANDARD

	MOVE.L CHARPOS2,A5
	LEA $78000+$6998,A6
	MOVE.L (A5)+,(A6)
	MOVE.L (A5)+,4(A6)
	MOVE.L (A5)+,160(A6)
	MOVE.L (A5)+,164(A6)
	MOVE.L (A5)+,320(A6)
	MOVE.L (A5)+,324(A6)
	MOVE.L (A5)+,480(A6)
	MOVE.L (A5)+,484(A6)
	MOVE.L (A5)+,640(A6)
	MOVE.L (A5)+,644(A6)
	MOVE.L (A5)+,800(A6)
	MOVE.L (A5)+,804(A6)
	MOVE.L (A5)+,960(A6)
	MOVE.L (A5)+,964(A6)
	MOVE.L (A5)+,1120(A6)
	MOVE.L (A5)+,1124(A6)
	MOVE.L (A5)+,1280(A6)
	MOVE.L (A5)+,1284(A6)
	MOVE.L (A5)+,1440(A6)
	MOVE.L (A5)+,1444(A6)
	MOVE.L (A5)+,1600(A6)
	MOVE.L (A5)+,1604(A6)
	MOVE.L (A5)+,1760(A6)
	MOVE.L (A5)+,1764(A6)
	MOVE.L (A5)+,1920(A6)
	MOVE.L (A5)+,1924(A6)
	MOVE.L (A5)+,2080(A6)
	MOVE.L (A5)+,2084(A6)
	MOVE.L (A5)+,2240(A6)
	MOVE.L (A5)+,2244(A6)
	MOVE.L (A5)+,2400(A6)
	MOVE.L (A5)+,2404(A6)
	MOVE.L (A5)+,2560(A6)
	MOVE.L (A5)+,2564(A6)
	MOVE.L (A5)+,2720(A6)
	MOVE.L (A5)+,2724(A6)
	MOVE.L (A5)+,2880(A6)
	MOVE.L (A5)+,2884(A6)
	MOVE.L (A5)+,3040(A6)
	MOVE.L (A5)+,3044(A6)
	MOVE.L (A5)+,3200(A6)
	MOVE.L (A5)+,3204(A6)
	MOVE.L (A5)+,3360(A6)
	MOVE.L (A5)+,3364(A6)
	MOVE.L (A5)+,3520(A6)
	MOVE.L (A5)+,3524(A6)
	MOVE.L (A5)+,3680(A6)
	MOVE.L (A5)+,3684(A6)
	MOVE.L (A5)+,3840(A6)
	MOVE.L (A5)+,3844(A6)
	MOVE.L (A5)+,4000(A6)
	MOVE.L (A5)+,4004(A6)
	MOVE.L (A5)+,4160(A6)
	MOVE.L (A5)+,4164(A6)
	MOVE.L (A5)+,4320(A6)
	MOVE.L (A5)+,4324(A6)
	MOVE.L (A5)+,4480(A6)
	MOVE.L (A5)+,4484(A6)
	MOVE.L (A5)+,4640(A6)
	MOVE.L (A5)+,4644(A6)
	MOVE.L (A5)+,4800(A6)
	MOVE.L (A5)+,4804(A6)
	MOVE.L (A5)+,4960(A6)
	MOVE.L (A5)+,4964(A6)
	MOVE.L A5,CHARPOS2
	RTS

NEWLET
	LEA $78000+$6908,A5
	LEA $78000+$6900,A6

	BSR STANDARD

	MOVE.L CHARPOS2,A5
	LEA $78000+$6998,A6
	MOVE.L (A5)+,(A6)
	MOVE.L (A5)+,4(A6)
	MOVE.L (A5)+,160(A6)
	MOVE.L (A5)+,164(A6)
	MOVE.L (A5)+,320(A6)
	MOVE.L (A5)+,324(A6)
	MOVE.L (A5)+,480(A6)
	MOVE.L (A5)+,484(A6)
	MOVE.L (A5)+,640(A6)
	MOVE.L (A5)+,644(A6)
	MOVE.L (A5)+,800(A6)
	MOVE.L (A5)+,804(A6)
	MOVE.L (A5)+,960(A6)
	MOVE.L (A5)+,964(A6)
	MOVE.L (A5)+,1120(A6)
	MOVE.L (A5)+,1124(A6)
	MOVE.L (A5)+,1280(A6)
	MOVE.L (A5)+,1284(A6)
	MOVE.L (A5)+,1440(A6)
	MOVE.L (A5)+,1444(A6)
	MOVE.L (A5)+,1600(A6)
	MOVE.L (A5)+,1604(A6)
	MOVE.L (A5)+,1760(A6)
	MOVE.L (A5)+,1764(A6)
	MOVE.L (A5)+,1920(A6)
	MOVE.L (A5)+,1924(A6)
	MOVE.L (A5)+,2080(A6)
	MOVE.L (A5)+,2084(A6)
	MOVE.L (A5)+,2240(A6)
	MOVE.L (A5)+,2244(A6)
	MOVE.L (A5)+,2400(A6)
	MOVE.L (A5)+,2404(A6)
	MOVE.L (A5)+,2560(A6)
	MOVE.L (A5)+,2564(A6)
	MOVE.L (A5)+,2720(A6)
	MOVE.L (A5)+,2724(A6)
	MOVE.L (A5)+,2880(A6)
	MOVE.L (A5)+,2884(A6)
	MOVE.L (A5)+,3040(A6)
	MOVE.L (A5)+,3044(A6)
	MOVE.L (A5)+,3200(A6)
	MOVE.L (A5)+,3204(A6)
	MOVE.L (A5)+,3360(A6)
	MOVE.L (A5)+,3364(A6)
	MOVE.L (A5)+,3520(A6)
	MOVE.L (A5)+,3524(A6)
	MOVE.L (A5)+,3680(A6)
	MOVE.L (A5)+,3684(A6)
	MOVE.L (A5)+,3840(A6)
	MOVE.L (A5)+,3844(A6)
	MOVE.L (A5)+,4000(A6)
	MOVE.L (A5)+,4004(A6)
	MOVE.L (A5)+,4160(A6)
	MOVE.L (A5)+,4164(A6)
	MOVE.L (A5)+,4320(A6)
	MOVE.L (A5)+,4324(A6)
	MOVE.L (A5)+,4480(A6)
	MOVE.L (A5)+,4484(A6)
	MOVE.L (A5)+,4640(A6)
	MOVE.L (A5)+,4644(A6)
	MOVE.L (A5)+,4800(A6)
	MOVE.L (A5)+,4804(A6)
	MOVE.L (A5)+,4960(A6)
	MOVE.L (A5)+,4964(A6)

	MOVEQ #0,D7
	MOVEQ #0,D6

	MOVE.L SCROLLPOINT,A5
NEWLETTER
	MOVE.B (A5)+,D7
	MOVE.L A5,SCROLLPOINT
	CMPI.W #$FF,D7
	BEQ WRAP
	SUB.W #$20,D7
	MOVE.B D7,D6
	MULU #512,D6
	MULU #768,D7
	LEA FONT2,A5
	LEA FONT1,A6
	ADD.L D6,A5
	ADD.L D7,A6
	MOVE.L A5,CHARPOS1

	LEA $78000+$6998,A5

ADDIT	SET 0
	REPT 32
	MOVE.L (A6)+,D6
	MOVE.L (A6)+,D7
	OR.L D6,ADDIT(A5)	
	OR.L D7,ADDIT+4(A5)
ADDIT	SET ADDIT+160
	ENDR

	MOVE.L A6,CHARPOS2

	MOVE.W #4,COUNT
	NOT.W IND

	RTS

WRAP	LEA SCROLLINE,A5
	BRA NEWLETTER	

IND		DC.W 1

SHIFTER
	LEA FONT,A0
	LEA FONT1,A1
	LEA FONT1,A2

	MOVE.W #59,D0
LOOPJ
	MOVE.W #31,D1
LOOP3
	MOVE.L A2,A1
	MOVE.B (A0),1(A1)
	MOVE.B 2(A0),3(A1)
	MOVE.B 4(A0),5(A1)
	MOVE.B 6(A0),7(A1)

	MOVE.B 1(A0),256(A1)
	MOVE.B 3(A0),258(A1)
	MOVE.B 5(A0),260(A1)
	MOVE.B 7(A0),262(A1)
	LEA 8(A0),A0
	LEA 256(A1),A1
	MOVE.B (A0),1(A1)
	MOVE.B 2(A0),3(A1)
	MOVE.B 4(A0),5(A1)
	MOVE.B 6(A0),7(A1)
	MOVE.B 1(A0),256(A1)
	MOVE.B 3(A0),258(A1)
	MOVE.B 5(A0),260(A1)
	MOVE.B 7(A0),262(A1)
	LEA 8(A0),A0
	LEA 8(A2),A2
	DBF D1,LOOP3
	LEA 512(A2),A2
	DBF D0,LOOPJ

	LEA FONT,A0
	LEA FONT2,A1
	MOVE.W #59,D0
LOOP2	
	MOVE.W #31,D1
LOOP5
	MOVE.L (A0)+,(A1)
	MOVE.L (A0)+,4(A1)
	MOVE.L (A0)+,256(A1)
	MOVE.L (A0)+,260(A1)
	LEA 8(A1),A1
	DBF D1,LOOP5
	LEA 256(A1),A1
	DBF D0,LOOP2
	RTS

***********************************
* THE SCROLLINE
**********************************

SCROLLINE
	DC.B "        WELCOME TO THE FINAL TRIUMPH OF THE LOST BOYS MINDBOMB DEMO!  THIS IS THE SCREEN THAT VERY NEARLY DIDN'T MAKE IT ON TO THE DEMO. IT WAS ONLY FINISHED ON 1ST APRIL (NO KIDDING!!) 1990 JUST BEFORE MANIKIN WENT ON HOLIDAY! "
	DC.B "  THE DIGISYNTH ROUTINE IS IN OUR OPINION THE BEST ONE EVER ON THE ST. THE SAMPLES ARE CRYSTAL CLEAR AND WE HAVE FOUR CHANNELS OF DIGI-SOUND ALL INDIVIDUALLY PITCHED. THE SYNTH ROUTINE WORKS AT 8KHZ!!! AND TAKES A LITTLE LESS THAN "
	DC.B " 50 PERCENT PROCESSOR TIME. IT IS BASED UPON A SYNTH ROUTINE WRITTEN BY ROB POVEY AND ALL THE MUSIC IS WRITTEN BY SPAZ ON ROB'S EXCELLENT 4-TRACK PACKAGE CALLED QUARTET SOLD BY MICRODEAL. WE FULLY INTEND TO USE THIS SYNTH ROUTINE A LOT"
	DC.B " MORE IN THE FUTURE AND INDEED WE WOULD HAVE USED IT A LOT MORE IN THIS DEMO EXCEPT FOR THE FACT THAT I ONLY WORKED OUT THE SUPER FAST ROUTINES AT THE END OF MARCH AND BY THIS TIME THE MINDBOMB DEMO WAS ABOUT 90 PERCENT FINISHED "
	DC.B " ALREADY AND THERE REALLY WASN'T ALL THAT MUCH SPACE ON THE DISK!   IN CASE YOU HAVE NOT ALREADY NOTICED THERE ARE IN FACT 6 TUNES ON THIS DEMO SCREEN AND YOU CAN SELECT THESE BY PRESSING THE KEYS F1-F6. ALL THE TUNES ARE WRITTEN "
	DC.B " BY SPAZ AND ARE ALL ORIGINAL COMPOSITIONS EXCEPT FOR  'IN THE NIGHT' AND 'PANINARO' WHICH ARE ORIGINALLY BY THE PET SHOP BOYS. ALL THE OTHER MEMBERS OF THE LOST BOYS TAKE ABSOLUTELY NO RESPONSIBILITY FOR THE NAMES OF THE TUNES "
	DC.B ", THEY ARE ENTIRELY THE HANDIWORK OF SPAZ AND HIS TORMENTED AND PERVERTED MIND!!! IN DAYS OF OLD THIS SCREEN ON ITS OWN WOULD HAVE CONSTITUTED AN ENTIRE DEMO, AS WITH THE EXCEPTIONS EXCELLENT AMIGA DEMO.  ISN'T IT AMAZING HOW MUCH"
	DC.B " MORE IT TAKES TO AMAZE PEOPLE THESE DAYS. THE AMIGA DEMO IS ONLY JUST OVER 2 YEARS OLD BUT THINGS HAVE NEVER REALLY BEEN THE SAME SINCE THE UNION DEMO HAVE THEY??!!  SPAZ IS DETERMINED THAT HE WILL PRODUCE THE FIRST EVER FOUR TRACK HEAVY"
	DC.B " METAL DEMO ON THE ST. I AM CURRENTLY TRYING TO GET HIM TO WRITE SOMETHING IN THIS SCROLLINE ( HE'S SITTING JUST BEHIND ME.) BUT HE WAS OUT LATE LAST NIGHT AND HENCE IS BEING AN EXTREMELY LAZY AND BORING SHIT. PROBABLY HAVING GIRLFRIEND"
	DC.B " PROBLEMS, HER NAME IS KAREN AND APPARENTLY SHE SNORES ALTHOUGH WHY THIS SHOULD BOTHER HIM I REALLY DON'T KNOW!! ACCORDING TO HER HE TALKS IN HIS SLEEP SO I GUESS THIS IS GOING TO BE A VERY LONG LASTING RELATIONSHIP!!!!!! "
	DC.B " WELL FOR THE LACK OF ANYTHING ELSE TO SAY LETS TALK ABOUT THE WEATHER. IT IS AN ABSOLUTELY GLORIOUS DAY IN LONDON TODAY, THE SUN IS OUT AND ITS REALLY WARM (ABOUT 20C AND FOR THE 1ST APRIL IN ENGLAND THIS IS REALLY AMAZING!!) "
	DC.B " THIS AFTERNOON IS OUR RELATIVE BASHING AFTERNOON AS MUCH OF OUR FAMILY HAVE COME AROUND OUR HOUSE, FORTUNATELY WE HAVE MANAGED TO AVOID THE HABITUAL WALK IN THE PARK. (SPAZ AND I) AND SO WE ARE FREE TO FINISH OFF YET MORE SCREENS"
	DC.B " FOR OUR MAMMOTH DEMO.  THIS IS NOW THE BIGGEST SCREEN ON THE WHOLE DISK IT TAKES UP NEARLY 200 SECTORS ABOUT 100K OF DISK SPACE AND IS REALLY TO BIG TO PUT ON THE DISK BUT I GUESS WE'LL HAVE TO SQUEEZE IT ON SOME HOW. "
	DC.B " THE SCREEN IS PERHAPS A LITTLE SIMPLE AND THIS IS BECAUSE I REALLY DIDN'T HAVE ALL THAT MUCH TIME TO WRITE IT (ABOUT 1 DAY) AND SO I JUST PUT A FEW PIECES OF CODE TOGETHER SO THAT WE WOULD HAVE SOMTHING TO SHOW FOR OUR HARD WORK."
	DC.B " FUTURE DIGISYNTH SCREENS WILL BE A LOT BETTER WE PROMISE. BUT AT LEAST WE HAVE INCLUDED A NICE LOT OF MUSIC FOR YOU TO IMPRESS ALL YOUR FRIENDS WITH EH!!!  LOST BOYS ARE THE FUCKING BEST!!!!!!!        WRAP!!!!!!!!!!!!"
	DC.B "                ",$FF
	EVEN

SCROLLPOINT	DC.L SCROLLINE

***************************
* VARIABLES AND ALL SORTS OF OTHER SHIT
***************************

COUNT		DC.W 1
CHARPOS1	DC.L FONT2
CHARPOS2	DC.L FONT1

********************************
* THE FONTS
******************************
TEXT		INCBIN "SCROLL.PRG\TEXT.DAT"
TEXT1		EQU TEXT+280
TEXT2		EQU TEXT1+280
TEXT3		EQU TEXT2+280
TEXT4		EQU TEXT3+280
TEXT5		EQU TEXT4+280
TEXT6		EQU TEXT5+280
SIGN		EQU TEXT6+280
DEFSTARS	INCBIN "STARS\STARS.DAT"
SONGBUFFER
FONT	INCBIN "SCROLL.PRG\ARISTA.FON"


