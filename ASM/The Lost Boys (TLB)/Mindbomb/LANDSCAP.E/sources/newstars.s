	opt	x+
	clr.l	-(a7)
	move.w	#32,-(a7)
	trap	#1
	addq.l	#6,a7
	clr.w	-(a7)
	pea	$78000
	pea	$78000
	move.w	#5,-(a7)
	trap	#14
	adda.l	#12,a7
	bsr	makeupstars
loop	bsr	erasesub
	bsr	starssub
	bra.s	loop
***************************** STAR ROUTINE ************************	
* THE STAR ROUTINE IS SIMPLICITY ITSELF TO MAKE IT VERY FAST THE
* ROUTINE SIMPLY PLOTS DATA TO THE SCREEN FROM A PREVIOUSLY WORKED OUT 
* TABLE. THE	DATA SHOULD CONSIST OF A SCREEN OFFSET ADDRESS AND
* AN NUMBER BETWEEN 0 AND 15 FOR THE BIT TO BE SET.
* AS THE DESIGN OF A STARFIELD IS A PERSONAL THING SO IT IS UP TO YOU 
* TO CONSTRUCT THE DAT AS YOU SO WISH.


****ERASE OLD STARS
erasesub
	MOVE.L OLDSPRITE,A4	ERASE THE SPRITES
	MOVEQ.W #9,D7
CC_LOOP
	MOVE.L (A4)+,A3
	REPT 8
	MOVEM.L (A4)+,D0-D6/A5
	MOVEM.L D0-D3,(A3)
	LEA 160(A3),A3
	MOVEM.L D4-D6/A5,(A3)
	LEA 160(A3),A3
	ENDR
	DBF D7,CC_LOOP
	CMP.L #$78000,LOGBASE
	BNE.S ALTEND
* WHICH SCREEN?
	MOVE.L #OLDSTARS,OLDSTARPOINT
	BRA.S COYTU
ALTEND
	MOVE.L #OLDSTARS1,OLDSTARPOINT
COYTU
	MOVE.L OLDSTARPOINT,A2		ERASE STARS ROUTINE
	MOVE.L LOGBASE,A3
	MOVEQ #0,D1
	REPT 100			* 100 STARS!!
	MOVE.W (A2)+,D2			GET POSITION
	MOVE.W D1,(A3,D2.W)		WIPE EM OUT
	ENDR
	RTS
starssub
	LEA STARS(PC),A2		PLOT THE STARS
	MOVE.L LOGBASE,A3
	MOVE.L OLDSTARPOINT(PC),A5
	MOVE.W #99,D0
	MOVE.W #$FFFF,D1
DRAWLOOP
	MOVE.L (A2)+,A4
	MOVE.W (A4)+,D2
	CMP.W D1,D2			END OF TRACK IF -1 THEN GET NEW DATA TRACK
	BNE.S CONTB
	MOVE.L (A2),-(A2)
	BRA.S DRAWLOOP
CONTB
	MOVE.W (A4)+,D3
	MOVE.L A4,-(A2)
	LEA 8(A2),A2
	TST.W (A3,D3.W)
	BNE.S BYPASSDRAW
	OR.W D2,(A3,D3.W)		PLOT ACCORDING TO TABLE
BYPASSDRAW
	MOVE.W D3,(A5)+
	DBF D0,DRAWLOOP
	RTS
makeupstars
	LEA STARS(PC),A0
	MOVEQ #0,D0
	MOVE.W #84,D1
CVLOOP
	MOVE.L (A0),A1
	ADD.L D0,A1
	MOVE.L A1,(A0)
	LEA 8(A0),A0
	ADD.L #4,D0
	DBF D1,CVLOOP

	MOVEQ #0,D0
	MOVE.W #14,D1
CVLOOP1
	MOVE.L (A0),A1
	ADD.L D0,A1
	MOVE.L A1,(A0)
	LEA 8(A0),A0
	ADD.L #24,D0
	DBF D1,CVLOOP1
	RTS

OLDSTARPOINT	DC.L 0

OLDSTARS	
	REPT 100
	DC.W 0
	ENDR

OLDSTARS1
	REPT 100
	DC.W 0
	ENDR

STARS	
ADDIT	SET 0
	REPT 100
	DC.L DEFSTARS+ADDIT,DEFSTARS+ADDIT
ADDIT	SET ADDIT+360
	ENDR




OLDSPRITE	DC.L OLD1
OLD1		REPT 10
		DC.L $78000
		DS.B 256
		ENDR
OLD2		REPT 10
		DC.L $78000
		DS.B 256
		ENDR






DEFSTARS	INCBIN	a:\landscap.e\LANDSCAP.E\DATA\HALFSTAR.DAT

**********************************
* VARIABLES AND SHIT
* THESE ARE THE VARIOUS VARIABLES USED
* IN THE PROGRAM
**********************************

BLANK		DS.L 14
POSIND		DC.W 4 
LANDPOINT	DC.L LANDPAL
PHYSBASE	DC.L $78000
LOGBASE		DC.L $68000
STRING		DC.B $12,$14
LETEND		DC.W 1
LETIND		DC.W 1
OLDHBL		DC.L 0
OLDIEB 		DC.B 0
OLDIEA		DC.B 0
OLDIMA		DC.W 0
DRAWPOINT	DC.L PALETTE-16
PALPOINT	DC.L PALEEND-32
LANDPAL	DS.L 230
PALETTE	DS.L 500
PALEEND	DS.L 10
	DS.L 100
MYSTACK	DC.L 0
PALETTESCR	DC.W $707,$607,$507,$407,$307,$207,$107,$7
