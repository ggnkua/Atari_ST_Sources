xa%=0
ya%=-400
GOSUB kill_mouseks
HIDEM
REPEAT
  ax%=MOUSEX
  ay%=MOUSEY
  IF xa%<>ax% OR ya%<>ay%
    GRAPHMODE 3
    BOX xa%,ya%,xa%+(640/zoom%),ya%+(480/zoom%)
    BOX ax%,ay%,ax%+(640/zoom%),ay%+(480/zoom%)
    GRAPHMODE 1
  ENDIF
  xa%=ax%
  ya%=ay%
UNTIL MOUSEK<>0
IF init=FALSE
  BOX xa%,ya%,xa%+(640/zoom%),ya%+(480/zoom%)
ENDIF
CLR c%
FOR y%=0 TO INT(479/zoom%)
  FOR x%=0 TO INT(639/zoom%)
    lupe|(c%)=PTST(x%+ax%,y%+ay%)
    PSET x%+50,y%+ay%,lupe|(c%)
    INC c%
  NEXT x%
NEXT y%
CLR c%
FOR y%=0 TO INT(479/zoom%)
  FOR x%=0 TO INT(639/zoom%)
    '      fpbox(x%*zoom%,y%*zoom%,x%*zoom+zoom%-1,y%*zoom%+zoom%-1,lupe|(c%))
    fpbox(x%*zoom%,y%*zoom%,x%*zoom%+zoom%-1,y%*zoom%+zoom%-1,lupe|(c%))
    INC c%
  NEXT x%
NEXT y%
SHOWM
GRAPHMODE 1
REPEAT
  scrtasten
  IF MOUSEK=1
    HIDEM
    mx%=MOUSEX/zoom%
    my%=MOUSEY/zoom%
    fpbox(mx%*zoom%,my%*zoom%,mx%*zoom%+zoom%-1,my%*zoom%+zoom%-1,acolor%)
    SHOWM
  ENDIF
UNTIL MOUSEK=2
GOSUB kill_mouseks
