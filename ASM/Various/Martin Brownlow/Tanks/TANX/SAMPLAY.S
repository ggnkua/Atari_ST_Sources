* This is a modified version of STOS Maestro replay
* source code.

SAMSTOP	BCLR	#5,$FFFA07
	MOVE.L	OLDTHNG,$134
	MOVE.L	OLDVBL,$70
	RTS

PLAYSAM	PEA	SNDINIT
	MOVE.W 	#32,-(SP)
	TRAP 	#14
	ADDQ.L 	#6,SP
	MOVE.L	#1,LENGTH
	MOVE.L	#NOSAM,ADDR
	MOVE.L	$134,OLDTHNG
	MOVE.L	$70,OLDVBL
	MOVE.W 	SR,D7
	MOVE.W 	#$2700,SR
	CLR.B 	$FFFA19
	MOVE.B 	#131,$FFFA1F
	MOVE.B	#1,$FFFA19
	ORI.B 	#$20,$FFFA13
	ORI.B 	#$20,$FFFA07
	BCLR.B 	#3,$FFFA17
	MOVE.L 	#SAMPLAY,$134
	MOVE.L	#VBL,$70
	MOVE.W 	D7,SR
	RTS

VBL	bset	#7,flags
	CMP.L	#1,LENGTH
	BNE	NOTZ
	MOVE.W	#0,PLAYING
NOTZ	CMP.B	#0,NEWSAM
	BEQ	OUTVBL
	BTST.B	#0,NEWSAM
	BNE	EXPLSON
	BTST.B	#3,NEWSAM
	BNE	RICOCHE
	BTST.B	#5,NEWSAM
	BNE	LAUGHIT
	BTST.B	#1,NEWSAM
	BNE	SKWARK
	BTST.B	#2,NEWSAM
	BNE	LITBUL
	BTST.B	#4,NEWSAM
	BNE	WIERD
	MOVE.W	#0,NEWSAM
OUTVBL	MOVE.W	#0,NEWSAM
	MOVE.L	OLDVBL,-(SP)
	RTS
SKWARK	CMP.W	#4,PLAYING
	BEQ	OUTVBL
	MOVE.W	#2,PLAYING
	MOVE.L	#HBIRD,ADDR
	MOVE.L	#RICO-HBIRD,LENGTH
	BRA	OUTVBL
RICOCHE	CMP.W	#4,PLAYING
	BEQ	OUTVBL
	MOVE.W	#3,PLAYING
	MOVE.L	#RICO,ADDR
	MOVE.L	#UFOSND-RICO,LENGTH
	BRA	OUTVBL
WIERD	CMP.W	#0,PLAYING
	BNE	OUTVBL
	MOVE.W	#1,PLAYING
	MOVE.L	#UFOSND,ADDR
	MOVE.L	#LAUGH-UFOSND,LENGTH
	BRA	OUTVBL
LAUGHIT	CMP.W	#4,PLAYING
	BEQ	OUTVBL
	MOVE.W	#5,PLAYING
	MOVE.L	#LAUGH,ADDR
	MOVE.L	#NOSFX-LAUGH,LENGTH
	BRA	OUTVBL
EXPLSON	MOVE.W	#4,PLAYING
	MOVE.L	#EXPLOS,ADDR
	MOVE.L	#SHOT1-EXPLOS,LENGTH
	BRA	OUTVBL
LITBUL	CMP.W	#4,PLAYING
	BEQ	OUTVBL
	MOVE.W	#1,PLAYING
	MOVE.L	#SHOT1,ADDR
	MOVE.L	#HBIRD-SHOT1,LENGTH
	BRA	OUTVBL	

FINSAM	MOVE.L	#1,LENGTH
	MOVEM.L	(SP)+,D7/A3
	RTE
SAMPLAY	MOVEM.L	D7/A3,-(SP)
	SUBQ.L 	#1,LENGTH
	BEQ.S 	FINSAM
	MOVEA.L	ADDR,A3
	MOVE.B	(A3),D7
	ADDQ.L	#1,ADDR
	ANDI.W 	#$FF,D7
	LSL.W 	#4,D7
	LEA	VOLDAT2,A3
	MOVE.L 	(A3,D7.W),PSG
	MOVE.L 	4(A3,D7.W),PSG
	MOVE.L 	8(A3,D7.W),PSG
	MOVEM.L (SP)+,D7/A3
	RTE

ADDR	DC.L	NOSAM
LENGTH	DC.L 	1
OLDVBL	DC.L	0
OLDTHNG	DC.L	0
PLAYING	DC.W	0
NEWSAM	DC.W	0

VOLDAT2	DC.L $08000000,$09000000,$0A000000,0
	DC.L $08000000,$09000000,$0A000100,0
	DC.L $08000100,$09000100,$0A000000,0
	DC.L $08000100,$09000100,$0A000100,0
	DC.L $08000200,$09000200,$0A000000,0
	DC.L $08000200,$09000200,$0A000100,0
	DC.L $08000300,$09000100,$0A000000,0
	DC.L $08000300,$09000100,$0A000100,0
	DC.L $08000400,$09000000,$0A000000,0
	DC.L $08000400,$09000100,$0A000100,0
	DC.L $08000400,$09000200,$0A000000,0
	DC.L $08000400,$09000200,$0A000100,0
	DC.L $08000500,$09000000,$0A000000,0
	DC.L $08000500,$09000100,$0A000100,0
	DC.L $08000500,$09000200,$0A000000,0
	DC.L $08000500,$09000200,$0A000100,0
	DC.L $08000500,$09000300,$0A000000,0
	DC.L $08000500,$09000300,$0A000100,0
	DC.L $08000600,$09000200,$0A000000,0
	DC.L $08000600,$09000200,$0A000100,0
	DC.L $08000600,$09000300,$0A000000,0
	DC.L $08000600,$09000300,$0A000000,0
	DC.L $08000600,$09000300,$0A000100,0
	DC.L $08000600,$09000300,$0A000100,0
	DC.L $08000600,$09000300,$0A000100,0
	DC.L $08000600,$09000300,$0A000200,0
	DC.L $08000600,$09000300,$0A000200,0
	DC.L $08000600,$09000300,$0A000200,0
	DC.L $08000700,$09000000,$0A000000,0
	DC.L $08000700,$09000100,$0A000100,0
	DC.L $08000700,$09000200,$0A000100,0
	DC.L $08000700,$09000200,$0A000200,0
	DC.L $08000700,$09000400,$0A000000,0
	DC.L $08000700,$09000400,$0A000100,0
	DC.L $08000700,$09000400,$0A000200,0
	DC.L $08000700,$09000400,$0A000300,0
	DC.L $08000800,$09000300,$0A000000,0
	DC.L $08000800,$09000300,$0A000200,0
	DC.L $08000800,$09000400,$0A000000,0
	DC.L $08000800,$09000400,$0A000200,0
	DC.L $08000800,$09000500,$0A000000,0
	DC.L $08000800,$09000500,$0A000100,0
	DC.L $08000800,$09000500,$0A000200,0
	DC.L $08000800,$09000500,$0A000300,0
	DC.L $08000900,$09000000,$0A000100,0
	DC.L $08000900,$09000000,$0A000100,0
	DC.L $08000900,$09000200,$0A000200,0
	DC.L $08000900,$09000200,$0A000200,0
	DC.L $08000A00,$09000300,$0A000000,0
	DC.L $08000A00,$09000300,$0A000100,0
	DC.L $08000A00,$09000300,$0A000200,0
	DC.L $08000A00,$09000300,$0A000200,0
	DC.L $08000A00,$09000400,$0A000100,0
	DC.L $08000A00,$09000400,$0A000100,0
	DC.L $08000A00,$09000400,$0A000200,0
	DC.L $08000A00,$09000400,$0A000200,0
	DC.L $08000A00,$09000400,$0A000200,0
	DC.L $08000A00,$09000400,$0A000300,0
	DC.L $08000A00,$09000400,$0A000300,0
	DC.L $08000A00,$09000400,$0A000400,0
	DC.L $08000A00,$09000400,$0A000400,0
	DC.L $08000A00,$09000400,$0A000400,0
	DC.L $08000A00,$09000400,$0A000500,0
	DC.L $08000A00,$09000400,$0A000500,0
	DC.L $08000A00,$09000400,$0A000500,0
	DC.L $08000A00,$09000500,$0A000000,0
	DC.L $08000A00,$09000500,$0A000200,0
	DC.L $08000A00,$09000500,$0A000300,0
	DC.L $08000A00,$09000500,$0A000400,0
	DC.L $08000A00,$09000600,$0A000000,0
	DC.L $08000A00,$09000600,$0A000200,0
	DC.L $08000A00,$09000600,$0A000300,0
	DC.L $08000A00,$09000600,$0A000400,0
	DC.L $08000A00,$09000600,$0A000500,0
	DC.L $08000A00,$09000700,$0A000000,0
	DC.L $08000A00,$09000700,$0A000000,0
	DC.L $08000A00,$09000700,$0A000100,0
	DC.L $08000A00,$09000700,$0A000200,0
	DC.L $08000A00,$09000700,$0A000200,0
	DC.L $08000A00,$09000700,$0A000300,0
	DC.L $08000A00,$09000700,$0A000400,0
	DC.L $08000B00,$09000000,$0A000000,0
	DC.L $08000B00,$09000100,$0A000000,0
	DC.L $08000B00,$09000100,$0A000100,0
	DC.L $08000B00,$09000200,$0A000000,0
	DC.L $08000B00,$09000200,$0A000100,0
	DC.L $08000B00,$09000300,$0A000000,0
	DC.L $08000B00,$09000300,$0A000200,0
	DC.L $08000B00,$09000400,$0A000000,0
	DC.L $08000B00,$09000400,$0A000200,0
	DC.L $08000B00,$09000400,$0A000300,0
	DC.L $08000B00,$09000400,$0A000400,0
	DC.L $08000B00,$09000600,$0A000000,0
	DC.L $08000B00,$09000600,$0A000200,0
	DC.L $08000B00,$09000600,$0A000300,0
	DC.L $08000B00,$09000600,$0A000400,0
	DC.L $08000B00,$09000800,$0A000000,0
	DC.L $08000B00,$09000800,$0A000100,0
	DC.L $08000B00,$09000800,$0A000300,0
	DC.L $08000B00,$09000800,$0A000400,0
	DC.L $08000B00,$09000900,$0A000000,0
	DC.L $08000B00,$09000900,$0A000200,0
	DC.L $08000B00,$09000900,$0A000300,0
	DC.L $08000B00,$09000900,$0A000400,0
	DC.L $08000C00,$09000400,$0A000000,0
	DC.L $08000C00,$09000400,$0A000000,0
	DC.L $08000C00,$09000400,$0A000100,0
	DC.L $08000C00,$09000400,$0A000100,0
	DC.L $08000C00,$09000500,$0A000200,0
	DC.L $08000C00,$09000500,$0A000200,0
	DC.L $08000C00,$09000500,$0A000300,0
	DC.L $08000C00,$09000500,$0A000300,0
	DC.L $08000C00,$09000500,$0A000400,0
	DC.L $08000C00,$09000500,$0A000400,0
	DC.L $08000C00,$09000600,$0A000000,0
	DC.L $08000C00,$09000600,$0A000100,0
	DC.L $08000C00,$09000600,$0A000200,0
	DC.L $08000C00,$09000600,$0A000400,0
	DC.L $08000C00,$09000700,$0A000000,0
	DC.L $08000C00,$09000700,$0A000200,0
	DC.L $08000C00,$09000700,$0A000400,0
	DC.L $08000C00,$09000800,$0A000000,0
	DC.L $08000C00,$09000800,$0A000200,0
	DC.L $08000C00,$09000800,$0A000300,0
	DC.L $08000C00,$09000800,$0A000400,0
	DC.L $08000C00,$09000900,$0A000000,0
	DC.L $08000C00,$09000900,$0A000200,0
	DC.L $08000C00,$09000900,$0A000300,0

	DC.L $08000D00,$09000000,$0A000000,0
	DC.L $08000D00,$09000100,$0A000000,0
	DC.L $08000D00,$09000100,$0A000100,0
	DC.L $08000D00,$09000200,$0A000100,0
	DC.L $08000D00,$09000300,$0A000100,0
	DC.L $08000D00,$09000300,$0A000200,0
	DC.L $08000D00,$09000400,$0A000000,0
	DC.L $08000D00,$09000400,$0A000200,0
	DC.L $08000D00,$09000400,$0A000300,0
	DC.L $08000D00,$09000400,$0A000400,0
	DC.L $08000D00,$09000500,$0A000300,0
	DC.L $08000D00,$09000500,$0A000400,0
	DC.L $08000D00,$09000600,$0A000300,0
	DC.L $08000D00,$09000600,$0A000400,0
	DC.L $08000D00,$09000700,$0A000000,0
	DC.L $08000D00,$09000700,$0A000200,0
	DC.L $08000D00,$09000700,$0A000300,0
	DC.L $08000D00,$09000700,$0A000400,0
	DC.L $08000D00,$09000700,$0A000500,0
	DC.L $08000D00,$09000700,$0A000500,0
	DC.L $08000D00,$09000800,$0A000000,0
	DC.L $08000D00,$09000800,$0A000200,0
	DC.L $08000D00,$09000800,$0A000400,0
	DC.L $08000D00,$09000800,$0A000500,0
	DC.L $08000D00,$09000900,$0A000100,0
	DC.L $08000D00,$09000900,$0A000300,0
	DC.L $08000D00,$09000900,$0A000400,0
	DC.L $08000D00,$09000900,$0A000500,0
	DC.L $08000D00,$09000900,$0A000500,0
	DC.L $08000D00,$09000900,$0A000600,0
	DC.L $08000D00,$09000900,$0A000600,0
	DC.L $08000D00,$09000900,$0A000600,0
	DC.L $08000D00,$09000A00,$0A000100,0
	DC.L $08000D00,$09000A00,$0A000200,0
	DC.L $08000D00,$09000A00,$0A000300,0
	DC.L $08000D00,$09000A00,$0A000300,0
	DC.L $08000D00,$09000A00,$0A000400,0
	DC.L $08000D00,$09000A00,$0A000500,0
	DC.L $08000D00,$09000A00,$0A000500,0
	DC.L $08000D00,$09000A00,$0A000600,0
	DC.L $08000D00,$09000B00,$0A000000,0
	DC.L $08000D00,$09000B00,$0A000100,0
	DC.L $08000D00,$09000B00,$0A000200,0
	DC.L $08000D00,$09000B00,$0A000300,0
	DC.L $08000D00,$09000B00,$0A000400,0
	DC.L $08000D00,$09000B00,$0A000400,0
	DC.L $08000D00,$09000B00,$0A000500,0
	DC.L $08000D00,$09000B00,$0A000500,0
	DC.L $08000E00,$09000000,$0A000000,0
	DC.L $08000E00,$09000000,$0A000100,0
	DC.L $08000E00,$09000300,$0A000000,0
	DC.L $08000E00,$09000400,$0A000300,0
	DC.L $08000E00,$09000400,$0A000500,0
	DC.L $08000E00,$09000500,$0A000400,0
	DC.L $08000E00,$09000500,$0A000500,0
	DC.L $08000E00,$09000700,$0A000000,0
	DC.L $08000E00,$09000700,$0A000300,0
	DC.L $08000E00,$09000700,$0A000400,0
	DC.L $08000E00,$09000700,$0A000400,0
	DC.L $08000E00,$09000800,$0A000200,0
	DC.L $08000E00,$09000800,$0A000400,0
	DC.L $08000E00,$09000800,$0A000500,0
	DC.L $08000E00,$09000800,$0A000500,0
	DC.L $08000E00,$09000900,$0A000000,0
	DC.L $08000E00,$09000900,$0A000100,0
	DC.L $08000E00,$09000900,$0A000200,0
	DC.L $08000E00,$09000900,$0A000300,0
	DC.L $08000E00,$09000900,$0A000500,0
	DC.L $08000E00,$09000900,$0A000500,0
	DC.L $08000E00,$09000900,$0A000600,0
	DC.L $08000E00,$09000900,$0A000700,0
	DC.L $08000E00,$09000A00,$0A000000,0
	DC.L $08000E00,$09000A00,$0A000500,0
	DC.L $08000E00,$09000A00,$0A000800,0
	DC.L $08000E00,$09000A00,$0A000900,0
	DC.L $08000E00,$09000B00,$0A000300,0
	DC.L $08000E00,$09000B00,$0A000600,0
	DC.L $08000E00,$09000B00,$0A000800,0
	DC.L $08000E00,$09000B00,$0A000900,0
	DC.L $08000E00,$09000C00,$0A000000,0
	DC.L $08000E00,$09000C00,$0A000100,0
	DC.L $08000E00,$09000C00,$0A000200,0
	DC.L $08000E00,$09000C00,$0A000300,0
	DC.L $08000E00,$09000C00,$0A000400,0
	DC.L $08000E00,$09000C00,$0A000400,0
	DC.L $08000E00,$09000C00,$0A000500,0
	DC.L $08000E00,$09000C00,$0A000500,0
	DC.L $08000E00,$09000C00,$0A000600,0
	DC.L $08000E00,$09000C00,$0A000600,0
	DC.L $08000E00,$09000C00,$0A000600,0
	DC.L $08000E00,$09000C00,$0A000600,0
	DC.L $08000E00,$09000C00,$0A000700,0
	DC.L $08000E00,$09000C00,$0A000700,0
	DC.L $08000E00,$09000C00,$0A000700,0
	DC.L $08000E00,$09000C00,$0A000700,0
	DC.L $08000E00,$09000D00,$0A000000,0
	DC.L $08000E00,$09000D00,$0A000100,0
	DC.L $08000E00,$09000D00,$0A000200,0
	DC.L $08000E00,$09000D00,$0A000200,0
	DC.L $08000E00,$09000D00,$0A000300,0
	DC.L $08000E00,$09000D00,$0A000400,0
	DC.L $08000E00,$09000D00,$0A000500,0
	DC.L $08000E00,$09000D00,$0A000500,0
	DC.L $08000E00,$09000D00,$0A000600,0
	DC.L $08000E00,$09000D00,$0A000600,0
	DC.L $08000E00,$09000D00,$0A000700,0
	DC.L $08000E00,$09000D00,$0A000700,0
	DC.L $08000E00,$09000D00,$0A000700,0
	DC.L $08000E00,$09000D00,$0A000700,0
	DC.L $08000E00,$09000D00,$0A000800,0
	DC.L $08000E00,$09000D00,$0A000800,0
	DC.L $08000E00,$09000E00,$0A000000,0
	DC.L $08000E00,$09000E00,$0A000000,0
	DC.L $08000E00,$09000E00,$0A000100,0
	DC.L $08000E00,$09000E00,$0A000100,0
	DC.L $08000E00,$09000E00,$0A000200,0
	DC.L $08000E00,$09000E00,$0A000200,0
	DC.L $08000E00,$09000E00,$0A000300,0
	DC.L $08000E00,$09000E00,$0A000300,0
	DC.L $08000E00,$09000E00,$0A000400,0
	DC.L $08000E00,$09000E00,$0A000500,0
	DC.L $08000E00,$09000E00,$0A000600,0
	DC.L $08000E00,$09000E00,$0A000600,0
	DC.L $08000E00,$09000E00,$0A000700,0
	DC.L $08000E00,$09000E00,$0A000700,0
	DC.L $08000E00,$09000E00,$0A000700,0
	DC.L $08000E00,$09000E00,$0A000700,0

SNDINIT	DC.B 0,0,1,0,2,0,3,0,4,0,5,0,6,0,7,255,8,0,9,0,10,0,11,0,12,0,13,0,255,0

PSG	EQU	$FF8800
NOSAM	DC.W	0
EXPLOS	INCBIN	"a:\tanx\data\EXPLODE.SPL"
SHOT1	INCBIN	"a:\tanx\data\SHOT.SPL"
HBIRD	INCBIN	"a:\tanx\data\SWOSH.SPL"
RICO	INCBIN	"a:\tanx\data\METALBAR.SPL"
UFOSND	INCBIN	"a:\tanx\data\ufosnd.spl"
LAUGH	INCBIN	"a:\tanx\data\laugh.spl"
NOSFX