                             NOTICE
     Thå  followinç  ió  thå  originaì  manuscripô  foò  thå 
     articlå  'Tinù  BASIÃ comeó tï thå 68000§ publisheä  iî 
     thå Februarù 198µ issuå oæ Dr®  Dobbs'ó Journal®   Thió 
     manuscripô ió copyrighô (c© 198´ bù Gordoî Brandlù  anä 
     ió  distributeä  witè thå permissioî oæ Gordoî  Brandlù 
     anä Dr® Dobb'ó Journal.



                  Tiny BASIC Comes to the 68000

                                     by Gordon Brandly
                                        R. R. 2
                                        Fort Sask., AB, CANADA
                                        T8L 2N8


     Remembeò  thå gooä olä days¿   Wheî thå 808°  microprocessoò 
reigneä  supreme¬  8Ë oæ memorù cosô aî arí anä á leg¬  aè yes..®  
Welì thå yearó wenô by¬  microcomputeró goô bigger¬ softwarå gre÷ 
morå  sophisticated¬  anä priceó wenô up®   Thió ió jusô finå  oæ 
course¬  iæ yoõ caî afforä thå higheò prices®  Thå lesó fortunatå 
amonç us¬ however¬ musô builä oò buù smalleò 16-biô "educational¢ 
systems®   Thió ió finå too¬  iæ yoõ don'ô minä havinç hardlù anù 
software®   Thió ió thå jusô thå sorô oæ situatioî thaô gavå riså 
tï Dr®  Dobb'ó Journaì iî thå 'gooä olä days'®  Thå solutioî bacë 
theî  waó  tï  publisè á tinù BASIÃ  interpreteò  thaô  coulä  bå 
adapteä  tï  jusô  abouô anù  808°  microcomputeò  around®   Thió 
solutioî  workeä  fabulouslù anä gavå manù á hobbù  computeò  itó 
firsô  tastå oæ usefuì software®   Well¬  iæ thå solutioî  workeä 
once¬ whù noô again¿  É thereforå decideä tï producå á tinù BASIÃ 
interpreteò  foò  alì  oæ  yoõ whï havå  relativelù  smalì  6800° 
systemó  sucè aó thå Motorolá Educatioî Computeò Board¬  thå  EMÓ 
6800° board¬ etc.
     Tï producå thió BASIÃ É tooë onå oæ thå mosô successfuì 808° 
Tinù  BASICs¬  Lé Cheî Wang'ó Palï Altï Tinù BASIÃ (publisheä  iî 
thå  Maù 197¶ Dr®  Dobb'ó Journal© anä translateä iô  intï  6800° 
code®   É  theî  addeä  á fe÷ featureó anä optimizeä thå  codå  á 
littlå bit¬ producinç á surprisinglù usablå interpreter.
     First¬ I'lì describå thå differenceó betweeî mù interpreter¬ 
Palï  Altï Tinù BASIC¬  anä thå ubiquitouó Microsofô  BASICs®   É 
wilì  theî  describå ho÷ yoõ caî instalì thió  softwarå  oî  youò 
6800°   system®    Finally¬   I'lì  givå  mù  evaluatioî  oæ  thå 
interpreter'ó presenô performancå anä ho÷ iô caî bå improved.



Features

     Foò thoså whï kno÷ thå originaì Palï Altï Tinù BASIÃ (oò thå 
Sherrù  Brothers§ versioî oî CP/Í User'ó Grouğ  Volumå  11)¬  yoõ 
wilì  finä  thió interpreteò verù similar®   É havå madå  twï  oò 
threå  changeó tï thå interpreter'ó syntaø tï brinç iô closeò  tï 
thå  då  factï  Microsofô 'standard'®   Thå coloî (":"©  ió  useä Šinsteaä  oæ thå semi-coloî (";"© tï separatå multiplå  statementó 
oî á line®   Thå inequalitù operatoò "#¢ haó beeî changeä tï  thå 
morå standarä "<>¢ ®   É alsï addeä thå PEEK¬  POKE¬  CALL¬  BYE¬ 
LOAD¬ anä SAVÅ commands¬ describeä later.
     Foò thoså oæ yoõ useä tï á biggeò BASIC¬ sucè aó thå variouó 
Microsofô  interpreters¬  you'lì  finä  thaô thió  versioî  workó 
almosô  thå  samå withiî itó  limitations®   Followinç  arå  somå 
excerptó  froí Lé Cheî Wang'ó originaì documentation¬  mixeä witè  
descriptionó oæ mù extensions:




The Language


Numbers:

Iî thió Tinù BASIC¬  alì numberó arå 32-biô integeró anä musô  bå 
iî  thå rangå 2,147,483,64· tï -2,147,483,648®   É decideä tï uså 
3²  bitó  sï  thaô thå PEEË anä POKÅ commandó  coulä  accesó  thå 
entirå  addresó rangå oæ thå 68000®   Thió slowó dowî  arithmetiã 
operationó somewhat¬  buô stickinç tï 1¶ bitó woulä havå produceä 
unneccessarù complications.


Variables:

Therå arå 2¶ variableó denoteä bù thå letteró Á througè Z®  Therå 
ió alsï á singlå arraù @(I)®  Thå dimensioî oæ thió arraù  (i.e.¬ 
thå  rangå oæ valuå oæ thå indeø I© ió seô automaticallù tï  makå 
uså  oæ  alì thå memorù spacå thaô ió lefô unuseä bù thå  prograí 
(i.e.¬  °  througè SIZE/4¬  seå thå SIZÅ  functioî  below)®   Alì 
variableó anä arraù elementó arå ´ byteó long.


Functions:

There are 4 functions:

     ABS(X) gives the absolute value of X.

     RND(X) gives a random number between 1 and X (inclusive).

     SIZE gives the number of bytes left unused by the program.

     PEEK(X) gives the value of the byte at memory location X.


LET Command:

     LET A=234-5*6, A=A/2, X=A-100, @(X+9)=A-1

Wilì  seô  thå variablå Á tï thå valuå oæ thå expressioî  234-5*¶ 
(i.e®  204)¬  seô  thå  variablå Á (again© tï thå  valuå  oæ  thå Šexpressioî A/² (i.e® 102)¬ seô thå variablå Ø tï thå valuå oæ thå 
expressioî A-10° (i.e® 2)¬ anä theî seô thå variablå @(11© tï 10± 
(wherå 1± ió thå valuå oæ thå expressioî X+¹ anä 10± ió thå valuå 
oæ thå expressioî A-1).


Print Command:

     PRINT A*3+1, "abc 123 !@#", ' cba '

Wilì  prinô  thå valuå oæ thå expressioî A*3+±  (i.e®  307)¬  thå 
strinç  oæ characteró "abã 12³ !@#¢ anä thå string¢  cbá  "¬  anä 
theî  á CR-LÆ (carriagå returî anä linå feed)®  Notå thaô  eitheò 
singlå  oò doublå quoteó caî bå useä tï quotå strings¬  buô pairó 
musô  bå  matched®  Iæ therå ió á commá aô thå enä oæ  thå  prinô 
command¬  thå  finaì CR-LÆ wilì noô bå printed®   Notå alsï  thaô 
commaó arå useä tï separatå adjacenô itemó (mosô otheò BASICó uså 
thå semi-coloî tï perforí thió function.)

     PRINÔ A¬ B¬ #3¬ C¬ D¬ E¬ #10¬ F¬ G

Wilì prinô thå valueó oæ Á anä Â iî 1± spaces¬  thå valueó oæ  C¬ 
D¬  anä Å iî ³ spaces¬ anä thå valueó oæ Æ anä Ç iî 1° spaces® Iæ 
therå  aren'ô  enougè  spaceó specifieä foò á giveî valuå  tï  bå 
printed¬ thå valuå wilì bå printeä iî fulì anyway.

     PRINÔ 'abc',_,'xxx'

Wilì  prinô thå strinç "abc"¬  á CÒ withouô á LF¬  anä  theî  thå 
strinç "xxx¢ (oveò thå "abc"© followeä bù á CR-LF.


INPUT Command:

     INPUT A, B

Wheî  thió  commanä ió executed¬  Tinù BASIÃ wilì prinô "A:¢  anä 
waiô  tï reaä iî aî expressioî froí thå console®  Thå variablå  Á 
wilì bå seô tï thå valuå oæ thió expression¬ theî "B:¢ ió printeä 
anä  variablå Â ió seô tï thå valuå oæ thå nexô  expressioî  reaä 
in®  Notå  thaô  completå expressionó aó welì aó numberó  caî  bå 
entered®   Thió  giveó riså tï aî interestinç trickº  yoõ caî seô 
thå variablå Ù tï aî unusuaì value¬  e.g® 9999¬ anä uså iô tï geô 
thå answeò tï á yes-or-nï question¬ sucè as

     1° Y=999¹ º INPUÔ 'Arå yoõ sleepy?'Á º IÆ A=Ù GOTÏ 100

Thió  workó  becauså thå useò caî answeò thå  questioî  witè  thå 
expressioî  'Y'¬  whicè  putó thå numeriã valuå oæ Ù intï  thå  Á 
variable.


     INPUÔ 'Whaô ió thå weight'A¬ "anä size"B

Thió  ió  thå  samå aó thå firsô INPUÔ examplå  excepô  thaô  thå Šprompô  "A:¢ ió replaceä bù "Whaô ió thå weight:¢ anä thå  prompô 
"B:¢ ió replaceä witè "anä size:"®  Again¬ botè singlå anä doublå 
quoteó caî bå useä aó lonç aó theù arå matched.

     INPUÔ A¬ 'string',_¬ "anotheò string"¬ B

Thå stringó anä thå "_¢ havå thå samå effecô aó iî "PRINT".


POKÅ Command:

     POKÅ 4000+X,Y

Thió  commanä putó thå valuå produceä bù expressioî "Y¢ intï  thå 
bytå memorù locatioî specifieä bù thå expressioî "4000+X".


CALL Command:

     CALL X

Thió  commanä  wilì  calì á machinå languagå  subroutinå  aô  thå 
addresó  specifieä  bù  thå  expressioî "X"®  Alì  oæ  thå  CPU'ó 
registeró excepô thå stacë pointeò caî bå useä iî thå subroutine.


BYÅ Command:

Wilì returî controì tï thå residenô monitoò prograí oò  operatinç 
system.


SAVE Command:

Wilì  savå youò BASIÃ prograí oî thå storagå devicå yoõ  provide® 
Detailó  oî installinç thió devicå arå giveî iî thå sourcå  code® 
Aó  seô uğ foò thå Educationaì Computeò Board¬  thió commanä wilì 
senä  thå  prograí ouô tï thå hosô computeò iî  aî  easily-storeä 
texô form®  Iô isn't¬  however¬ human-readablå prograí texô sincå 
thå linå numberó arå storeä iî hexadecimal.


LOAÄ Command:

Wilì deletå thå prograí iî memorù anä loaä iî á prograí froí youò 
storagå device.


Stoppinç Prograí Execution:

Thå  executioî  oæ thå prograí oò listinç oæ thå prograí  caî  bå 
stoppeä   bù   pressinç  thå  control-Ã  keù  oî   thå   console® 
Additionally¬  á  prograí  listinç  caî  bå  pauseä  bù  pressinç 
control-S¬ anä theî pressinç anù keù tï continue.
Š
Abbreviationó anä Blanks:

Yoõ  maù uså blankó freelù withiî á prograí excepô thaô  numbers¬ 
commanä  keù  words¬  anä  functioî nameó  cannoô  havå  embeddeä 
blanks.
     Yoõ maù abbreviatå alì commanä keù wordó anä functioî  nameó 
anä follo÷ eacè bù á period®   Foò instance¬ "P."¬ "PR."¬ "PRI."¬ 
anä  "PRIN.¢  alì  stanä  foò "PRINT"®   Thå worä  "LET¢  iî  LEÔ 
commandó maù alsï bå omitted®  Thå shortesô abbreviationó foò alì 
thå keù wordó arå aó follows:

A.=ABS    C.=CALL   F.=FOR    GOS.=GOSUB     G.=GOTO

IF=IF     I.=INPUT  L.=LIST   LO.=LOAD       N.=NEW

N.=NEXT   P.=PEEK   PO.=POKE  P.=PRINT       REM=REMARK

R.=RETURN R.=RND    R.=RUN    S.=SAVE        S.=SIZE

S.=STEP   S.=STOP   TO=TO

no key word ½ LET

Takå notå that¬  iî somå cases¬ thå samå abbreviatioî caî bå useä 
foò  differenô keù words®   Thå interpreteò ió 'smart§ enougè  tï 
uså  thå  correcô  keù worä  foò  á  particulaò  situation®   Foò 
instance¬  iæ thå abbreviatioî "P.¢ appearó aô thå beginninç oæ á 
line¬  iô caî onlù meaî PRINT®  Iî á statemenô likå "A=P.(8)¢ thå 
"P.¢ onlù makeó senså iæ iô standó foò PEEK.


Erroò Reports:

Therå  arå  onlù threå erroò conditionó iî Tinù BASIC®  Thå  linå 
containinç thå erroò ió printeä ouô witè á questioî marë inserteä 
aô thå poinô wherå thå erroò ió detected.

(1© "What?¢ meanó thaô therå ió aî erroò iî á statement'ó syntax.

For example:

     What?

     260 LET A=B+3, C=(3+4?. X=4

(2©  "How?¢ meanó thaô thå statemenô iî questioî ió OK¬  buô  foò 
somå reasoî thå commanä can'ô bå carrieä out.

     How?

     310 LET A=B*C?+2    <- where B*C is larger than 2147483647

     How?
Š     380 GOTO 412?       <- where line 412 does not exist

(3© "Sorry.¢ meanó thaô thå interpreteò understandó thå statemenô 
anä knowó ho÷ tï dï it¬  buô therå isn'ô enougè memorù  availablå 
tï accomplisè thå task.


Erroò Corrections:

Iæ yoõ noticå aî erroò iî youò entrù beforå yoõ presó RETURN¬ yoõ 
caî  deletå  characteró  witè thå backspacå  (control-H©  keù  oò 
deletå  thå  entirå linå witè control-X®   Tï deletå aî  existinç 
prograí line¬ jusô typå thå linå numbeò anä presó RETURN.




Installation

     Now¬  ho÷  dï  yoõ geô thió wonderful(?© piecå  oæ  softwarå 
runninç  oî  youò computer¿   Verù easily¬  iæ yoõ havå  á  setuğ 
similaò tï mine®   Otheò systemó shoulä alsï bå fairlù easù goinç 
iæ yoõ havå accesó tï á 6800° assembleò oæ somå kind®   Mù  setuğ 
ió  á  Motorolá  MEX68KECÂ Educationaì Computeò  Boarä  connecteä 
betweeî  mù  terminaì anä mù CP/Í system®   Thå sourcå  codå  waó 
assembleä  witè thå Quelï versioî 1.¹ publiã domaiî 6800°  cross-
assembleò foò CP/M®   (Bù thå way¬  iæ yoõ uså thió assembleò yoõ 
wilì geô 3¶ "trim1¶ address¢ errors¬ whicè ió normal®  Yoõ dï geô 
whaô yoõ paù for...©  Tinù BASIÃ ió theî loadeä intï thå ECÂ  anä 
executeä aô thå 'colä start§ addresó oæ heø 900®   BASIÃ programó 
arå  saveä  anä loadeä bù settinç uğ aî appropriatå CP/Í  commanä 
beforå  usinç  SAVÅ  oò  LOAD®    Foò  examplå  (useò  inpuô   ió 
underlined):

     Afteò a prograí ió written¬ exiô tï thå monitor:

          > BYE

     Enteò  transparenô  mode:

          TUTOR 1.x> TM

     Issuå a PIĞ commanä to the CP/M host:

          A> PIP PROGRAM.BAS=CON:

     Exit transparent mode and do a BASIC warm start:

          TUTOR 1.x> GO 904

     Do the actual save:

          SAVE

     Thå  'warí start§ mentioneä abovå ió aî entrù poinô intï thå Šinterpreteò  thaô wilì preservå anù prograí yoõ maù havå  alreadù 
entered.
     Prograí  LOADó arå donå similarlù excepô  that¬  insteaä  oæ 
PIP¬  yoõ  musô  ruî á smalì prograí thaô wilì waiô tï receivå  á 
carriagå returî beforå sendinç thå prograí tï thå ECB®  Herå ió á 
samplå prograí iî Microsofô BASIC:

     10 INPUT "Program to send?";F$

     20 OPEN "I",1,F$

     30 INPUT "Now exit Transparent Mode and do a LOAD.";Z$

     40 WHILE NOT EOF(1):LINE INPUT #1,A$:PRINT A$:WEND


     Admittedlù  thió  waù  oæ LOADinç anä SAVEinç  ió  á  fairlù 
compleø  procedure¬  buô iô allowó yoõ tï keeğ youò  programó  oî 
disë  whilå  keepinç thå interpreteò itselæ small®   Iæ youò  ECÂ 
isn'ô connecteä tï anotheò computeò yoõ coulä probablù changå thå 
AUXIÎ  anä AUXOUÔ subroutineó tï uså thå cassettå  interface®  (É 
haven'ô trieä it¬ though®  Caveaô emptor!)
     Foò  otheò 6800° systems¬  yoõ wilì probablù havå tï  modifù 
onlù thå OUTC¬ INC¬ AUXOUT¬ AUXIN¬ anä BYEBYÅ routineó aô thå enä 
oæ  thå  interpreteò program®   Iî addition¬  yoõ  musô  puô  thå 
addresó oæ thå firsô unavailablå memorù locatioî abovå BASIÃ intï 
thå locatioî 'ENDMEM'®   BASIÃ programó arå SAVEä iî á forí whicè 
caî  bå storeä aó ASCIÉ texô anä reaä bacë quicklù bù thå  68000®  
Iæ  youò storagå devicå can'ô handlå thå presenô formaô oò iæ yoõ 
woulä likå thå prograí saveä iî á human-readablå form¬  yoõ  neeä 
onlù modifù thå SAVÅ anä LOAÄ subroutines.
     Onå  warningº  thå  DIRECÔ  anä EXEÃ routineó  werå  writteî 
assuminç  thaô thå interpreteò itselæ woulä bå somewherå  iî  thå 
firsô 64Ë oæ memorù ($° tï $FFFF)®  Iæ yoõ movå iô abovå 64K¬ yoõ 
wilì  havå  tï modifù thå EXEÃ routinå anä checë thå resô oæ  thå 
codå carefullù tï makå surå thå addressinç modeó arå correct.



Evaluation

     É  aí  quitå pleaseä witè ho÷ thå  interpreteò  turneä  out®  
Eveî thougè É addeä extrá erroò checking¬  loweò caså conversion¬ 
morå  commands¬  anä extendeä thå variablå sizå tï 3²  bits¬  thå 
wholå thinç wilì stilì fiô insidå 3Ë byteó oæ memory®   É raî thå 
Sievå  oæ  Eratostheneó  benchmarë prograí  (includeä  witè  thió 
article© oî thió interpreteò anä oî thå Sherrù Brotheró CP/Í tinù 
BASIÃ witè thå followinç result:

68000 at 4 MHz           Z80 at 4 MHz

2670 seconds             3000 seconds

     Thå  resultó arå adjusteä foò thå usuaì 1° iterationó oæ thå 
basiã  algorithm¬  buô thå prograí waó actuallù onlù ruî foò  onå Šiteratioî tï keeğ runninç timeó withiî á practicaì  limit®   Thió 
tinù  BASIÃ maù noô bå á speeä demon¬  buô iô doeó beaô Applesofô 
anä PEÔ BASIÃ aô runninç thå Sievå benchmark®   É shoulä adä thaô 
thå Sievå prograí listinç waó compresseä tï thå maximuí foò speeä 
considerations®   É normallù uså morå spaceó anä somå commentó sï 
thaô  É caî figurå ouô lateò oî whaô thå prograí waó supposeä  tï 
do!
     Oæ courså therå arå many¬ manù improvementó thaô caî bå madå 
giveî morå availablå memory®   Mù Educationaì Computeò Boarä  haó 
32Ë  byteó oæ memory¬  sï É wilì probablù adä sucè thingó aó morå 
variables¬  strings¬  anä  keyworä tokenization®   Thå lasô ió  á 
methoä useä bù mosô BASIÃ interpreteró tï compresó keù wordó sucè 
aó LET¬  PRINT¬ etc® intï singlå bytes®  Thió woulä greatlù speeä 
uğ  thå  interpreteò whilå usinç lesó memorù tï storå  thå  BASIÃ 
program®  Whï sayó yoõ can'ô havå youò cakå anä eaô iô too?



Availability

     Bù thå timå yoõ reaä this¬  thå interpreteò sourcå codå  anä 
somå  examplå  programó  shoulä bå availablå oî á couplå  oæ  thå 
RCP/Í bulletiî boarä systemó iî mù area:

          Meadowlark RCP/M - (403) 484-5981

          Edmonton RCP/M - (403) 454-6093

     Thå Edmontoî RCP/Í acceptó botè 30° anä 120° baud¬  anä  thå 
Meadowlarë  systeí  onlù allowó accesó tï itó CP/Í areá  aô  120° 
baud®   Botè systemó ruî 2´ houró á day®   Thå interpreteò sourcå 
codå ió knowî aó TBI68K.AQM¬ whicè ió á 'squeezed§ texô file®  Iæ 
yoõ  don'ô havå á MODEM· typå prograí anä á waù tï unsqueezå thió 
file¬  yoõ  caî uså theså systems§ LISÔ commanä tï lisô  ouô  thå 
sourcå  codå  whilå  yoõ  capturå iô  witè  á  telecommunicationó 
program®  Á shorô documentatioî file¬ TBI68K.DQC¬ anä somå samplå 
programs¬ TBIPROGS.LBR¬ arå alsï available®  Thå latteò ió á CP/Í 
librarù file¬  whicè containó severaì programs®  Yoõ caî lisô thå 
libary'ó contentó witè thå LDIÒ command¬  anä extracô  individuaì 
programó usinç eitheò thå systems§ XMODEÍ oò LTYPÅ commands®  Thå 
Quelï  cross-assembleò  ió  alsï  sometimeó  availablå  oî  theså 
systemó undeò thå nameó A68K.COÍ anä A68K.DOC®  
     Thougè  I'ä prefeò thaô yoõ obtaiî thå sourcå codå froí  onå 
oæ thå abovå sources¬  foò $2° É caî alsï providå thå codå iî thå 
followinç  formsº   8-incè CP/Í SSSÄ diskette¬  5-incè Osbornå oò 
Applå CP/Í diskettes¬ oò á papeò listing.
     Iæ  yoõ  finä  anù  bugó iî  thå  interpreteò  oò  havå  anù 
questions¬  pleaså  writå tï må oò contacô må oî thå abovå  RCP/Í 
systems®  Enjoy!
