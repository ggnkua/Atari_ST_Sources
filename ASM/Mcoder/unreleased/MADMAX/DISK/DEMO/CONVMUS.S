LOAD=$80000

	CLR	D6
	LEA	LOAD,A6
	MOVE.L	(A6),D7
	LSR.L	#2,D7
	SUBQ	#1,D7
MAINLOOP:
	MOVE.L	(A6)+,A0
	ADD.L	#LOAD,A0

	CMP.L	#'DIGI',(A0)
	BNE	NOCALCDIG

	CMP.L	#'JOCH',32(A0)
	BEQ.S	NOCALCDIG

	ADDQ	#1,D6
	MOVE.L	#'JOCH',32(A0)
;
; init digit replay
;
	MOVE	62(A0),D1
	BLE	BUG

	MOVE.L	A0,A1
	ADD.L	28(A0),A1
	CLR	D2
	LEA	L4E(PC),A3
L4B:	MOVE.L	A0,A2
	ADD	(A1)+,A2
L1:
	MOVE.B	(A2),D2
	CMP.B	#-1,D2
	BEQ.S	L2
	LSR.B	#4,D2
	MOVE.B	(A3,D2.W),(A2)+
	BRA.S	L1
L2:	MOVE.B	#$88,(A2)+
	SUBQ	#1,D1
	BNE.S	L4B
NOCALCDIG:
	DBRA	D7,MAINLOOP
BUG:	ILLEGAL
L4E:	DC.B	$0D,$0D,$0E,$0E,$0E,$0F,$0F,$0F
	DC.B	$00,$07,$09,$0A,$0B,$0C,$0C,$0D
