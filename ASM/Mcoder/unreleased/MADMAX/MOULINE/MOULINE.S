SOURCE=$80000
DEST=$90000

	LEA	DEST,A6
	LEA	SOURCE+64,A5
	LEA	SOURCE,A4
	ADD	(A5),A4
	MOVE.L	A4,A1
BCL:
	LEA	SOURCE,A0
	ADD	(A5)+,A0
	CMP.L	A1,A0
	BNE.S	ERR
	BSR	TAKEINS
	CMP.L	A4,A5
	BLO.S	BCL
	MOVEQ	#0,D0
	ILLEGAL
ERR:	MOVEQ	#-1,D0
	ILLEGAL

TAKEINS:
BC:
	MOVE.B	(A0)+,D0
	MOVE.B	D0,(A6)+
	CMP.B	#$E1,D0
	BEQ.S	FINI
	CMP.B	#$E0,D0
	BNE.S	BC
	MOVE.B	(A0)+,(A6)+
FINI:
	MOVE.L	A0,A1
	RTS
