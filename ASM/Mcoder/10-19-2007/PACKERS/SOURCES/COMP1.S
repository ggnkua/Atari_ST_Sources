	LINK	A6,#0
	MOVEM.L	D4-D7/A2-A6,-(A7)
	MOVEA.L	8(A6),A0
	MOVEA.L	$C(A6),A1
	MOVE.W	$10(A6),D5
	MOVE.W	$12(A6),D4
	MOVE.W	(A0)+,D7
	MOVE.W	(A0)+,D6
	ADD.W	#$F,D7
	LSR.W	#1,D7
	AND.W	#$FFF8,D7
	CMPA.L	#0,A1
	BNE.S	L3DFD4
	MOVE.L	A0,-(A7)
	MOVE.W	#2,-(A7)
	TRAP	#14
	ADDQ.L	#2,A7
	MOVEA.L	D0,A1
	MOVEA.L	(A7)+,A0
	MOVE.W	#$A0,D0
	CMP.W	D0,D7
	BEQ.S	L3DFD4
	LSR.W	#1,D5
	AND.W	#$FFF8,D5
	ADDA.W	D5,A1
	MULU	D0,D4
	ADDA.W	D4,A1
	MOVEA.L	A1,A3
	ADDA.W	D7,A3
	SUBQ.W	#1,D6
	MULU	D0,D6
	ADD.L	A3,D6
	MOVE.W	D0,D4
	SUB.W	D7,D4
	MOVE.W	D4,D7
	SWAP	D7
	MOVE.W	D0,D7
	BRA.S	L3DFDC
L3DFD4	MULU	D7,D6
	MOVEA.L	A1,A3
	ADDA.L	D6,A3
	MOVE.L	A3,D6
L3DFDC	CLR.L	(A1)
	CLR.L	4(A1)
	MOVEQ	#$F,D0
	MOVEQ	#0,D4
	LEA	L3E18C(PC),A4
	LEA	L3E1CC(PC),A5
	LEA	L3E20C(PC),A6
L3DFF2	MOVE.B	(A0)+,D3
	MOVE.B	D3,D2
	BMI.S	L3E040
	LSR.B	#4,D3
	BEQ.S	L3E074
	AND.W	#$F,D2
	MOVEQ	#1,D1
	ADD.B	D3,D1
L3E004	LSL.W	#3,D2
	MOVEA.L	A6,A2
	ADDA.W	D2,A2
L3E00A	BSR.S	L3E07C
	TST.W	D1
	BEQ.S	L3DFF2
	CMPI.W	#$10,D1
	BCS.S	L3E00A
	MOVE.L	(A2),D3
	MOVE.L	4(A2),D5
	SUBI.W	#$10,D1
L3E020	MOVE.L	D3,(A1)+
	MOVE.L	D5,(A1)+
	CMPA.L	A1,A3
	BNE.S	L3E02C
	BSR	L3E0BE
L3E02C	SUBI.W	#$10,D1
	BCC.S	L3E020
	CLR.L	(A1)
	CLR.L	4(A1)
	ADDI.W	#$10,D1
	BNE.S	L3E00A
	BRA.S	L3DFF2
L3E040	ANDI.W	#$F,D2
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D1
	BTST	#6,D3
	BEQ.S	L3E052
	ASL.W	#8,D1
	MOVE.B	(A0)+,D1
L3E052	ADDQ.W	#1,D1
	BTST	#4,D3
	BEQ.S	L3E004
	BTST	#5,D3
	BEQ	L3E0DA
	MOVEA.L	A1,A2
	SUBA.W	D7,A2
L3E066	BSR.S	L3E07C
	TST.L	D5
	BEQ.S	L3E06E
	MOVEA.L	D5,A2
L3E06E	ADDQ.L	#8,A2
	TST.W	D1
	BNE.S	L3E066
L3E074	BSR	L3E0F2
	BRA	L3DFF2
L3E07C	MOVE.B	D0,D4
	ADD.W	D4,D4
	ADD.W	D4,D4
	MOVE.L	0(A4,D4.W),D3
	CMP.L	D1,D0
	BMI.S	L3E09A
	SUB.W	D1,D0
	MOVE.B	D0,D4
	ADD.W	D4,D4
	ADD.W	D4,D4
	AND.L	0(A5,D4.W),D3
	MOVEQ	#0,D1
	BRA.S	L3E0A0
L3E09A	SUB.W	D0,D1
	SUBQ.W	#1,D1
	MOVEQ	#-1,D0
L3E0A0	MOVE.L	(A2),D5
	AND.L	D3,D5
	OR.L	D5,(A1)+
	MOVE.L	4(A2),D5
	AND.L	D3,D5
	OR.L	D5,(A1)+
	MOVEQ	#0,D5
	TST.W	D0
	BMI.S	L3E0BA
	SUBQ.L	#8,A1
	RTS
L3E0B8	ADDQ.L	#8,A1
L3E0BA	CMPA.L	A1,A3
	BNE.S	L3E0D0
L3E0BE	CMP.L	A1,D6
	BEQ	L3E28C
	ADDA.W	D7,A3
	SWAP	D7
	ADDA.W	D7,A1
	MOVE.L	A2,D5
	ADD.W	D7,D5
	SWAP	D7
L3E0D0	MOVEQ	#$F,D0
	CLR.L	(A1)
	CLR.L	4(A1)
	RTS
L3E0DA	LSR.W	#1,D1
	BCC.S	L3E0E0
	BSR.S	L3E0F2
L3E0E0	MOVE.B	(A0),D2
	LSR.B	#4,D2
	BSR.S	L3E0F2
	MOVE.B	(A0)+,D2
	BSR.S	L3E0F2
	SUBQ.W	#1,D1
	BNE.S	L3E0E0
	BRA	L3DFF2
L3E0F2	CLR.W	D3
	BSET	D0,D3
	ANDI.W	#$F,D2
	ADD.W	D2,D2
	JMP	L3E100(PC,D2.W)
L3E100	BRA.S	L3E12C
	BRA.S	L3E12A
	BRA.S	L3E14E
	BRA.S	L3E126
	BRA.S	L3E15E
	BRA.S	L3E138
	BRA.S	L3E14A
	BRA.S	L3E122
	BRA.S	L3E170
	BRA.S	L3E16E
	BRA.S	L3E17C
	BRA.S	L3E16A
	BRA.S	L3E15A
	BRA.S	L3E134
	BRA.S	L3E146
	OR.W	D3,6(A1)
L3E122	OR.W	D3,4(A1)
L3E126	OR.W	D3,2(A1)
L3E12A	OR.W	D3,(A1)
L3E12C	SUBQ.W	#1,D0
	BMI	L3E0B8
	RTS
L3E134	OR.W	D3,6(A1)
L3E138	OR.W	D3,4(A1)
	OR.W	D3,(A1)
	SUBQ.W	#1,D0
	BMI	L3E0B8
	RTS
L3E146	OR.W	D3,6(A1)
L3E14A	OR.W	D3,4(A1)
L3E14E	OR.W	D3,2(A1)
	SUBQ.W	#1,D0
	BMI	L3E0B8
	RTS
L3E15A	OR.W	D3,6(A1)
L3E15E	OR.W	D3,4(A1)
	SUBQ.W	#1,D0
	BMI	L3E0B8
	RTS
L3E16A	OR.W	D3,2(A1)
L3E16E	OR.W	D3,(A1)
L3E170	OR.W	D3,6(A1)
	SUBQ.W	#1,D0
	BMI	L3E0B8
	RTS
L3E17C	OR.W	D3,6(A1)
	OR.W	D3,2(A1)
	SUBQ.W	#1,D0
	BMI	L3E0B8
	RTS
L3E18C	DC.W	1,1,3,3
	DC.W	7,7,$F,$F
	DC.W	$1F,$1F,$3F,$3F
	DC.W	$7F,$7F,$FF,$FF
	DC.W	$1FF,$1FF,$3FF,$3FF
	DC.W	$7FF,$7FF,$FFF,$FFF
	DC.W	$1FFF,$1FFF,$3FFF,$3FFF
	DC.W	$7FFF,$7FFF,$FFFF,$FFFF
L3E1CC	DC.W	$FFFE,$FFFE,$FFFC,$FFFC
	DC.W	$FFF8,$FFF8,$FFF0,$FFF0
	DC.W	$FFE0,$FFE0,$FFC0,$FFC0
	DC.W	$FF80,$FF80,$FF00,$FF00
	DC.W	$FE00,$FE00,$FC00,$FC00
	DC.W	$F800,$F800,$F000,$F000
	DC.W	$E000,$E000,$C000,$C000
	DC.W	$8000,$8000,0,0
L3E20C	DC.W	0,0,0,0
	DC.W	$FFFF,0,0,0
	DC.W	0,$FFFF,0,0
	DC.W	$FFFF,$FFFF,0,0
	DC.W	0,0,$FFFF,0
	DC.W	$FFFF,0,$FFFF,0
	DC.W	0,$FFFF,$FFFF,0
	DC.W	$FFFF,$FFFF,$FFFF,0
	DC.W	0,0,0,$FFFF
	DC.W	$FFFF,0,0,$FFFF
	DC.W	0,$FFFF,0,$FFFF
	DC.W	$FFFF,$FFFF,0,$FFFF
	DC.W	0,0,$FFFF,$FFFF
	DC.W	$FFFF,0,$FFFF,$FFFF
	DC.W	0,$FFFF,$FFFF,$FFFF
	DC.W	$FFFF,$FFFF,$FFFF,$FFFF
L3E28C
	ADDQ	#4,A7
	RTS
