;
; MOINS PERFORMANT QUE DU HUFFMANN
;
; (gestion de transfert de WORDS)
;
	LINK	A6,#0
	MOVEM.L	D4-5/A2-3,-(A7)
	MOVEA.L	8(A6),A3
	MOVEA.L	$14(A6),A1
	MOVEA.L	$C(A6),A0
	MOVE.L	$10(A6),D4
	MOVEQ	#0,D3
	MOVEQ	#$F,D1
	MOVEQ	#8,D0
L1DA98	SUBQ.L	#1,D4
	BMI	L1DAE6

	MOVEQ	#1,D5
	BSR.S	L1DAD0		;LIT 4 BITS
	CMP.W	D0,D2
	BPL.S	L1DAB2		;SI <8
	MOVEQ	#1,D5		;ON LIT 4 BITS
	BSR.S	L1DAD2
	ADD.W	D2,D2
	MOVE.W	0(A3,D2.W),(A1)+
	BRA.S	L1DA98
L1DAB2	CMP.W	D1,D2
	BEQ.S	L1DAC8
	MOVEQ	#2,D5
	BSR.S	L1DAD2
	SUB.L	#$780,D2
	ADD.W	D2,D2
	MOVE.W	0(A3,D2.W),(A1)+
	BRA.S	L1DA98
L1DAC8	MOVEQ	#4,D5
	BSR.S	L1DAD0
	MOVE.W	D2,(A1)+
	BRA.S	L1DA98
L1DAD0	CLR.W	D2
L1DAD2	SWAP	D2
L1DAD4	SUBQ.W	#1,D3
	BPL.S	L1DADC
	MOVEQ	#3,D3
	MOVE.W	(A0)+,D2
L1DADC	LSL.L	#4,D2
	SUBQ.W	#1,D5
	BNE.S	L1DAD4
	SWAP	D2
	RTS
L1DAE6	MOVEM.L	(A7)+,D4-5/A2-3
	UNLK	A6
	RTS
	RTS
