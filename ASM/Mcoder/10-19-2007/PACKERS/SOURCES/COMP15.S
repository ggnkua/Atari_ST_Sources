	OPT	O+

	MOVE.L	4(A7),A5	;BASE PAGE
	MOVE.L	12(A5),D0	;TAILLE TEXT
	ADD.L	20(A5),D0	;TAILLE DATA
	ADD.L	28(A5),D0	;TAILLE BSS
	ADD.L	#$708,D0
	BCLR	#0,D0
	LEA	-$68(A5,D0.L),A7
	MOVE.L	D0,-(A7)
	PEA	(A5)
	CLR	-(A7)
	MOVE	#$4A,-(A7)	;SETBLOCK
	TRAP	#1
	LEA	12(A7),A7

	LEA	L1F3FE(PC),A3
	MOVE	#$A,(A3)+
	CLR	(A3)+
	MOVE	#1,(A3)+
	CLR	(A3)+
	CLR	(A3)
	MOVE.L	#L1F3D2,D1
	MOVE	#$C8,D0
	TRAP	#2
	MOVE	L1F720(PC),L1F39A

	LEA	L1F3FE(PC),A3
	MOVE	#$4D,(A3)+
	CLR	(A3)+
	MOVE	#5,(A3)+
	CLR	(A3)+
	CLR	(A3)
	MOVE.L	#L1F3D2,D1
	MOVE	#$C8,D0
	TRAP	#2

	LEA	L1F720(PC),A3
	LEA	L1F416(PC),A4
	MOVE.L	(A3)+,(A4)+
	MOVE.L	(A3)+,(A4)+
	MOVE	(A3),(A4)
	LEA	L1F3FE(PC),A3
	MOVE	#$64,(A3)
	CLR	2(A3)
	MOVE	#$B,6(A3)
	MOVE	L1F416(PC),$C(A3)
	LEA	L1F420(PC),A4
	LEA	L1F3B4(PC),A3
	MOVEQ	#$A,D3
L1D8D4	MOVE	(A3)+,(A4)+
	DBRA	D3,L1D8D4
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2

	LEA	L1FB20(PC),A4
	LEA	L1F720(PC),A3
	MOVEQ	#$2C,D3
L1D8F4	MOVE	(A3)+,(A4)+
	DBRA	D3,L1D8F4
	LEA	L1F820(PC),A3
	MOVEQ	#$B,D3
L1D902	MOVE	(A3)+,(A4)+
	DBRA	D3,L1D902
	MOVE	L1F40A(PC),L1F414
	LEA	L1F3FE(PC),A3
	MOVE	#$20,(A3)
	CLR	2(A3)
	MOVE	#1,6(A3)
	MOVE	L1F416(PC),$C(A3)
	MOVE	#1,L1F420
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2

	LEA	L1F3FE(PC),A3
	MOVE	#$6A,(A3)
	CLR	2(A3)
	MOVE	#1,6(A3)
	MOVE	L1F416(PC),$C(A3)
	CLR	L1F420
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2

	BSR.S	L1D9B0		;main

	LEA	L1F3FE(PC),A3
	MOVE	#$65,(A3)
	CLR	2(A3)
	CLR	6(A3)
	MOVE	L1F414(PC),$C(A3)
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2

	LEA	L1F3FE(PC),A3
	MOVE	#$13,(A3)+
	CLR	(A3)+
	MOVE	#1,(A3)+
	CLR	(A3)+
	CLR	(A3)
	MOVE.L	#L1F3D2,D1
	MOVE	#$C8,D0
	TRAP	#2

	CLR	-(A7)		;RETOUR AU BUREAU
	TRAP	#1

L1D9B0
	MOVE	#$19,-(A7)	;GET CURRENT DISK
	TRAP	#1
	ADDQ	#2,A7
	ADD.B	#$41,D0
	MOVE.B	D0,L1FB92

	CLR.L	L1FBBA
	BSR	L1DB94
	MOVE	D1,L1FBFC
	MOVE	D0,L1FBFA
	BEQ	L1DEEC		;GENERAL ERROR
	MOVE	D1,D0
	BEQ	L1DAD6		;ATTEND PRESSION
L1DA7A
	MOVEQ	#0,D0
	MOVE.B	L1FB92(PC),D0
	SUB.B	#$41,D0
	MOVE	D0,-(A7)
	MOVE	#$E,-(A7)	;SET DRIVE
	TRAP	#1
	ADDQ	#4,A7
	LEA	L1FB92(PC),A0
L1DBFA	CMP.B	#'*',(A0)+
	BNE.S	L1DBFA
	CLR.B	-(A0)
	PEA	L1FB94(PC)
	MOVE	#$3B,-(A7)	;CHDIR
	TRAP	#1
	ADDQ	#6,A7

	CLR	-(A7)
	PEA	L1FBBA(PC)
	MOVE	#$4E,-(A7)	;SEARCH FIRST
	TRAP	#1
	ADDQ	#8,A7
	TST	D0
	BMI	L1DF3A

	LEA	L1FC20(PC),A0
	MOVE	#$BE,(A0)+
	MOVE	#$50,(A0)+
	MOVE	#$1C2,(A0)+
	MOVE	#$78,(A0)

	MOVE	#$2F,-(A7)	;GET DTA
	TRAP	#1
	ADDQ	#2,A7
	MOVE.L	D0,A0
	MOVE.L	$1A(A0),L1FC38	;NB OCTETS DU FICHIER

	MOVE.L	L1FC38(PC),D0
	ADD.L	#$1000,D0
	MOVE.L	D0,-(A7)
	MOVE	#$48,-(A7)
	TRAP	#1
	ADDQ	#6,A7
	TST.L	D0
	BMI	L1DFCE
	MOVE.L	D0,L1FC40

	CLR	-(A7)
	PEA	L1FBBA(PC)
	MOVE	#$3D,-(A7)	;OPEN
	TRAP	#1
	ADDQ	#8,A7
	TST	D0
	BMI	L1EB00
	MOVE	D0,L1FC36
	MOVE.L	L1FC40(PC),-(A7)
	MOVE.L	L1FC38(PC),-(A7)
	MOVE	L1FC36(PC),-(A7)
	MOVE	#$3F,-(A7)	;READ
	TRAP	#1
	LEA	$C(A7),A7
	TST.L	D0
	BPL.S	L1E40C
	MOVE	L1FC36(PC),-(A7)
	MOVE	#$3E,-(A7)	;CLOSE
	TRAP	#1
	ADDQ	#4,A7
	BRA	L1EB00

L1E40C	MOVE	L1FC36(PC),-(A7)
	MOVE	#$3E,-(A7)		;CLOSE
	TRAP	#1
	ADDQ	#4,A7
	MOVE.L	L1FC40(PC),A0
	MOVE.L	$A(A0),L1FC3C		;TAILLE BSS

	BSR	L1E460
	BSR	L1E100
	BSR	L1E6A4
	BSR	L1EBC2
L1EB00:
	MOVE.L	L1FC40(PC),-(A7)	;MFREE
	MOVE	#$49,-(A7)
	TRAP	#1
	ADDQ	#6,A7
L1DA7B:	RTS

L1DAD6	MOVEQ	#-1,D0			;ATTEND APPUI SUR BOUTON
L1DADA	DBRA	D0,L1DADA
	LEA	L1F3FE(PC),A3
	MOVE	#$7C,(A3)
	CLR	2(A3)
	CLR	6(A3)
	MOVE	L1F416(PC),$C(A3)
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2
	MOVE	L1F720(PC),D0
	BEQ.S	L1DAD6
	MOVE	L1F820(PC),D1
	MOVE	L1F820+2(PC),D2
	RTS

L1DB20	NOT	L1E0D2
	BNE.S	L1DB62
	LEA	L1F3FE(PC),A3		;PASSE 2
	MOVE	#$7A,(A3)
	CLR	2(A3)
	MOVE	#1,6(A3)
	MOVE	L1F416(PC),$C(A3)
	LEA	L1F420(PC),A3
	CLR	(A3)
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2
	RTS
L1DB62	LEA	L1F3FE(PC),A3		;PASSE 1
	MOVE	#$7B,(A3)
	CLR	2(A3)
	CLR	6(A3)
	MOVE	L1F416(PC),$C(A3)
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2
	RTS

L1DB94	LEA	L1F3FE(PC),A3		;FILESELECT
	MOVE	#$5A,(A3)+
	CLR	(A3)+
	MOVE	#2,(A3)+
	MOVE	#2,(A3)+
	CLR	(A3)
	LEA	L1F920(PC),A3
	MOVE.L	#L1FB92,(A3)+
	MOVE.L	#L1FBBA,(A3)
	MOVE.L	#L1F3D2,D1
	MOVE	#$C8,D0
	TRAP	#2
	MOVE	L1F720(PC),D0
	MOVE	L1F720+2(PC),D1
	RTS

L1DEEC	LEA	L1FC20(PC),A0
	MOVE	#$E8,(A0)+
	MOVE	#$BE,(A0)+
	MOVE	#$198,(A0)+
	MOVE	#$D2,(A0)+
	MOVE.L	#L1DF20,L1FC16
	MOVE	#$F0,L1FC12
	MOVE	#$CD,L1FC14
	BRA	L1E064
L1DF3A	LEA	L1FC20(PC),A0
	MOVE	#$F0,(A0)+
	MOVE	#$BE,(A0)+
	MOVE	#$192,(A0)+
	MOVE	#$D2,(A0)
	MOVE.L	#L1DF6E,L1FC16
	MOVE	#$100,L1FC12
	MOVE	#$CD,L1FC14
	BRA	L1E064
L1DF80	LEA	L1FC20(PC),A0
	MOVE	#$D2,(A0)+
	MOVE	#$BE,(A0)+
	MOVE	#$1AE,(A0)+
	MOVE	#$D2,(A0)
	MOVE.L	#L1DFB4,L1FC16
	MOVE	#$E0,L1FC12
	MOVE	#$CD,L1FC14
	BRA.S	L1E064
L1DFCE	LEA	L1FC20(PC),A0
	MOVE	#$E8,(A0)+
	MOVE	#$BE,(A0)+
	MOVE	#$198,(A0)+
	MOVE	#$D2,(A0)
	MOVE.L	#L1E002,L1FC16
	MOVE	#$A8,L1FC12
	MOVE	#$CD,L1FC14
	BRA.S	L1E064
L1E018	LEA	L1FC20(PC),A0
	MOVE	#$DC,(A0)+
	MOVE	#$BE,(A0)+
	MOVE	#$1A4,(A0)+
	MOVE	#$D2,(A0)
	MOVE.L	#L1E04C,L1FC16
	MOVE	#$E8,L1FC12
	MOVE	#$CD,L1FC14
L1E064	LEA	L1F3FE(PC),A3
	MOVE	#8,(A3)
	MOVE	#1,2(A3)
	MOVE	#$7F,6(A3)
	MOVE	L1F416(PC),$C(A3)
	LEA	L1F420(PC),A3
	MOVE.L	L1FC16(PC),A4
	MOVEQ	#$7E,D3
L1E092	MOVE.B	(A4)+,(A3)+
	DBEQ	D3,L1E092
	SUB	D3,L1F404
	LEA	L1F520(PC),A3
	MOVE	L1FC12(PC),(A3)+
	MOVE	L1FC14(PC),(A3)
	MOVE.L	#L1F3EA,D1
	MOVEQ	#$73,D0
	TRAP	#2
	BSR	L1DAD6
	MOVEQ	#0,D0
	RTS

L1E100	BSR	L1E34E
	MOVE.L	L1FC40(PC),A0
	MOVE.L	L1FC40(PC),A1
	LEA	$1000(A0),A0
	MOVE.L	A0,D7
	ADD.L	L1FC38(PC),D7
L1E122	CMP.L	A0,D7
	BLO	L1E29C
	MOVE.B	(A0),D0
	CMP.B	1(A0),D0
	BNE.S	L1E196
	CMP.B	2(A0),D0
	BNE.S	L1E196
	CMP.B	L20094+1(PC),D0
	BEQ.S	L1E172
	CMP.B	3(A0),D0
	BNE.S	L1E196
	MOVEQ	#0,D1
L1E14E	CMP.B	(A0),D0
	BNE.S	L1E162
	ADDQ	#1,A0
	ADDQ	#1,D1
	CMP.B	#$FE,D1
	BNE.S	L1E14E
L1E162	MOVE.B	L20096+1(PC),(A1)+
	MOVE.B	D0,(A1)+

	SUBQ.B	#1,D1		;COMPTEUR-1 POUR GAGNER DES CYCLES !!!

	MOVE.B	D1,(A1)+
	BRA.S	L1E122
L1E172	MOVEQ	#0,D1
L1E174	CMP.B	(A0),D0
	BNE.S	L1E188
	ADDQ	#1,A0
	ADDQ	#1,D1
	CMP.B	#$FE,D1
	BEQ.S	L1E188
	BRA.S	L1E174
L1E188	MOVE.B	L20098+1(PC),(A1)+

	SUBQ.B	#1,D1		;COMPTEUR-1 POUR GAGNER DES CYCLES !!!

	MOVE.B	D1,(A1)+
	BRA.S	L1E122
L1E196	MOVEQ	#2,D1
L1E198	CMP.B	0(A0,D1.W),D0
	BEQ.S	L1E1AC
L1E1A0	ADDQ	#1,D1
	CMP.B	#$30,D1
	BNE.S	L1E198
	BRA.S	L1E22A
L1E1AC	MOVE.L	A0,A2
	MOVEQ	#1,D3
	ADD.L	D1,A2
L1E1B2	MOVE.L	A0,A3
	MOVE.L	D1,D2
	ADDQ.L	#1,D2
L1E1B8	SUBQ.L	#1,D2
	BEQ.S	L1E1C6
	CMP.B	(A2)+,(A3)+
	BNE.S	L1E1E2
	BRA.S	L1E1B8
L1E1C6	ADDQ.L	#1,D3
	CMP.B	#$FF,D3
	BEQ.S	L1E1E2
	MOVE.L	A0,A3
	MOVE.L	D1,D4
	MULU	D3,D4
	ADD.L	D4,A3
	ADD.L	D1,A3
	CMP.L	A3,D7
	BHI.S	L1E1B2
L1E1E2
	CMP.L	#2,D3
	BHI.S	L1E1FE
	CMP.L	#1,D3
	BLS.S	L1E1A0
	CMP.B	#2,D1
	BLS.S	L1E1A0
L1E1FE
	MOVE.B	L2009A+1(PC),(A1)+

	SUBQ.B	#1,D1		;COMPTEUR-1 POUR GAGNER DES CYCLES !!!
	MOVE.B	D1,(A1)+
	ADDQ.B	#1,D1

	SUBQ.B	#1,D3		;COMPTEUR-1 POUR GAGNER DES CYCLES !!!
	MOVE.B	D3,(A1)+
	ADDQ.B	#1,D3

	MOVE.L	D1,D2
	MOVE.L	A0,A2
L1E20C	MOVE.B	(A2)+,(A1)+
	SUBQ.L	#1,D2
	BNE.S	L1E20C
	AND.L	#$FF,D1
	AND.L	#$FF,D3
	MULU	D1,D3
	ADD.L	D3,A0
	BRA	L1E122
L1E22A	CMP.B	L20096+1(PC),D0
	BEQ.S	L1E26A
	CMP.B	L20098+1(PC),D0
	BEQ.S	L1E26A
	CMP.B	L2009A+1(PC),D0
	BEQ.S	L1E26A
	MOVE.B	(A0)+,(A1)+
	BRA	L1E122
L1E26A	MOVEQ	#0,D1
	CMP.B	1(A0),D0
	BNE.S	L1E28A
	ADDQ.L	#1,D1
	CMP.B	2(A0),D0
	BNE.S	L1E28A
	ADDQ	#1,D1
	CMP.B	3(A0),D0
	BNE.S	L1E28A
	ADDQ	#1,D1
L1E28A	ADDQ	#1,D1
	MOVE.B	L20096+1(PC),(A1)+
	MOVE.B	D0,(A1)+

	SUBQ.B	#1,D1		;COMPTEUR-1 POUR GAGNER DES CYCLES !!!

	MOVE.B	D1,(A1)+
	ADDQ.B	#1,D1

	ADD.L	D1,A0
	BRA	L1E122
L1E29C	MOVE.L	A1,D0
	BTST	#0,D0
	BEQ.S	L1E2A8
	ADDQ	#1,A1
L1E2A8	MOVE.L	A1,L1FC28
	SUB.L	L1FC40(PC),A1
	MOVE.L	A1,A0
	MOVE.L	A0,L200AC
	MOVE.L	A0,L1F0E0
	RTS

L1E34E	MOVE.L	L1FC40(PC),A0
	LEA	$1000(A0),A1
	ADD.L	L1FC38(PC),A0
	ADD.L	L1FC38(PC),A1
	ADDQ	#1,A0
	ADDQ	#1,A1
	MOVE.L	L1FC38(PC),D0
	ADDQ.L	#1,D0
L1E37C	MOVE.B	-(A0),-(A1)
	SUBQ.L	#1,D0
	BNE.S	L1E37C
	RTS

L1E460	LEA	L1FC44(PC),A0
	MOVE	#$FF,D0
L1E46C	CLR.L	(A0)+
	DBRA	D0,L1E46C
	BSR	L1E5F0
	BSR	L1E626
	MOVE.L	D1,L20084
	MOVE	D2,L20094
	BSR	L1E654
	MOVE.L	D1,L20088
	MOVE	D2,L20096
	BSR	L1E654
	MOVE.L	D1,L2008C
	MOVE	D2,L20098
	BSR	L1E654
	MOVE.L	D1,L20090
	MOVE	D2,L2009A
	RTS

L1E5F0	MOVE	#$FF,D0
	LEA	L1FC44(PC),A1
L1E5FC	CLR.L	(A1)+
	DBRA	D0,L1E5FC
	MOVE.L	L1FC40(PC),A0
	LEA	L1FC44(PC),A1
	MOVE.L	L1FC38(PC),D0
L1E610	MOVEQ	#0,D1
	MOVE.B	(A0)+,D1
	ADD	D1,D1
	ADD	D1,D1
	ADDQ.L	#1,0(A1,D1.W)
	SUBQ.L	#1,D0
	BNE.S	L1E610
	RTS

L1E626	LEA	L1FC44(PC),A0
	MOVE	#$FF,D0
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVE.L	(A0),D1
L1E63A	CMP.L	(A0),D1
	BHS.S	L1E644
	MOVE.L	(A0),D1
	MOVE.B	D3,D2
L1E644	ADDQ	#4,A0
	ADDQ	#1,D3
	DBRA	D0,L1E63A
	RTS

L1E654	LEA	L1FC44(PC),A0
	MOVE	#$FF,D0
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVE.L	(A0),D1
L1E668	CMP.L	(A0),D1
	BLS.S	L1E672
	MOVE.L	(A0),D1
	MOVE.B	D3,D2
L1E672	ADDQ	#4,A0
	ADDQ	#1,D3
	DBRA	D0,L1E668
	LEA	L1FC44(PC),A0
	MOVEQ	#0,D3
	MOVE	D2,D3
	ADD.L	D3,D3
	ADD.L	D3,D3
	ADD.L	D3,A0
	MOVE.L	#$FFFFFFFF,(A0)
	RTS

L1E6A4	BSR	L1DB20
	MOVE.L	L1FC38(PC),D7
	MOVE.L	L200AC(PC),L1FC38
	BSR	L1E5F0
	MOVE.L	D7,L1FC38
	LEA	L1FC44(PC),A0
	LEA	L200B0(PC),A1
	MOVEQ	#0,D0
L1E6D0	CLR	(A1)+
	CLR	(A1)+
	CLR	(A1)+
	MOVE	D0,(A1)+
	MOVE.L	(A0)+,(A1)+
	ADDQ.L	#1,D0
	CMP	#$200,D0
	BLO.S	L1E6D0
	MOVE	#$100,D0
	LEA	L200B0(PC),A0
	BSR	L1EA92
	LEA	L200B0(PC),A0
	MOVEQ	#0,D0
L1E6FA	TST.L	8(A0)
	BEQ.S	L1E710
	LEA	$C(A0),A0
	ADDQ	#1,D0
	BRA.S	L1E6FA
L1E710	MOVE	D0,L200AA
	MOVE	D0,L200A8
L1E71C	CMP	#1,D0
	BEQ.S	L1E734
	LEA	L200B0(PC),A0
	BSR	L1EA92
	BSR	L1E9FC
	BRA.S	L1E71C

L1E734	MOVE.L	#L200B0,L200A4
	LEA	L23170(PC),A0
	MOVEQ	#$17,D0
L1E748	CLR.B	(A0)+
	DBRA	D0,L1E748

	BSR.S	L1E802

	MOVEQ	#1,D7
	LEA	L200B0(PC),A0
	LEA	L1F0F6(PC),A1
	MOVEQ	#1,D0
	BSR.S	L1E784		;SAUVE L'ARBRE DE HUFFMANN CODE
CARRY2	ADD.B	D7,D7
	BCC.S	CARRY2
	MOVE.B	D7,(A1)+
	BRA	L1DB20

L1E784	SUBQ	#1,D0
	MULU	#$C,D0
	LEA	0(A0,D0.L),A2
	TST	(A2)
	BEQ.S	L1E7B8
	ADD.B	D7,D7
	BSET	#0,D7
	BCC.S	L1E8001
	MOVE.B	D7,(A1)+
	MOVEQ	#1,D7
L1E8001	PEA	(A2)
	MOVE	2(A2),D0
	BSR.S	L1E784
	MOVE.L	(A7)+,A2
	MOVE	4(A2),D0
	BRA.S	L1E784

L1E7B8	ADD.B	D7,D7
	BCC.S	L1E8002
	MOVE.B	D7,(A1)+
	MOVEQ	#1,D7
L1E8002	MOVE.B	7(A2),D2
	ADD.B	D2,D2
	BSET	#0,D2
L1E7C6	ADDX.B	D7,D7
	BCC.S	L1E8003
	MOVE.B	D7,(A1)+
	MOVEQ	#1,D7
L1E8003	ADD.B	D2,D2
	BNE.S	L1E7C6
	RTS

L1E802	MOVEQ	#1,D0
	LEA	L23170(PC),A0
	BSR	L1E940

	BSR	L1E8B4
	MOVE.L	L1FC40(PC),A1
	LEA	$1000(A1),A0
	MOVE.L	L200AC(PC),D0
	MOVEQ	#1,D1
L1E822	MOVEQ	#0,D2
	MOVE.B	(A0)+,D2
	MULU	#$18,D2
	LEA	L21910(PC),A2
	ADD	D2,A2
L1E834	MOVE.B	(A2)+,D2
	BEQ.S	L1E85E
	ADD.B	D2,D2
	ADDX.B	D1,D1
	BCC.S	L1E834
	MOVE.B	D1,(A1)+
	MOVEQ	#1,D1
	BRA.S	L1E834
L1E85E	SUBQ.L	#1,D0
	BNE.S	L1E822

CARRY3	ADD.B	D1,D1
	BCC.S	CARRY3
	MOVE.B	D1,(A1)+

	MOVE.L	A1,L2009C
	MOVE.L	L1FC40(PC),A0
	SUB.L	A0,A1
	MOVE.L	A1,L200A0
	RTS
L1E8B4	MOVE.L	L1FC40(PC),A0
	LEA	$1001(A0),A1
	ADD.L	L200AC(PC),A0
	ADDQ	#1,A0
	ADD.L	L200AC(PC),A1
	MOVE.L	L200AC(PC),D0
	ADDQ.L	#4,D0
L1E8DC	MOVE.B	-(A0),-(A1)
	SUBQ.L	#1,D0
	BNE.S	L1E8DC
	RTS

L1E940	SUBQ	#1,D0
	MULU	#$C,D0
	LEA	L200B0(PC),A1
	ADD.L	D0,A1
	TST	(A1)
	BEQ.S	L1E97C
	PEA	(A1)
	MOVE.B	#$01,(A0)+	;<>0 ET BIT 7=0
	MOVE	2(A1),D0
	BSR.S	L1E940
	MOVE.L	(A7)+,A1
	CLR.B	-(A0)
	MOVE.B	#$80,(A0)+	;<>0 ET BIT 7=1
	MOVE	4(A1),D0
	BSR.S	L1E940
	CLR.B	-(A0)
	RTS
L1E97C	LEA	L21910(PC),A2
	MOVE	6(A1),D0
	MULU	#$18,D0
	ADD.L	D0,A2
	MOVE	6(A1),$16(A2)
	LEA	L23170(PC),A3
L1E998	MOVE.B	(A3)+,(A2)+
	BNE.S	L1E998
	RTS

L1E9FC	ADDQ	#1,L200A8
	LEA	L200B0(PC),A1
	MOVE	L200A8(PC),D2
	SUBQ	#1,D2
	MULU	#$C,D2
	ADD.L	D2,A1
	MOVE	D0,D1
	SUBQ	#2,D1
	MULU	#$C,D1
	LEA	L200B0(PC),A2
	ADD.L	D1,A2
	MOVE.L	(A2),(A1)
	MOVE.L	4(A2),4(A1)
	MOVE.L	8(A2),8(A1)
	MOVE	L200A8(PC),2(A2)
	MOVE	D0,4(A2)
	LEA	$C(A2),A1
	MOVE.L	8(A1),D2
	ADD.L	D2,8(A2)
	MOVE	#$FFFF,(A2)
	SUBQ	#1,D0
	RTS
L1EA92	MOVEM.L	D0-D7/A0-A6,-(A7)
	MOVE	D0,D1
L1EAA0	LSR	#1,D1
	BEQ.S	L1EB06
	MOVE	D1,D2
L1EAAA	CMP	D2,D0
	BLS.S	L1EAA0
	MOVE.L	D2,D3
	SUB	D1,D3
L1EAB4	BLO.S	L1EAFE
	MOVE	D3,D4
	MULU	#$C,D4
	MOVE.L	A0,A1
	ADD.L	D4,A1
	MOVE.L	A1,A2
	MOVE	D1,D4
	MULU	#$C,D4
	ADD.L	D4,A2
	MOVE.L	8(A1),D5
	CMP.L	8(A2),D5
	BHS.S	L1EAFE
	MOVE.L	(A1),D5
	MOVE.L	(A2),(A1)
	MOVE.L	D5,(A2)
	MOVE.L	4(A1),D5
	MOVE.L	4(A2),4(A1)
	MOVE.L	D5,4(A2)
	MOVE.L	8(A1),D5
	MOVE.L	8(A2),8(A1)
	MOVE.L	D5,8(A2)
	SUB	D1,D3
	BRA.S	L1EAB4
L1EAFE	ADDQ	#1,D2
	BRA.S	L1EAAA
L1EB06	MOVEM.L	(A7)+,D0-D7/A0-A6
	RTS

L1EBC2	BSR	L1EDBE
L1EBC6	MOVEQ	#0,D0
	MOVE	#$19,-(A7)
	TRAP	#1
	ADDQ	#2,A7
	MOVE	D0,-(A7)
	LEA	L1FB92(PC),A0
	ADD.B	#$41,D0
	MOVE.B	D0,(A0)+
	MOVE.B	#$3A,(A0)+
	MOVE.L	A0,-(A7)
	MOVE	#$47,-(A7)
	TRAP	#1
	ADDQ	#8,A7
	CLR.L	L1FBBA
	LEA	L1FB92(PC),A0
L1EBF8	TST.B	(A0)+
	BNE.S	L1EBF8
	MOVE.B	#'\',-1(A0)
	MOVE.B	#'*',(A0)+
	MOVE.B	#'.',(A0)+
	MOVE.B	#'*',(A0)+
	CLR.B	(A0)
	BSR	L1DB94
	TST	D0
	BEQ.S	L1EC30
	TST	D1
	BEQ.S	L1EC30
	BSR	L1ED36
	TST	D0
	BEQ.S	L1EBC6
	BRA.S	L1EC56
L1EC30	RTS
L1EC56	LEA	L1FB92(PC),A0
L1EC5C	CMP.B	#'*',(A0)+
	BNE.S	L1EC5C
	CLR.B	-(A0)
	PEA	L1FB92(PC)
	MOVE	#$3B,-(A7)
	TRAP	#1
	ADDQ	#6,A7
	BSR	L1ED16
	TST	D0
	BEQ.S	L1ED08
	PEA	L1EE32(PC)
	PEA	(L1F396-L1EE32).W
	MOVE	L1FC36(PC),-(A7)
	MOVE	#$40,-(A7)
	TRAP	#1
	LEA	$C(A7),A7
	TST.L	D0
	BMI	L1E018
	MOVE.L	L200A0(PC),D1
	BTST	#0,D1
	BEQ.S	L1ECB6
	ADDQ.L	#1,D1
L1ECB6	MOVE.L	L1FC40(PC),-(A7)
	MOVE.L	D1,-(A7)
	MOVE	L1FC36(PC),-(A7)
	MOVE	#$40,-(A7)
	TRAP	#1
	LEA	$C(A7),A7
	TST.L	D0
	BMI	L1E018
	PEA	L1ED0A(PC)
	PEA	8.W
	MOVE	L1FC36(PC),-(A7)
	MOVE	#$40,-(A7)
	TRAP	#1
	LEA	$C(A7),A7
	TST.L	D0
	BMI	L1E018
	MOVE	L1FC36(PC),-(A7)
	MOVE	#$3E,-(A7)
	TRAP	#1
	ADDQ	#4,A7
L1ED08	RTS
L1ED16	CLR	-(A7)
	PEA	L1FBBA(PC)
	MOVE	#$3C,-(A7)
	TRAP	#1
	ADDQ	#8,A7
	TST.L	D0
	BMI	L1E018
	MOVE	D0,L1FC36
	RTS
L1ED36	LEA	L1FB92(PC),A0
	MOVEQ	#0,D0
	MOVE.B	(A0),D0
	SUB.B	#$41,D0
	MOVE	D0,-(A7)
	MOVE	#$E,-(A7)
	TRAP	#1
	ADDQ	#4,A7
	MOVE.L	L1FC40(PC),A0
	MOVE.L	L2009C(PC),A1
	SUB.L	A0,A1
	MOVE.L	A1,D7
	ADD.L	#L1F396-L1EE32+6,D7
	LSR.L	#8,D7		;/$400=2^10
	LSR.L	#2,D7
	CLR	-(A7)
	PEA	L1EDAA(PC)
	MOVE	#$36,-(A7)
	TRAP	#1
	ADDQ	#8,A7
	CMP.L	L1EDAA(PC),D7
	BHI	L1DF80
	MOVEQ	#-1,D0
	RTS

L1EDBE	MOVE.B	L20096+1(PC),OCTET1+1
	MOVE.B	L20098+1(PC),OCTET2+1
	MOVE.B	L2009A+1(PC),OCTET3+1
	MOVE.B	L20094+1(PC),OCTET4+1
	MOVE.L	L1FC38(PC),L1F0DC

	MOVE.L	#L1F396-L1EE32-$1C,L1EE34	;SET TEXT LENGTH
	MOVE.L	L200A0(PC),D0
	BTST	#0,D0
	BEQ.S	L1EE10
	ADDQ.L	#1,D0
L1EE10	MOVE.L	D0,L1EE38			;SET DATA LENGTH
	MOVE.L	L200AC(PC),A1
	MOVE.L	L1FC38(PC),A0
	SUB.L	A1,A0
	ADD.L	L1FC3C(PC),A0
	MOVE.L	A0,L1EE3C			;SET BSS LENGTH
	RTS

L1ED0A	DC.B	0,0,0,$E,0,0,0,0
	DC.B	0,0,0,0
L1EDAA	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0
L1E0D2	DC.W	0

L1DF20	DC.B	'A GENERAL ERROR OCCURS !',0
L1DF6E	DC.B	'FILE NOT FOUND !',0
L1DFB4	DC.B	'NOT ENOUGH DISK-SPACE !!',0
L1E002	DC.B	'NOT ENOUGH MEMORY !',0
L1E04C	DC.B	"CAN'T SAVE THE FILE !!",0
L1FB92	DC.B	'A:'
L1FB94	DC.B	'*.*',0
	DS.B	42

	EVEN
;
; ENTETE DU PROGRAMME
;
L1EE32	BRA.S	L1EE4E		;$601A
L1EE34	DC.L	0
L1EE38	DC.L	0
L1EE3C	DC.L	0
	DC.L	0,0,0
	DC.W	$FFFF

L1EE4E	MOVE.L	4(A7),A5
	MOVE.L	$18(A5),D0
	MOVEM.L	D0-D7/A0-A6,-(A7)
	LEA	L1F364(PC),A6
	MOVE.L	A5,(A6)
	LEA	L1F0E4(PC),A0
	MOVE.L	A7,(A0)

	MOVE.L	$18(A5),A0
	LEA	L1F0EC(PC),A6
	MOVE.L	$14(A5),(A6)
	ADD.L	$1C(A5),A0
	LEA	$2000(A0),A0
	LEA	-$1388/8*4(A7),A7
	LEA	L1F0F0(PC),A6
	MOVE.L	A7,(A6)
	LEA	-$A(A7),A7

	MOVE	#$8000,D7
	LEA	L1F0F6(PC),A5
	MOVEQ	#0,D6
	MOVE.L	L1F0F0(PC),A1
	BSR	L1F286		;COLLECTE LES CODES DE HUFFMANN
				;A PARTIR DE A1
	MOVE.L	L1F364(PC),A0
	MOVE.L	$10(A0),A2
	MOVE.L	$14(A0),D0
	LEA	0(A2,D0.L),A1
	MOVE.L	L1F0DC(PC),D1
	ADD.L	D1,A2
	LSR.L	#3,D1
	ADD.L	D1,A2
	ADDQ	#1,A2
	ADDQ	#1,A1
	MOVE.L	D0,D1
	SWAP	D1
L1F35C	MOVE.B	-(A1),-(A2)
	DBRA	D0,L1F35C
	DBRA	D1,L1F35C

	MOVE.L	L1F0EC(PC),A3
	LEA	2(A3,A2.L),A3
	MOVE.L	A2,A5
	LEA	L1F396(PC),A4

	CMP.L	A5,A3
	BLS.S	L1F094

	MOVE.L	L1F0F0(PC),A1
	MOVE	(A1)+,D0

	MOVE	#$8000,D7
	MOVE.L	A5,D1
	BTST	#0,D1
	BEQ.S	L1F05F		;ACCELERATION DE LA ROUTINE
	MOVE.B	(A5)+,D7
	ROL	#8,D7
L1F05F	MOVE.L	A1,A2
	MOVE	D0,D1
L1F060	ADD	D7,D7
	BNE.S	TSTCARY1
	MOVE	(A5)+,D7
	ADDX	D7,D7
TSTCARY1
	BCS.S	L1F07C
	MOVEQ	#2,D1
L1F07C	ADD	D1,A2
	MOVE	(A2)+,D1
	BNE.S	L1F060
	MOVE.B	(A2),(A4)+
	CMP.L	A5,A3
	BHI.S	L1F05F
L1F094
	MOVE.L	L1F364(PC),A0
	MOVE.L	$10(A0),D0
	MOVE.L	L1F0E0(PC),$14(A0)
	ADD.L	$14(A0),D0
	MOVE.L	D0,$18(A0)
	MOVE.L	L1F0E4(PC),A7
	MOVEM.L	(A7)+,D0-D7/A0-A6
	MOVE.L	$18(A5),D0
	ADD.L	$1C(A5),D0
	ADD.L	#$101,D0
	MOVE.L	D0,A3
	MOVE.L	D0,A2
	MOVE.L	$18(A5),A4
	MOVE.L	$14(A5),D0
	SUBQ.L	#1,D0
	MOVE.L	D0,D1
	SWAP	D1
L1EE74	MOVE.B	-(A4),-(A3)
	DBRA	D0,L1EE74
	DBRA	D1,L1EE74

	MOVE.L	$10(A5),A4

OCTET1	MOVEQ	#0,D4
OCTET2	MOVEQ	#0,D5
OCTET3	MOVEQ	#0,D6
OCTET4	MOVEQ	#0,D7

L1EE82	MOVE.B	(A3)+,D0
	CMP.B	D4,D0
	BEQ.S	L1EEA6
	CMP.B	D5,D0
	BEQ.S	L1EEBA
	CMP.B	D6,D0
	BEQ.S	L1EECE
	MOVE.B	D0,(A4)+
	CMP.L	A3,A2
	BHS.S	L1EE82
	BRA.S	L1EEFA
L1EEA6	MOVEQ	#0,D0
	MOVE.B	(A3)+,D1
	MOVE.B	(A3)+,D0
L1EEB2	MOVE.B	D1,(A4)+
	DBRA	D0,L1EEB2
	CMP.L	A3,A2
	BHS.S	L1EE82
	BRA.S	L1EEFA
L1EEBA
	MOVEQ	#0,D0
	MOVE.B	(A3)+,D0
L1EEC6	MOVE.B	D7,(A4)+
	DBRA	D0,L1EEC6
	CMP.L	A3,A2
	BHS.S	L1EE82
	BRA.S	L1EEFA
L1EECE
	MOVEQ	#0,D2
	MOVE.B	(A3)+,D2
	MOVEQ	#0,D1
	MOVE.B	(A3)+,D1
L1EEDA	MOVE	D2,D0
	MOVE.L	A3,A1
L1EEE4	MOVE.B	(A1)+,(A4)+
	DBRA	D0,L1EEE4
	DBRA	D1,L1EEDA
	MOVE.L	A1,A3
	CMP.L	A3,A2
	BHS.S	L1EE82
L1EEFA
	MOVE.L	$10(A5),A3
	MOVE.L	2(A3),A0
	ADD.L	6(A3),A0
	LEA	$1C(A0,A3.L),A0
	MOVE.L	8(A5),D0
	MOVE.L	(A0)+,D1
	BEQ.S	L1EF4E
	MOVE.L	$10(A5),A1
	LEA	$1C(A1,D1.L),A1
	MOVEQ	#0,D1
L1EF4A	ADD	D1,A1
L1EF2E	ADD.L	D0,(A1)
L1EF30	MOVE.B	(A0)+,D1
	BEQ.S	L1EF4E
	CMP.B	#1,D1
	BNE.S	L1EF4A
	LEA	$FE(A1),A1
	BRA.S	L1EF30
L1EF4E	MOVE.L	$10(A5),A0
	LEA	$1C(A0),A6
	ADDQ	#2,A0
	MOVE.L	8(A5),D0
	MOVE.L	(A0)+,D1
	MOVE.L	D1,$C(A5)
	ADD.L	D1,D0
	MOVE.L	D0,$10(A5)
	MOVE.L	(A0)+,D1
	MOVE.L	D1,$14(A5)
	ADD.L	D1,D0
	MOVE.L	D0,$18(A5)
	MOVE.L	(A0),$1C(A5)

	LEA	L1F380-L1F368(A7),A0
	MOVE.L	A0,A2
	LEA	L1F380(PC),A1
	MOVEQ	#(L1F368-L1F380)/2-1,D0
L1EFA8	MOVE	(A1)+,(A0)+
	DBRA	D0,L1EFA8
	MOVE.L	4(A7),A5
	MOVE.L	$18(A5),A0
	MOVE.L	$C(A5),D0
	ADD.L	$14(A5),D0
	LSR.L	#2,D0
	ADDQ.L	#1,D0
	MOVE.L	D0,D1
	SWAP	D1
	LEA	$100(A5),A5
	MOVE.L	A5,A4
	LEA	FINPILE-L1F368(A7),A1
	JMP	(A2)
;
; BOUT DE CODE DEPLACANT LE PROGRAMME
;
L1F380	MOVE.L	(A6)+,(A5)+	;2
	DBRA	D0,L1F380	;4
	DBRA	D1,L1F380	;4
L1F38E	CLR.L	(A0)+		;2
	CMP.L	A1,A0		;2
FINPILE	BLO.S	L1F38E		;2
	JMP	(A4)		;2
L1F368
;
; ROUTINE RECURSIVE
;
L1F286
	LEA	0(A1,D6.W),A0

	ADD	D7,D7
	BNE.S	TSTCARY2
	MOVE	(A5)+,D7
	ADDX	D7,D7
TSTCARY2
	BCC.S	L1F2D2

	ADDQ	#4,D6		;MARQUAGE D'UNE BRANCHE
	PEA	(A0)		;A0 POINTE SUR LA FEUILLE DE DROITE
	BSR.S	L1F286
	MOVE.L	(A7)+,A0
	ADDQ	#4,D6
	MOVE.L	A1,D0
	ADD.L	D6,D0		;A1+D6
	SUB.L	A0,D0
	SUBQ	#2,D0
	MOVE	D0,(A0)		;POINTE SUR LA FEUILLE DE GAUCHE
	BRA.S	L1F286

L1F2D2	CLR	(A0)+		;MARQUE UN NOEUD TERMINAL
	MOVEQ	#1,D2
L1F2EE	ADD	D7,D7
	BNE.S	TSTCARY3
	MOVE	(A5)+,D7
	ADDX	D7,D7
TSTCARY3
	ADDX.B	D2,D2
	BCC.S	L1F2EE
	MOVE.B	D2,(A0)		;ET STOCKE SA VALEUR
	RTS

L1F0DC	DS.L	1		;TAILLE DU CODE
L1F364	DC.L	0		;SAVE BASE PAGE
; TOUS LES SUIVANTS SONT PLEINS DE 0
L1F0E0	DC.L	0		;TAILLE CODE ??
L1F0E4	DC.L	0		;ADRESSE PILE ???
L1F0EC	DC.L	0
L1F0F0	DC.L	0
L1F0F6	DS.B	$200-$70	;AVEC $00
L1F396
; FIN DU TRANSFERT

L1F39A	DC.B	0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0,0,0,0,0
L1F3B4	DC.B	0,1
	DC.B	0,1,0,1,0,1,0,1
	DC.B	0,1,0,1,0,1,0,1
	DC.B	0,1,0,2

L1F3D2	DC.L	L1F3FE,L1F396
	DC.L	L1F420,L1F720,L1F920,L1FA20
L1F3EA	DC.L	L1F3FE,L1F420,L1F520,L1F720
	DC.L	L1F820

L1F3FE	DC.B	0,0,0,0,0,0
L1F404	DC.B	0,0,0,0,0,0
L1F40A	DC.B	0,0,0,0
	DC.B	0,0,0,0,0,0
L1F414	DC.B	0,0
L1F416	DC.B	0,0,0,0,0,0,0,0
	DC.B	0,0
	SECTION	BSS
L1F420	DS.B	256
L1F520	DS.B	512
L1F720	DS.B	256
L1F820	DS.B	256
L1F920	DS.B	256
L1FA20	DS.B	256
L1FB20	DS.B	$92-$20
L1FBBA	DS.B	$40
L1FBFA	DS.B	2
L1FBFC	DS.B	2
L1FBFE	DS.B	$18-$E
L1FC08	DS.B	$12-$08
L1FC12	DS.B	2
L1FC14	DS.B	2
L1FC16	DS.B	$20-$16
L1FC20	DS.B	8
L1FC28	DS.L	1		;0
L1FC2C	DS.L	1		;0
L1FC36	DS.B	2
L1FC38	DS.L	1		;0
L1FC3C	DS.L	1		;0
L1FC40	DS.B	4
L1FC44	DS.L	$110		;0
L20084	DS.B	4
L20088	DS.B	4
L2008C	DS.B	4
L20090	DS.B	4
L20094	DS.B	2
L20096	DS.B	2
L20098	DS.B	2
L2009A	DS.B	2
L2009C	DS.L	1		;0
L200A0	DS.L	1		;0
L200A4	DS.L	1		;0
L200A8	DS.W	1		;0
L200AA	DS.W	1		;0
L200AC	DS.L	1		;0
L200B0	DS.B	$1860		;0
L21910	DS.B	$1860		;0
L23170	DS.B	$18		;0
L23188	DS.L	1		;0
