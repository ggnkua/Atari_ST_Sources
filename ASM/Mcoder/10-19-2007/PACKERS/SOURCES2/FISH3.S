	BRA.S	RELOAD
RELOAD2:
	MOVE.B	D1,NUMBER
RELOAD1:
	MOVE.B	D0,NUMBER+1
RELOAD:
	CLR.W	-(A7)
	PEA	FILE(PC)
	MOVE.W	#$3D,-(A7)
	TRAP	#1
	ADDQ.L	#8,A7
	TST.L	D0
	BMI	ERREUR
	MOVE.W	D0,-(A7)
	PEA	LOAD
	PEA	$FFFFF
	MOVE.W	D0,-(A7)
	MOVE.W	#$3F,-(A7)
	TRAP	#1
	LEA	$C(A7),A7
	MOVE.W	#$3E,-(A7)
	TRAP	#1
	ADDQ.L	#4,A7

	BSR	FISH3

	CLR	-(SP)		;BASSE RESOLUTION
	PEA	-1.W
	PEA	-1.W
	MOVE	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP

	CLR.L	-(A7)
	MOVE.W	#$20,-(A7)
	TRAP	#1
	ADDQ.W	#6,A7
	MOVE.L	D0,-(A7)
	LEA	PALETTE-8,A0
	LEA	$FFFF8240,A1
	MOVEQ	#8-1,D0
L26148:	MOVE.L	(A0)+,(A1)+
	DBF	D0,L26148
	MOVE.W	#$20,-(A7)
	TRAP	#1
	ADDQ.W	#6,A7
	LEA	L2BEE4,A0
	LEA	$78000,A1
;
; 1 PIXEL=4 BITS
;
	MOVE	#32000/8-1,D7
COPY:
	MOVEQ	#8-1,D6
	CLR.L	(A1)
	CLR.L	4(A1)
	MOVE	#$8000,D4
PUT0:
	MOVE.B	(A0),D0
	LSR	#4,D0
	BSR	PUT
	MOVE.B	(A0)+,D0
	BSR	PUT
	DBRA	D6,PUT0
	ADDQ	#8,A1
	DBRA	D7,COPY

	MOVE	#7,-(SP)
	TRAP	#1
	ADDQ	#2,SP

	MOVE.B	NUMBER+1,D0
	ADDQ.B	#1,D0
	CMP.B	#'F'+1,D0
	BEQ.S	NXTL1

	CMP.B	#'9'+1,D0
	BNE	RELOAD1
	MOVEQ	#'A',D0
	BRA	RELOAD1
NXTL1:
	MOVEQ	#'0',D0
	MOVE.B	NUMBER,D1
	ADDQ.B	#1,D1
	CMP.B	#'2',D1
	BNE	RELOAD2
ERREUR:
	CLR	-(SP)
	TRAP	#1

PUT:	LSR	#1,D0
	BCC.S	PAPL0
	OR	D4,(A1)
PAPL0:	LSR	#1,D0
	BCC.S	PAPL1
	OR	D4,2(A1)
PAPL1:	LSR	#1,D0
	BCC.S	PAPL2
	OR	D4,4(A1)
PAPL2:	LSR	#1,D0
	BCC.S	PAPL3
	OR	D4,6(A1)
PAPL3:	LSR	#1,D4
	RTS

FILE:
	DC.B	'B:FISH.'
NUMBER:	DC.B	'02',0
	EVEN


FISH3:
	LEA	LOAD+$3E,A5
	MOVE.L	(A5),D0
	LEA	LOAD+$42,A1
	MOVE.L	A1,A2
	LEA	LOAD+$3C,A3
	ADDA.W	(A3),A2
	ADDA.W	(A3),A2
	ADDQ.L	#2,A2
	LEA	LOAD,A0
	LEA	PALETTE-$24,A3
	MOVEQ	#$3B,D2
L20756:	MOVE.B	(A0)+,(A3)+
	DBF	D2,L20756
	LEA	L2BEE4,A0
	LEA	LOAD+$3C,A5
	MOVE.W	#$FF,D4
	MOVE.W	#$7F,D5
	MOVE.B	(A2)+,D3
	MOVEQ	#7,D6
L20778:	MOVE.W	(A5),D7
L2077A:	LSL.W	#1,D7
	BTST	D6,D3
	BNE.S	L20786
	MOVE.B	1(A1,D7.W),D7
	BRA.S	L2078A
L20786:	MOVE.B	0(A1,D7.W),D7
L2078A:	SUBQ.W	#1,D6
	BPL.S	L20792
	MOVE.B	(A2)+,D3
	MOVEQ	#7,D6
L20792:	AND.W	D4,D7
	TST.B	D7
	BPL.S	L2077A
	AND.B	D5,D7
	MOVE.B	D7,(A0)+
	SUBQ.L	#1,D0
	BNE.S	L20778
	MOVE.L	#LOAD+$442,A1
	MOVE.L	A1,A2
	ADDA.L	#$7D00,A2
L207B0:	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CLR.L	(A1)+
	CMPA.L	A1,A2
	BNE.S	L207B0
	MOVE.L	#PALETTE-$24,A0
	MOVE.L	#LOAD+$442,A1
	CLR.L	D5
	MOVE.W	(A0)+,D0
	MOVE.W	(A0),L6688
	MOVE.W	(A0)+,D5
	MOVE.W	(A0),L6686
	MOVE.W	(A0)+,D6
	MOVE.W	(A0),L6684
	MOVE.W	(A0)+,D7
	MOVE.W	D7,D3
	TST.B	L6471
	BNE.S	L20814
	LSL.W	#1,D3
	ADD.W	L649A,D3
	CMPI.W	#$13A,D3
	BMI.S	L20822
	MOVE.W	#$13A,D3
	BRA.S	L20822
L20814:	ADD.W	L649A,D3
	CMPI.W	#$9D,D3
	BMI.S	L20822
	MOVE.W	#$9D,D3
L20822:	MOVE.W	D3,L66DE
	CMP.W	L6470,D3
	BHI.S	L20830
	MOVE.W	D3,L6470
L20830:	MOVE.L	#L2BEE4,A0
	MOVE.W	D5,D1
	ROR.L	#1,D5
	ADDA.W	D5,A1
	SWAP	D5
	MOVE.W	#$F,D0
	LSR.W	D0,D5
	MOVE.W	D6,D3
	SUB.W	D1,D3
	MOVE.W	#$140,D4
	SUB.W	D3,D4
	BTST	#0,L6685
	BEQ.S	L2085A
	ADDQ.W	#1,D4
L2085A:	LSR.W	#1,D4
	MOVE.W	D4,A2
	CLR.W	D1
	MOVE.W	D3,A4
	SUBQ.W	#1,A4
	MOVE.W	D5,A3
	SUBA.W	A2,A1
L20868:	ADDA.W	A2,A1
	MOVE.W	A4,D3
	MOVE.W	A3,D5
L2086E:	TST.B	D1
	BEQ.S	L20882
	SUBQ.W	#1,D1
	BCHG	#0,D5
	BNE.S	L2087E
	OR.B	D0,(A1)
	BRA.S	L2089C
L2087E:	OR.B	D2,(A1)+
	BRA.S	L2089C
L20882:	MOVE.B	(A0)+,D6
	CMPI.B	#$10,D6
	BPL.S	L20894
	MOVE.B	D6,D0
	LSL.B	#4,D0
	MOVE.B	D6,D2
	MOVEQ	#1,D1
	BRA.S	L2086E
L20894:	MOVE.B	D6,D1
	SUBI.B	#$10,D1
	BRA.S	L2086E
L2089C:	DBF	D3,L2086E
	SUBQ.W	#1,D7
	BNE.S	L20868
	MOVE.L	#LOAD+$442,A0
	MOVE.L	A0,A1
	CLR.W	(A0)
	ADDA.L	#$7C60,A1
	LEA	$A0(A0),A2
L208BA:	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	MOVE.L	(A0)+,D2
	EOR.L	D2,(A2)+
	CMPA.L	A1,A0
	BMI.S	L208BA
	MOVE.L	#PALETTE-$24,A0
	MOVE.W	6(A0),D0
	MOVE.W	D0,D1
	MULU	#$A0,D1
	MOVE.L	#LOAD+$442,A1
	MOVE.L	A1,A2
	ADDA.W	D1,A2
	ADDQ.W	#4,A2
	MOVE.L	#L2BEE4,A0
	MOVE.L	A0,A3
	ADDA.L	#$7D04,A0
L2090E:	MOVE.L	-(A2),-(A0)
	CMPA.L	A2,A1
	BNE.S	L2090E
L20914:	CMPA.L	A0,A3
	BEQ	L20920
	CLR.L	-(A0)
	BRA	L20914
L20920:	RTS

BLK	MACRO
	DS.\0	\1
	ENDM

	SECTION	BSS
L6684:	BLK.B	1
L6685:	BLK.B	1
L6686:	BLK.B	2
L6688:	BLK.B	2
L66DE:	BLK.B	2
L649A:	BLK.B	2
L6470:	BLK.B	1
L6471:	BLK.B	1
	EVEN
	BLK.B	300
PALETTE:
	BLK.B	32		;2BE70
	BLK.B	100
ECRAN:
L2BEE4:	BLK.B	50000
LOAD:
;	BLK.B	32000		;3FB4E

