L40002	;SUITE DU CODE
L401D8	;???
L40258	;???
L40BC8	;???
;
	MOVE.W	#2,-(A7)
	TRAP	#14
	ADDQ.L	#2,A7
	MOVEA.L	D0,A1
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	LEA	L40258(PC),A0
	MOVE.W	#$A0,D7
	MOVE.W	#$C8,D6
	MULU	D7,D6
	MOVEA.L	A1,A3
	ADDA.L	D6,A3
	MOVE.L	A3,D6
	CLR.L	(A1)
	CLR.L	4(A1)
	MOVEQ	#$F,D0
	MOVEQ	#0,D4
	LEA	L40BC8(PC),A6
	MOVEA.W	A6,A4
	MOVEA.W	A6,A5
	ADDA.L	#$40,A5
	MOVEM.L	A4-A5,-(A7)
	MOVEQ	#0,D3
	MOVE.W	#$FFFF,D3
	MOVEQ	#$F,D2
L400B6	ADD.L	D3,D3
	MOVE.W	D3,(A5)+
	MOVE.W	D3,(A5)+
	SWAP	D3
	MOVE.W	D3,(A4)+
	MOVE.W	D3,(A4)+
	SWAP	D3
	DBF	D2,L400B6
	MOVEM.L	(A7)+,A4-A5
	LEA	L401D8(PC),A6
L400D0	MOVE.B	(A0)+,D3
	MOVE.B	D3,D2
	BMI.S	L400EE
	ANDI.W	#$F,D2
	LSR.B	#4,D3
	MOVEQ	#1,D1
	ADD.B	D3,D1
L400E0	LSL.W	#3,D2
	MOVEA.L	A6,A2
	ADDA.W	D2,A2
L400E6	BSR.S	L40120
	TST.W	D1
	BNE.S	L400E6
	BRA.S	L400D0
L400EE	ANDI.W	#$F,D2
	MOVEQ	#0,D1
	MOVE.B	(A0)+,D1
	BTST	#6,D3
	BEQ.S	L40100
	ASL.W	#8,D1
	MOVE.B	(A0)+,D1
L40100	ADDQ.W	#1,D1
	BTST	#4,D3
	BEQ.S	L400E0
	MOVEA.L	A1,A2
	SUBA.W	D7,A2
L4010C	BSR.S	L40120
	TST.L	D5
	BEQ	L40116
	MOVEA.L	D5,A2
L40116	ADDQ.L	#8,A2
	TST.W	D1
	BNE.S	L4010C
	BSR.S	L4017C
	BRA.S	L400D0
L40120	MOVE.B	D0,D4
	LSL.W	#2,D4
	MOVE.L	0(A4,D4.W),D3
	CMP.W	D1,D0
	BMI.S	L4013A
	SUB.W	D1,D0
	MOVE.B	D0,D4
	LSL.W	#2,D4
	AND.L	0(A5,D4.W),D3
	MOVEQ	#0,D1
	BRA.S	L40142
L4013A	SUB.W	D0,D1
	SUBQ.W	#1,D1
	MOVEQ	#$FF,D0
L40142	MOVE.L	(A2),D5
	AND.L	D3,D5
	OR.L	D5,(A1)
	MOVE.L	4(A2),D5
	AND.L	D3,D5
	OR.L	D5,4(A1)
	MOVEQ	#0,D5
L40154	TST.W	D0
	BPL.S	L4017A
	ADDQ.L	#8,A1
	CMPA.L	A1,A3
	BNE.S	L40170
	CMP.L	A1,D6
	BEQ	L40002
	ADDA.W	D7,A3
	SWAP	D7
	ADDA.W	D7,A1
	MOVE.L	A2,D5
	ADD.W	D7,D5
	SWAP	D7
L40170	MOVEQ	#$F,D0
	CLR.L	(A1)
	CLR.L	4(A1)
L4017A	RTS
L4017C	BTST	#3,D0
	BNE.S	L401AC
	BTST	#0,D2
	BEQ.S	L4018C
	BSET	D0,1(A1)
L4018C	BTST	#1,D2
	BEQ.S	L40196
	BSET	D0,3(A1)
L40196	BTST	#2,D2
	BEQ.S	L401A0
	BSET	D0,5(A1)
L401A0	BTST	#3,D2
	BEQ.S	L401D2
	BSET	D0,7(A1)
	BRA.S	L401D2
L401AC	BTST	#0,D2
	BEQ.S	L401B4
	BSET	D0,(A1)
L401B4	BTST	#1,D2
	BEQ.S	L401BE
	BSET	D0,2(A1)
L401BE	BTST	#2,D2
	BEQ.S	L401C8
	BSET	D0,4(A1)
L401C8	BTST	#3,D2
	BEQ.S	L401D2
	BSET	D0,6(A1)
L401D2	SUBQ.W	#1,D0
	BRA	L40154
