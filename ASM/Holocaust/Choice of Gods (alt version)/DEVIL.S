;************************************************************************
;
;                             DEVIL'S BALLS
;
;************************************************************************
;
; Code by Zappy/Holocaust with Elric sprites routy...
;
; Les fontes sont TRES vieilles, je les ai dessinÇes avant de savoir 
; programmer en assembleur...
;
; Mais? Oh! De la 3D en full!      ( Ahem... )
;
; C'est träs mal programmÇ. En refaisant la routine de 3D, je gagnais
; 70 lignes de temps machine. Probläme: je suis flemmard. Donc...
;
;

X	EQU	3
Y	EQU	40
NB_DECAL	EQU	8
NB_DEC	EQU	1
PAS	EQU	15*6

NB_SPR	EQU	7


DEBUT:	MOVEA.L  A7,A5
	LEA.L 	D_PILE,A7
	MOVE.L 	4(A5),A5
	MOVE.L 	$C(A5),D0
	ADD.L 	$14(A5),D0
	ADD.L 	$1C(A5),D0
	ADD.L 	#$100,D0		
	MOVE.L 	D0,-(SP)		
	MOVE.L 	A5,-(SP)
	MOVE 	#0,-(SP)
	MOVE 	#$4A,-(SP)
	TRAP 	#1
	LEA 	12(SP),SP

	PEA	0.W
	MOVE.W	#$20,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP	

	move.l	#1,d0
	jsr	ZIK

	CLR.W	-(SP)
	PEA	-1.W
	PEA	-1.W
	MOVE.W	#5,-(SP)
	TRAP	#14
	LEA	12(SP),SP
	
	MOVE.L	#DATA,DATAPNT

	MOVE.L	#FIN,$008.W
	MOVE.L	#FIN,$00C.W
	MOVE.L	#FIN,$010.W

	MOVEQ	#0,D0
	LEA	COD_COG,A0
	LEA	TAB_COG,A1
	MOVE	#118,D1	118
	MOVE.L	A0,(A1)+
LM	MOVE	(A0)+,D0
	CMPI	#$4E75,D0
	BNE.S	LM
	MOVE.L	A0,(A1)+
	DBF	D1,LM

	MOVE.L	#BUFFER_FULL,GOUZI
	MOVE.L	#BUFFERSCR,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN1
	MOVE.L	D0,SCREEN1_BALLS
	MOVE.L	D0,SCREEN
	MOVE.L	D0,SCR1
	ADDQ.L	#8,SCR1
	ADD.L	#345*256,D0
	MOVE.L	D0,SCREEN2
	MOVE.L	D0,SCREEN2_BALLS
	MOVE.L	D0,SCREENA
	MOVE.L	D0,SCR2
	BSR	MAK_COD
	LEA	COURB,A0
	LEA	FIN_CRB,A1
	MOVE.L	-12(A1),-12(A0)
	MOVE.L	-8(A1),-8(A0)
	MOVE.L	-4(A1),-4(A0)	
	MOVE.W	#((PAS/6)*NB_SPR)-2,D7
RECOP1	MOVE.L	(A0)+,(A1)+
	MOVE.W	(A0)+,(A1)+
	DBRA	D7,RECOP1
	MOVE.L	#-1,(A1)
	MOVE.L	#COURB,PNT_CRB

	MOVE.B	$FFFFFA07.W,MFP1
	MOVE.B	$FFFFFA09.W,MFP2
	MOVE.B	$FFFFFA0F.W,MFP3
	MOVE.B	$FFFFFA13.W,MFP4
	MOVE.B	$FFFFFA1B.W,MFP5
	MOVE.B	$FFFFFA21.W,MFP6
	MOVE.B	$FFFFFA15.W,MFP7
	MOVE.B	$FFFFFA17.W,MFP8
	MOVE.B	$FFFFFA19.W,MFP9
	MOVE.B	$FFFFFA1F.W,MFP10

	MOVE.L	$68.W,SAUVE_HBL
	MOVE.L	$134.W,SAUVE_TMA
	MOVE.L	#INTER_RTE,$68.W

	CLR.B	$FFFFFA07.W
	CLR.B	$FFFFFA09.W
	CLR.B	$FFFFFA13.W
	CLR.B	$FFFFFA15.W

	MOVE.B	#$12,$FFFFFC02.W
;	DC.W	$A00A

	ANDI.B	#%11111000,$484.W

	MOVEM.L	$FFFF8240.W,D0-D7
	MOVEM.L	D0-D7,ANC_PAL

	LEA	TEXTE,A0
	MOVE.L	A0,MEM_LET
	MOVE	#1,PART_AFF

	LEA	PIC+34,A0
	LEA	TAB_COG,A1
	MOVE.L	(A1),A1
	MOVEM.L	(A1),D0-D7
	JSR	8*4(A1)
	LEA	TAB_COG+4,A1
	MOVE.L	A1,SAVE_A1_COG

	MOVE.L	$70.W,ANC_VBL
	MOVE.L	#VBLR,$70.W

	CLR.B	$FFFFFA1B.W
	BSET	#0,$FFFFFA07.W
	BSET	#0,$FFFFFA13.W

JUMP	BRA.S	JUMP

	MOVE.L	#VBL_ZIK,$70.W
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
	MOVEM.L	D0-D7,$FFFF8240.W

	MOVE.L	#DATA,DATAPNT
	MOVE.L	#COURB,PNT_CRB
	MOVE.L	#BUFFER_FULL,GOUZI
	MOVE.L	#BUFFERSCR,D0
	CLR.B	D0
	MOVE.L	D0,SCREEN1
	MOVE.L	D0,SCREEN1_BALLS
	MOVE.L	D0,SCREEN
	MOVE.L	D0,SCR1
	ADDQ.L	#8,SCR1
	ADD.L	#345*256,D0
	MOVE.L	D0,SCREEN2
	MOVE.L	D0,SCREEN2_BALLS
	MOVE.L	D0,SCREENA
	MOVE.L	D0,SCR2
	MOVE.B	SCREEN2+1,$FFFF8201.W
	MOVE.B	SCREEN2+2,$FFFF8203.W
	LEA	BUFFERSCR,A5
	MOVE.L	#(345*256*2)/4,D7
CLS_ALL	CLR.L	(A5)+
	DBF	D7,CLS_ALL
	clr.l	PNT	
	clr.l	PNT2
	MOVE.L	#-8,VALUE	
	MOVE.L	#-8,VALUE2	
	CLR.L	TIME
	CLR.L	TIME2
	CLR.L	TIME2B
	CLR.L	PNT_FAD_B
	CLR.L	PNT_FAD_B2
	CLR.L	PLUS
	CLR.L	PLUS3
	CLR.L	FLAG
	MOVE	#$60FE,JUMP
	MOVE.L	#VBLR,$70.W
	BRA	JUMP
SAVE_A1_COG	DC.L	0
TIME	DC.L	0
TIME2	DC.L	0
TIME2B	DC.L	0
VBLR
	MOVE.L	#8,$140.W	6
	SF	$FFFF8240.W
	CLR.B	$FFFFFA1B.W
	CLR	$FFFF8240.W
;	MOVE.B	#1,$FFFFFA21.W
;	MOVE.B	#8,$FFFFFA1B.W

	MOVE.B	#0,$FFFFFA19.W		; PREPARATION DU MFP POUR LE
	MOVE.B	#99,$FFFFFA1F.W		; BORDER HAUT
	MOVE.B	#4,$FFFFFA19.W
	BCLR	#3,$FFFFFA17.W
	MOVE.L	#INTER_TMA,$134.W
	ORI.B	#$20,$FFFFFA13.W
	ORI.B	#$20,$FFFFFA07.W

	CLR.L	PLUS3
	ADD.L	#8,VALUE
	ADDQ.L	#1,TIME
	CMPI.L	#29440,VALUE
	BNE.S	MLML
	CLR.L	VALUE
	MOVE	#$4E71,JUMP
	MOVE.L	#-29440,PLUS3
MLML
	MOVE.L	VALUE,D0
	MOVE.L	SCR2,D1
	MOVE.L	D1,SCREEN2_BALLS
	ADD.L	D0,SCREEN2_BALLS

	MOVE.L	VALUE,D0
	SUBQ.L	#8,D0
	MOVE.L	SCR2,D1
	MOVE.L	D1,SCREEN2_EFF
	ADD.L	D0,SCREEN2_EFF

	MOVE.L	DATAPNT,A1	*5
	CMPI.L	#-1,(A1)	*5
	BNE.S	OK2		*3 AVEC D   SINON 2
	MOVE.L	#DATA,DATAPNT	*7
	MOVE.L	DATAPNT,A1	*5
OK2
	MOVE.L	(A1)+,PLUS
	MOVE.L	(A1)+,A0	*3

	MOVE.L	PLUS,D0
	ADD.L	D0,SCREEN1
	MOVE.L	PLUS3,D0
	ADD.L	D0,SCREEN1

	MOVE.B  SCREEN2+1,$FFFF8201.W
	MOVE.B  SCREEN2+2,$FFFF8203.W

	JSR	AFF_FNT

;	MOVEM.L	PIC+2,D0-D7
;	MOVEM.L	D0-D7,$FFFF8240.W
;	MOVE	#$556,$FFFF8250.W

	CMPI.L	#(29440/4)-8*4,TIME
;	CMPI.L	#50*5,TIME
	BLE.S	LAB1

	LEA	PAL_BALLS2,A6
	LEA	MODIF_COLORS1,A5
	ADDA.L	PNT_FAD_B2,A6
	CMPI	#-1,(A6)
	BEQ	NO_ADD
	ADDQ.L	#1,TIME2B
	CMPI.L	#4,TIME2B
	BNE	NO_ADD
	CLR.L	TIME2B
	ADD.L	#32,PNT_FAD_B2
	MOVE.L	2(A6),2(A5)
	MOVE.L	2+4(A6),16(A5)
	MOVE.L	2+4*2(A6),16+8(A5)
	MOVE.L	2+4*3(A6),16+8*2(A5)
	MOVE.L	2+4*4(A6),16+8*3(A5)
	MOVE.L	2+4*5(A6),16+8*4(A5)
	MOVE.L	2+4*6(A6),16+8*5(A5)
	MOVE	2+4*7(A6),16+8*6(A5)
	BRA.S	NO_ADD
	
LAB1	LEA	PAL_BALLS,A6
	LEA	MODIF_COLORS1,A5
	ADDA.L	PNT_FAD_B,A6
	CMPI	#-1,(A6)
	BEQ.S	NO_ADD
	ADDQ.L	#1,TIME2
	CMPI.L	#4,TIME2
	BNE.S	NO_ADD
	CLR.L	TIME2
	ADD.L	#32,PNT_FAD_B
	MOVE.L	2(A6),2(A5)
	MOVE.L	2+4(A6),16(A5)
	MOVE.L	2+4*2(A6),16+8(A5)
	MOVE.L	2+4*3(A6),16+8*2(A5)
	MOVE.L	2+4*4(A6),16+8*3(A5)
	MOVE.L	2+4*5(A6),16+8*4(A5)
	MOVE.L	2+4*6(A6),16+8*5(A5)
	MOVE	2+4*7(A6),16+8*6(A5)
NO_ADD
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
	MOVEM.L	D0-D7,$FFFF8240.W
	MOVE.L	A1,USP
	
INTER_RTE	RTE

INTER_TMA:	CLR.B	$FFFFFA07.W		; ARRET DU MFP POUR NE PAS
	CLR.B	$FFFFFA09.W		; ETRE GENE
	MOVE	#$2100,SR		; ON AUTORISE LA HBL
	
full
	LEA	$FFFF8209,A3
	LEA	$FFFF8260,A6
	LEA	$FFFF820A,A5

	MOVEQ	#0,D0
	MOVEQ	#2,D1

	STOP	#$2100		; ATTENTE DE LA PROCHAINE HBL
				; (FIXE A 16 CYCLES PRES ENVIRONS)
	MOVE	#$2700,SR		; ON COUPE TOUTE LES ITs
	MOVE	#$2300,(SP)		; AU RETOUR LE VBL SERA AUTORISEE

	MOVEQ	#29,D2		; ON ATTEND LE BON MOMENT
SYNCHROA:	DBF	D2,SYNCHROA
	NOP

	MOVE.B	D0,(A5)		; ET HOP! PLUS DE BORDER HAUT
	DCB	6,$4E71
	MOVE.B	D1,(A5)

*******
	MOVE.L	USP,A1

	MOVEQ	#0,D1		
	MOVEQ	#0,D4
	MOVEQ	#2,D3
	MOVEQ	#$10,D6

SYNCHR	MOVE.B	(A3),D7     * SYNCHRO
	BEQ.S	SYNCHR
	SUB.W	D7,D6		
	LSL.W	D6,D1		

	DCB	97-8,$4E71
	CLR	$FFFF8240.W
	JSR	(A0)		*4	T=128
	MOVE.L	(A1)+,A0	*3
	JSR	(A0)
	MOVE.L	(A1)+,A0
	JSR	(A0)
	MOVE.L	(A1)+,A0
	JSR	(A0)
	MOVE.L	(A1)+,A0
	JSR	(A0)
	MOVE.L	(A1)+,A0
	JSR	(A0)
	MOVE.L	A1,USP

;	DCB	7-1,$4E71
MODIF_COLORS1	MOVE.L	#0,$FFFF8242.W
*1ERE LIGNE
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)

	MOVE.L	#0,$FFFF8246.W
	MOVE.L	#0,$FFFF824A.W
	MOVE.L	#0,$FFFF824E.W
	MOVE.L	#0,$FFFF8252.W
	MOVE.L	#0,$FFFF8256.W
	MOVE.L	#0,$FFFF825A.W
	MOVE	#0,$FFFF825E.W
	DCB	88-2-5-4-6*6-4,$4E71
	MOVEQ	#0,D6	1
	MOVEQ	#0,D7	1
	MOVE.L	PNT_CRB,A0	5
	SUBA.L	#12,A0	4
	MOVE.b	#0,(A5)
	MOVE	a6,(A5)
	DCB	13,$4E71
	MOVE	a6,(A6)
	MOVE.B	#0,(A6)
	DCB	12-6,$4E71
	MOVEQ	#0,D0	1
	MOVEQ	#0,D1	1
	MOVEQ	#0,D2	1
	MOVEQ	#0,D3	1
	MOVEQ	#0,D4	1
	MOVEQ	#0,D5	1
*FIN 1ERE
	REPT	NB_SPR
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	SCREEN2_EFF,A1	5
	lea	160*7(A1),A1	2
	lea	230*131(A1),A1	2
	ADDA.W	4(A0),A1	4
	MOVEM.L	D0-D5,0(A1)	15
	MOVEM.L	D0-D5,230(A1)	15
	MOVEM.L	D0-D5,230*2(A1)	15
	MOVEM.L	D0-D5,230*3(A1)	15
	MOVEM.L	D0-D5,230*4(A1)	15
;	DCB     88-5-2-4-15*5,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	MOVEM.L	D0-D4,230*5(A1)	13
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	D0,230*5+4*5(A1)	4
	MOVEM.L	D0-D1,230*6(A1)	7
	DCB     12-4-7,$4E71

*FIN LIGNE 1
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVEM.L	D0-D3,230*6+4*2(A1)	11
	MOVEM.L	D0-D5,230*7(A1)	15
	MOVEM.L	D0-D5,230*8(A1)	15
	MOVEM.L	D0-D5,230*9(A1)	15
	MOVEM.L	D0-D5,230*10(A1)	15
	MOVEM.L	D0-D5,230*11(A1)	15
	DCB     88-11-15*5,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	MOVEM.L	D0-D4,230*12(A1)	13
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	D0,230*12+4*5(A1)	4
	MOVEM.L	D0-D1,230*13(A1)	7
	DCB     12-4-7,$4E71
*FIN LIGNE 2
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVEM.L	D0-D3,230*13+4*2(A1)	11
	MOVEM.L	D0-D5,230*14(A1)	15
	MOVEM.L	D0-D5,230*15(A1)	15
	MOVEM.L	D0-D5,230*16(A1)	15
	MOVEM.L	D0-D5,230*17(A1)	15
	MOVEM.L	D0-D5,230*18(A1)	15
	DCB     88-11-15*5,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	MOVEM.L	D0-D4,230*19(A1)	13
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	D0,230*19+4*5(A1)	4
	MOVEM.L	D0-D1,230*20(A1)	7
	DCB     12-4-7,$4E71
*FIN LIGNE 3
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVEM.L	D0-D3,230*20+4*2(A1)	11
	MOVEM.L	D0-D5,230*21(A1)	15
	MOVEM.L	D0-D5,230*22(A1)	15
	MOVEM.L	D0-D5,230*23(A1)	15
	MOVEM.L	D0-D5,230*24(A1)	15
	MOVEM.L	D0-D5,230*25(A1)	15
	DCB     88-11-15*5,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	MOVEM.L	D0-D4,230*26(A1)	13
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	D0,230*26+4*5(A1)	4
	MOVEM.L	D0-D1,230*27(A1)	7
	DCB     12-4-7,$4E71
*FIN LIGNE 4
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVEM.L	D0-D3,230*27+4*2(A1)	11
	MOVEM.L	D0-D5,230*28(A1)	15
	MOVEM.L	D0-D5,230*29(A1)	15
	LEA	PAS(A0),A0	2
	DCB     88-11-15*2-2,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB	13-6,$4E71
	ADDQ.L	#5,$140.W
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     12,$4E71
*FIN LIGNE 5
	ENDR
*DEB LIGNE NB_SPR*5+1
;	JMP	GOGO

	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     88-40,$4E71
	MOVE.L	PNT_CRB,A3	5
	LEA	TABLE_GENF,A4	3
	ADDA.W	2(A3),A4	4
	MOVE.L	SCREEN2_BALLS,A0	5
	lea	230*132(a0),a0	2
	lea	160*7(a0),a0	2
	ADDA.W	4(A3),A0	4
	MOVE.L	SCREEN2_BALLS,A1	5
	lea	230*132(a1),a1	2
	lea	160*7(a1),a1	2
	ADDA.W	4(A3),A1		4
	DCB	2,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	MOVE.L	(A4)+,A2	;MSK	3
	MOVE.L	(A4),A4		3
	DCB	13-6,$4E71
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     12-4,$4E71
	JSR	(A4)	4

	REPT	NB_SPR-1
	MOVE    a6,(A6)			2	2
	MOVE.B  #0,(A6)			3	5

;	MOVE.L	PNT_CRB,A3		5

	LEA	PAS(A3),A3
	LEA	TABLE_GENF,A4	3
	ADDA.W	2(A3),A4		4
	MOVE.L	SCREEN2_BALLS,A0		5
	lea	230*132(a0),a0
	lea	160*7(a0),a0
	ADDA.W	4(A3),A0		4
	MOVE.L	SCREEN2_BALLS,A1		5
	lea	230*132(a1),a1
	lea	160*7(a1),a1
	ADDA.W	4(A3),A1		4
	MOVE.L	(A4)+,A2	;MSK	3
	MOVE.L	(A4),A4		3

;	JSR	(A4)	4

	DCB     88-40+5-2-4,$4E71			88	93
	MOVE.b  #0,(A5)			3	96
	MOVE    a6,(A5)			2	98
	DCB     13,$4E71			13	111
	MOVE    a6,(A6)			2	113
	MOVE.B  #0,(A6)			3	116
	DCB     12-4,$4E71			12	128
	JSR	(A4)
	ENDR

******COG
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     88-12-8,$4E71
	LEA	PIC+34,A1	3
	lea	160*66(a1),a1	2
	MOVE.L	SCREEN2_BALLS,A0	5
	LEA	160*7+230*50+6+32(A0),A0	2
	ADD.L	#71,$140.W	8
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB     13,$4E71
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     12,$4E71
	
N	SET	0
N2	SET	0
	REPT	70-42-6
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE	N+6(A1),N2+0(A0)		
	MOVE	N+8(A1),N2+8(A0)	10

	MOVE	N+6+16(A1),N2+16(A0)
	MOVE	N+8+16(A1),N2+8+16(A0)	20

	MOVE	N+6+32(A1),N2+32(A0)
	MOVE	N+8+32(A1),N2+8+32(A0)	30

	MOVE	N+6+48(A1),N2+48(A0)
	MOVE	N+8+48(A1),N2+8+48(A0)	40

	MOVE	N+6+64(A1),N2+64(A0)
	MOVE	N+8+64(A1),N2+8+64(A0)	50

	MOVE	N+6+80(A1),N2+80(A0)
	MOVE	N+8+80(A1),N2+8+80(A0)	60

	MOVE	N+6+96(A1),N2+96(A0)
	MOVE	N+8+96(A1),N2+8+96(A0)	70

	MOVE	N+6+112(A1),N2+112(A0)
	MOVE	N+8+112(A1),N2+8+112(A0)	80

	MOVE	N+6+128(A1),N2+128(A0)	85

	DCB     88-85,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB     13-10,$4E71
	MOVE	N+8+128(A1),N2+8+128(A0)
	MOVE	N+6+144(A1),N2+144(A0)	10

	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE	N+8+144(A1),N2+8+144(A0)	5
	DCB     12-5,$4E71
N	SET	N+160
N2	SET	N2+230
	ENDR
****
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	#$00000700,$FFFF8240.W
	MOVE.L	#$07730650,$FFFF8244.W
	MOVE.L	#$05400430,$FFFF8248.W
	MOVE.L	#$03200210,$FFFF824C.W
	MOVE.L	#$01000111,$FFFF8250.W
	MOVE.L	#$02220333,$FFFF8254.W
	MOVE.L	#$04440555,$FFFF8258.W
	MOVE.L	#$06660777,$FFFF825C.W
	DCB     88-8*6,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB     13,$4E71
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     12,$4E71
****
	REPT	42+6
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE	N+6(A1),N2+0(A0)		
	MOVE	N+8(A1),N2+8(A0)	10

	MOVE	N+6+16(A1),N2+16(A0)
	MOVE	N+8+16(A1),N2+8+16(A0)	20

	MOVE	N+6+32(A1),N2+32(A0)
	MOVE	N+8+32(A1),N2+8+32(A0)	30

	MOVE	N+6+48(A1),N2+48(A0)
	MOVE	N+8+48(A1),N2+8+48(A0)	40

	MOVE	N+6+64(A1),N2+64(A0)
	MOVE	N+8+64(A1),N2+8+64(A0)	50

	MOVE	N+6+80(A1),N2+80(A0)
	MOVE	N+8+80(A1),N2+8+80(A0)	60

	MOVE	N+6+96(A1),N2+96(A0)
	MOVE	N+8+96(A1),N2+8+96(A0)	70

	MOVE	N+6+112(A1),N2+112(A0)
	MOVE	N+8+112(A1),N2+8+112(A0)	80

	MOVE	N+6+128(A1),N2+128(A0)	85

	DCB     88-85,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB     13-10,$4E71
	MOVE	N+8+128(A1),N2+8+128(A0)
	MOVE	N+6+144(A1),N2+144(A0)	10

	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE	N+8+144(A1),N2+8+144(A0)	5
	DCB     12-5,$4E71
N	SET	N+160
N2	SET	N2+230
	ENDR

******
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	MOVE.L	$140.W,D0	4
	MOVE.L	#206+5,D1	3
	SUB.L	D0,D1	2

	DCB     88-4-3-2,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB     13,$4E71
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     12-1,$4E71
;	MOVE	#$001,$FFFF8240.W
LAST_LIGNES	NOP
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     88,$4E71
	MOVE.b  #0,(A5)
	MOVE    a6,(A5)
	DCB     13,$4E71
	MOVE    a6,(A6)
	MOVE.B  #0,(A6)
	DCB     12-4,$4E71

	DBF	D1,LAST_LIGNES
GOGO
*************************
;	JMP	PLUSLOIN
	
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	SF	$FFFF8240.W
	DCB	88-4,$4E71

	MOVE.b	#0,(A5)
	MOVE	a6,(A5)
	DCB	13,$4E71
	MOVE	a6,(A6)
	MOVE.B	#0,(A6)
	;	ICI=116	NOPS

	CLR.B	$FFFF820A.W 
    REPT 6+2
     	NOP			
     ENDR

	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	MOVE	A6,(A5)
	DCB	88-2,$4E71
	MOVE.b	#0,(A5)
	MOVE	a6,(A5)
	DCB	13,$4E71
	MOVE	a6,(A6)
	MOVE.B	#0,(A6)
	DCB	12,$4E71

	REPT	30-6
	MOVE	A6,(A6)
	MOVE.B	#0,(A6)
	DCB	88,$4E71
	MOVE.b	#0,(A5)
	MOVE	a6,(A5)
	DCB	13,$4E71
	MOVE	a6,(A6)
	MOVE.B	#0,(A6)
	DCB	12,$4E71
	ENDR
PLUSLOIN
	MOVEQ	#0,D0
	MOVEQ	#0,D1
	MOVEQ	#0,D2
	MOVEQ	#0,D3
	MOVEQ	#0,D4
	MOVEQ	#0,D5
	MOVEQ	#0,D6
	MOVEQ	#0,D7
	MOVEM.L	D0-D7,$FFFF8240.W

	MOVEM.L	D0-A6,-(SP)
	MOVE.L	SAVE_A1_COG,A1
	LEA	PIC+34,A0
	MOVE.L	(A1)+,A2
	TST.L	-4(A1)
	BNE.S	ROUL
	LEA	TAB_COG+4,A1
	MOVE.L	(A1)+,A2
ROUL	MOVEM.L	(A2),D0-D7
	JSR	8*4(A2)
	MOVE.L	A1,SAVE_A1_COG
	MOVEM.L	(SP)+,D0-A6

	MOVE.L	USP,A1
	CMPI.L	#1,FLAG
	BNE.S	NON
	MOVE.L	A1,DATAPNT	*5
	CLR.L	FLAG
	BRA.S	OUI
NON	MOVE.L	#1,FLAG
OUI
	CMPI.B	#$3B,$FFFFFC02.W
	BEQ.S	NOL
	ADDQ.L	#6,PNT_CRB
NOL
	MOVE.L	PNT_CRB,A0
	CMPI.W	#-1,(PAS*NB_SPR)-6(A0)
	BNE.S	FINF
;	BRA	FIN
	MOVE.L	#COURB,PNT_CRB
FINF	

	MOVE.L	SCREEN1_BALLS,D0
	MOVE.L	SCREEN2_BALLS,SCREEN1_BALLS
	MOVE.L	D0,SCREEN2_BALLS

	MOVE.L	SCREEN2_EFF,D0
	MOVE.L	SCREEN1_EFF,SCREEN2_EFF
	MOVE.L	D0,SCREEN1_EFF

	MOVE.L	SCREEN1,D0
	MOVE.L	SCREEN2,SCREEN1
	MOVE.L	D0,SCREEN2

	MOVE.L	SCR1,D0
	MOVE.L	SCR2,SCR1
	MOVE.L	D0,SCR2

	MOVE.L	VALUE,D0
	MOVE.L	VALUE2,VALUE
	MOVE.L	D0,VALUE2

	move.l	SCREENA,a1
	ADDA.L	VALUE2,A1
	adda.l	#216+160*5+230*165,a1
	LEA	230+48*2(A1),A1
	CLR.L	(A1)
	CLR.L	4(A1)

	move.l	SCREEN,a1
	ADDA.L	VALUE,A1
	adda.l	#216+160*5+230*165,a1
	LEA	230+48*2(A1),A1
	CLR.L	(A1)
	CLR.L	4(A1)
VBL_ZIK	MOVEM.L	D0-A6,-(SP)
	JSR	ZIK+6
	MOVEM.L	(SP)+,D0-A6
	MOVE	#$2300,SR
	CMPI.B	#$39,$FFFFFC02.W
	BEQ	FIN
	RTE

TB1_IR
     REPT 127
	NOP			
     ENDR
	MOVE.B	#0,$FFFF820A.W	
     REPT 8
     	NOP			
     ENDR
	MOVE.B	#2,$FFFF820A.W	
	CLR.B	$FFFFFA1B.W
	MOVE.L	#INTER_RTE,$120	
	BCLR	#0,$FFFFFA0F.W	
	RTE			

FIN:	
	MOVE	#$2700,SR
	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	MFP1,$FFFFFA07.W
	MOVE.B	MFP2,$FFFFFA09.W
	MOVE.B	MFP3,$FFFFFA0F.W
	MOVE.B	MFP4,$FFFFFA13.W
	MOVE.B	MFP5,$FFFFFA1B.W
	MOVE.B	MFP6,$FFFFFA21.W
	MOVE.B	MFP7,$FFFFFA15.W
	MOVE.B	MFP8,$FFFFFA17.W
	MOVE.B	MFP9,$FFFFFA19.W
	MOVE.B	MFP10,$FFFFFA1F.W
	MOVE.L	ANC_VBL,$70.W
	MOVE.L	SAUVE_TMA,$134.W
	MOVE.L	SAUVE_HBL,$68.W

	MOVE	#$2300,SR

	MOVEM.L	ANC_PAL,D0-D7
	MOVEM.L	D0-D7,$FFFF8240.W
	SF	$FFFF8240.W
	
	MOVE.L	#$8080000,$FFFF8800.W
	MOVE.L	#$9090000,$FFFF8800.W
	MOVE.L	#$A0A0000,$FFFF8800.W

	BSET	#0,$484.W
	BSET	#1,$484.W
	BSET	#2,$484.W

	MOVE.B	#8,$FFFFFC02.W
	MOVE.B	#2,$FFFF820A.W
	
	MOVE.L	SAUV_SP,-(SP)
	MOVE.W 	#$20,-(SP)
	TRAP 	#1
	ADDQ.L 	#6,SP
	
	PEA	0.W
	TRAP	#1

AFF_FNT
 	ADDQ.L	#1,PNT
	CMPI.L	#11,PNT
	BNE.S	OKAY
	MOVE.L	#1,PNT
OKAY	CMPI.L	#1,PNT
	BEQ	PART1
	CMPI.L	#2,PNT
	BEQ	PART1B
	CMPI.L	#3,PNT
	BEQ	PART2
	CMPI.L	#4,PNT
	BEQ	PART2B
	CMPI.L	#5,PNT
	BEQ	PART3
	CMPI.L	#6,PNT
	BEQ	PART3B
	
	CMPI.L	#7,PNT
	BEQ	PART4
	CMPI.L	#8,PNT
	BEQ	PART4B
	CMPI.L	#9,PNT
	BEQ	PART5
	CMPI.L	#10,PNT
	BEQ	PART5B
R2	RTS


PART5	

	move.l	#IMAGE,A5	3
	move.l	MEM_LET,a2	5
	ADDA.L	(a2),A5		4
	move.l	SCREEN,A6	5
	ADDA.L	VALUE,A6	6
	adda.l	#230+216+160*7+230*165,A6	4

	MOVE	#80,D7
AFFT1
INC	SET	0
INC2	SET	0
;	REPT	81
	MOVEP.L	INC+25(A5),D6
	MOVEP.L	D6,INC2(A6)

	MOVEP.L	INC+32(A5),D6
	MOVEP.L	D6,INC2+1(A6)
	
	MOVEP.L	INC+33(A5),D6
	MOVEP.L	D6,INC2+8(A6)

;INC	SET	INC+160
;INC2	SET	INC2+230
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT1

	RTS

	
PART4
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREEN,A6
	ADDA.L	VALUE,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	0
INC2	SET	0
	MOVE	#80,D7
;	REPT	81
AFFT2	
	MOVEP.L	INC+17(A5),D6
	MOVEP.L	D6,INC2(A6)

	MOVEP.L	INC+24(A5),D6
	MOVEP.L	D6,INC2+1(A6)

;INC	SET	INC+160
;INC2	SET	INC2+230
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT2

	RTS


PART3
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREEN,A6
	ADDA.L	VALUE,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	0
INC2	SET	0
;	REPT	81
	MOVE	#80,D7
AFFT3	
	MOVEP.L	INC+9(A5),D6
	MOVEP.L	D6,INC2(A6)

	MOVEP.L	INC+16(A5),D6
	MOVEP.L	D6,INC2+1(A6)

;INC	SET	INC+160
;INC2	SET	INC2+230
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT3

	RTS


PART2
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREEN,A6
	ADDA.L	VALUE,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	0
INC2	SET	0
	MOVE	#80,D7
;	REPT	81
AFFT4	MOVEP.L	INC+1(A5),D6
	MOVEP.L	D6,INC2(A6)

	MOVEP.L	INC+8(A5),D6
	MOVEP.L	D6,INC2+1(A6)
;INC	SET	INC+160
;INC2	SET	INC2+230
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT4
	RTS

PART1
	move.l	#IMAGE,A5	Pointe sur les fontes
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREEN,A6
	ADDA.L	VALUE,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	0
INC2	SET	0
;	REPT	81
	MOVE	#80,D7
AFFT5	MOVEP.L	INC(A5),D6
	MOVEP.L	D6,INC2+1(A6)
;INC	SET	INC+160
;INC2	SET	INC2+230
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT5
	
	RTS


PART1B	
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREENA,A6
	ADDA.L	VALUE2,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	0
INC2	SET	0
	MOVE	#80,D7
;	REPT	81
AFFT6	MOVEM.L	INC(A5),D0-D1		8
	MOVEM.L	D0-D1,INC2(A6)		7
;INC	SET	INC+160
;INC2	SET	INC2+230
;	ENDR
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT6



	RTS
PART2B	
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREENA,A6
	ADDA.L	VALUE2,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	8
INC2	SET	0
;	REPT	81
	MOVE	#80,D7
AFFT7	MOVEM.L	INC(A5),D0-D1
	MOVEM.L	D0-D1,INC2(A6)
;INC	SET	INC+160
;INC2	SET	INC2+230
;	ENDR
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT7
	RTS
PART3B	
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREENA,A6
	ADDA.L	VALUE2,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	16
INC2	SET	0
;	REPT	81
	MOVE	#80,D7
AFFT8	MOVEM.L	INC(A5),D0-D1
	MOVEM.L	D0-D1,INC2(A6)
;INC	SET	INC+160
;INC2	SET	INC2+230
;	ENDR
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT8
	RTS

PART4B	
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREENA,A6
	ADDA.L	VALUE2,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	24
INC2	SET	0
;	REPT	81
	MOVE	#80,D7
AFFT9	MOVEM.L	INC(A5),D0-D1
	MOVEM.L	D0-D1,INC2(A6)
;INC	SET	INC+160
;INC2	SET	INC2+230
;	ENDR
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT9
	RTS

PART5B	
	move.l	#IMAGE,A5
	move.l	MEM_LET,a2
	ADDA.L	(a2),A5
	move.l	SCREENA,A6
	ADDA.L	VALUE2,A6
	adda.l	#230+216+160*7+230*165,A6
INC	SET	32
INC2	SET	0
;	REPT	81
	MOVE	#80,D7
AFFT10	MOVEM.L	INC(A5),D0-D1
	MOVEM.L	D0-D1,INC2(A6)
;INC	SET	INC+160
;INC2	SET	INC2+230
;	ENDR
	LEA	160(A5),A5
	LEA	230(A6),A6
	DBF	D7,AFFT10
		
	addq.l	#4,a2		On passe Ö une autre lettre
	cmp.L	#$ffff,(a2)
	bne	GO_LET
	lea	TEXTE,a2
GO_LET:	move.l	a2,MEM_LET	On sauvegarde le pointeur
	RTS

SWAP_SCR:	move.l	SCREEN1,d0
	move.l	SCREEN2,SCREEN1
	move.l	d0,SCREEN2
	lsr.l	#8,d0
	move.l	#$ffff8201,a0
	movep	d0,(a0)
	rts

NOTHING	
	NOP
	NOP
	DCB	115/5,$2A95
	RTS

H70
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	DCB	4,$4E71
	DCB	85/5,$2A95
	MOVE.B	D4,(A5)
	MOVE.B	D3,(A5)
	DCB	3,$4E71
	DCB	2,$2A95
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	NOP			 
	RTS	=4 NOPS
H44
	DCB	4,$4E71
	DCB	90/5,$2A95
	MOVE.B	D4,(A5)
	MOVE.B	D3,(A5)
	DCB	3,$4E71
	DCB	2,$2A95
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	NOP			 
	RTS	=4 NOPS
H24
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	DCB	2,$4E71
	DCB	85/5,$2A95
	MOVE.B	D4,(A5)
	MOVE.B	D3,(A5)
	DCB	3,$4E71
	DCB	2,$2A95
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	REPT	1+2
	NOP
	ENDR
	RTS	=4 NOPS
H2
	DCB	2,$4E71
	DCB	90/5,$2A95
	MOVE.B	D4,(A5)
	MOVE.B	D3,(A5)
	DCB	3,$4E71
	DCB	2,$2A95
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	REPT	1+2
	NOP			 
	ENDR
	RTS	=4 NOPS
H80
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	DCB	35/5,$2A95
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	DCB	4,$4E71
	DCB	45/5,$2A95
	MOVE.B	D4,(A5)
	MOVE.B	D3,(A5)
	DCB	3,$4E71
	DCB	2,$2A95
	MOVE.B	D3,(A6)
	NOP
	MOVE.B	D4,(A6)
	NOP			 
	RTS

PNT	DC.L	0
PNT2	DC.L	0
VALUE2	DC.L	-8
VALUE	DC.L	-8

MAK_COD	MOVE.L	#TABLE_SPR,ANNEX
	LEA	BUF_COD,A2
	LEA	TABLE_GEN,A6
	LEA	TABLE_GENF,A4
	LEA	FIC_OPT,A3	;OPT POUR LE SPRITE(MASK-SPRITE)
	CLR.W	FLAG_EFF
	BSR	CODING	;D

	RTS

CODING	
RECOMGENSPR	MOVE.L	ANNEX,A0
	MOVE.L	(A0),A0
	MOVE.L	SCREEN1,A1
	MOVE.L	SCREEN2,A5
	MOVE.W	#Y-1,D6
REAF2	MOVE.W	#X-2,D7
REAF1	MOVE.L	(A0),(A1)+
	MOVE.L	4(A0),(A1)+
	MOVE.W	(A0),D0
	MOVE.W	2(A0),D1
	MOVE.W	4(A0),D2
	OR.W	D2,D0
	OR.W	D1,D0
	NOT.W	D0
	MOVE.W	D0,(A5)+
	ADDQ.L	#8,A0
	DBRA	D7,REAF1
	CLR.L	(A1)+
	CLR.L	(A1)+
	MOVE.W	#-1,(A5)+
	LEA	160-((X-1)*8)(A0),A0
	DBRA	D6,REAF2

	MOVE.L	A3,(A6)+
	MOVE.L	A3,(A4)+
	MOVE.L	A2,(A6)+
	MOVE.L	GOUZI,(A4)+
	MOVE.L	GOUZI,(A4)+
	BSR	COD_GEN
	MOVE.L	A2,(A6)+
	BSR	MAK_EFF


	MOVEM.L	D0-A6,SAVE_ALL
	JSR	INCRUSTE
	MOVE.L	A2,GOUZI
	MOVEM.L	SAVE_ALL,D0-A6



	REPT	NB_DECAL-1
	LEA	BUF_COD,A2
	BSR	DECAL_SPR
	MOVE.L	A3,(A6)+
	MOVE.L	A3,(A4)+
	MOVE.L	A2,(A6)+
	MOVE.L	GOUZI,(A4)+
	MOVE.L	GOUZI,(A4)+
	BSR	COD_GEN
	MOVE.L	A2,(A6)+
	BSR	MAK_EFF


	MOVEM.L	D0-A6,SAVE_ALL
	JSR	INCRUSTE
	MOVE.L	A2,GOUZI
	MOVEM.L	SAVE_ALL,D0-A6

	ENDR
	RTS

DECAL_SPR	MOVE.L	SCREEN2,A1	;MSK
	MOVE.W	#NB_DEC,D4
RECOM_DEC	MOVE.L	SCREEN1,A0	;SPR
	MOVE.W	#Y-1,D5
DEC3	MOVE.W	#3,D6
DEC2	MOVE.W	#X-1,D7
DEC1	ROXR	(A0)
	ADDQ.L	#8,A0
	DBRA	D7,DEC1
	LEA	-((X*8)-2)(A0),A0
	DBRA	D6,DEC2
	LEA	(X-1)*8(A0),A0
	DBRA	D5,DEC3
	DBRA	D4,RECOM_DEC
	MOVE.L	SCREEN1,A0
	MOVE.W	#Y-1,D6
MSK2	MOVE.W	#X-1,D7
MSK1	MOVE.W	(A0)+,D0
	MOVE.W	(A0)+,D1
	MOVE.W	(A0)+,D2
	ADDQ.L	#2,A0
	OR.W	D1,D0
	OR.W	D2,D0
	NOT.W	D0
	MOVE.W	D0,(A1)+
	DBRA	D7,MSK1
	DBRA	D6,MSK2
	RTS

COD_GEN	MOVE.L	SCREEN1,A0	;SPR
	MOVE.L	SCREEN2,A1	;MSK
	;MOVE.L	#$4CDA00FF,(A2)+
	MOVE.L	#$201A221A,(A2)+
	MOVE.L	#$241A261A,(A2)+
	MOVE.L	#$281A2A1A,(A2)+
	MOVE.L	#$2C1A2E1A,(A2)+
	MOVE.W	#Y-1,D6
CDG2	MOVE.W	#X-1,D7
CDG1	BSR	ANDS
	DBRA	D7,CDG1
	MOVE.W	#$41E8,(A2)+
	MOVE.W	#230-(X*8),(A2)+
	BSR	OPTI_ADDQ_ANDS
 	DBRA	D6,CDG2
	LEA	32(A3),A3
	MOVE.L	SCREEN1,A0	;SPR
	MOVE.L	SCREEN2,A1	;MSK
	SUBQ.L	#4,A2
;	MOVE.L	#$4CDA00FF,(A2)+
	MOVE.L	#$201A221A,(A2)+
	MOVE.L	#$241A261A,(A2)+
	MOVE.L	#$281A2A1A,(A2)+
	MOVE.L	#$2C1A2E1A,(A2)+
	MOVE.W	#Y-1,D6
CDG4	MOVE.W	#X-1,D7
CDG3	BSR	ORS
	DBRA	D7,CDG3
	MOVE.W	#$43E9,(A2)+
	MOVE.W	#230-(X*8),(A2)+
	BSR	OPTI_ADDQ_ORS
	DBRA	D6,CDG4
	LEA	32(A3),A3
	SUBQ.L	#4,A2
	MOVE.W	#$4E75,(A2)+
	RTS

ANDS	TST.W	(A1)
	BEQ.S	NO_MASK
	CMPI.W	#-1,(A1)
	BEQ.S	NO_MASK
	;TST.L	0(A0)
	;BEQ	AND1
	MOVE.W	#$C158,D4
	MOVE.W	#$C198,D5
	CLR.W	ADD1
	MOVE.W	(A1),D0
	MOVE.W	#7,D3
CHERCHMSK	CMP.W     	(A3),D0
	BEQ.S	MSKTROUVê
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	ADDI.W	#$200,D5
	ADDQ.W	#4,ADD1
	DBRA	D3,CHERCHMSK
	LEA	-32(A3),A3
	MOVE.W	#$0298,(A2)+
	MOVE.W	(A1),(A2)+
	MOVE.W	(A1),(A2)+
	MOVE.W	#$0258,(A2)+
	MOVE.W	(A1),(A2)+
	MOVE.W	#$5448,(A2)+
;	ADDQ.W	#1,ADD
	BRA.S	FIN_MASK
MSKTROUVê	SUBA.W	ADD1,A3
	MOVE.W	D5,(A2)+
	MOVE.W	D4,(A2)+
	MOVE.W	#$5448,(A2)+
;	ADDQ.W	#1,ADD
	BRA.S	FIN_MASK
NO_MASK	MOVE.W	#$5048,(A2)+
	BSR	OPTI_ADDQ_ANDS
;	ADDQ.W	#1,ADD
FIN_MASK	ADDQ.L	#2,A1
	ADDQ.L	#8,A0
	RTS

AND1	MOVE.W	#$0258,(A2)+
	MOVE.W	(A1),(A2)+
	MOVE.W	#$5C48,(A2)+
	BRA	FIN_MASK

OPTI_ADDQ_ANDS:
	CLR.W	VARI
	MOVE.W	#$5048,D1	;ADDQ.W	#8,A0
	MOVE.W	#$5448,D2	;ADDQ.W	#2,A0
	MOVE.W	#$41E8,D3	;LEA	#IMM(A0),A0
CONTANDQ	CMP.W	-2(A2),D1
	BNE.S	ANDQ2
	ADDQ.W	#8,VARI
	SUBQ.L	#2,A2
	BRA	CONTANDQ
ANDQ2	CMP.W	-2(A2),D2
	BNE.S	ANDQ3
	ADDQ.W	#2,VARI
	SUBQ.L	#2,A2
	BRA	CONTANDQ
ANDQ3	CMP.W	-4(A2),D3
	BNE.S	FINANDQ
	MOVE.W	-2(A2),D4
	ADD.W	D4,VARI
	SUBQ.L	#4,A2
	BRA	CONTANDQ
FINANDQ	TST.W	VARI
	BEQ	SORTANDQ
	CMPI.W	#8,VARI
	BGT	CHANDQ2
	CMPI.W	#2,VARI
	BNE.S	CH1
	MOVE.W	#$5448,(A2)+
	BRA.S	SORTANDQ
CH1	CMPI.W	#4,VARI
	BNE.S	CH11
	MOVE.W	#$5848,(A2)+
	BRA.S	SORTANDQ
CH11	CMPI.W	#6,VARI
	BNE.S	CH111
	MOVE.W	#$5C48,(A2)+
	BRA.S	SORTANDQ
CH111	MOVE.W	#$5048,(A2)+
	BRA.S	SORTANDQ
CHANDQ2	MOVE.W	#$41E8,(A2)+
	MOVE.W	VARI,(A2)+
SORTANDQ	RTS

OPTI_ADDQ_ORS:
	CLR.W	VARI
	MOVE.W	#$5449,D0
	MOVE.W	#$5849,D1
	MOVE.W	#$5C49,D2
	MOVE.W	#$5049,D3
	MOVE.W	#$43E9,D4
CONTORQ	CMP.W	-2(A2),D0
	BNE.S	ORQ2
	ADDQ.W	#2,VARI
	SUBQ.L	#2,A2
	BRA.S	CONTORQ
ORQ2	CMP.W	-2(A2),D1
	BNE.S	ORQ3
	ADDQ.W	#4,VARI
	SUBQ.L	#2,A2
	BRA.S	CONTORQ
ORQ3	CMP.W	-2(A2),D2
	BNE.S	ORQ4
	ADDQ.W	#6,VARI
	SUBQ.L	#2,A2
	BRA.S	CONTORQ
ORQ4	CMP.W	-2(A2),D3
	BNE.S	ORQ5
	ADDQ.W	#8,VARI
	SUBQ.L	#2,A2
	BRA.S	CONTORQ
ORQ5	CMP.W	-4(A2),D4
	BNE.S	SORTORQ
	MOVE.W	-2(A2),D0
	ADD.W	D0,VARI
	MOVE.W	#$5449,D0
	SUBQ.L	#4,A2
	BRA.S	CONTORQ
SORTORQ	TST.W	VARI
	BEQ	FINORQ
	CMPI.W	#8,VARI
	BGT	CHORQ2
	CMPI.W	#2,VARI
	BNE.S	ORQ11
	MOVE.W	#$5449,(A2)+
	BRA	FINORQ
ORQ11	CMPI.W	#4,VARI
	BNE.S	ORQ111
	MOVE.W	#$5849,(A2)+
	BRA	FINORQ
ORQ111	CMPI.W	#6,VARI
	BNE.S	ORQ1111
	MOVE.W	#$5C49,(A2)+
	BRA	FINORQ
ORQ1111	MOVE.W	#$5049,(A2)+
	BRA	FINORQ
CHORQ2	MOVE.W	#$43E9,(A2)+
	MOVE.W	VARI,(A2)+
FINORQ	RTS

ORS	TST.W	(A1)
	BEQ	AFF_MOV
	CMPI.W	#-1,(A1)
	BEQ	NO_AFF
	TST.L	(A0)
	BEQ	AFF3
	TST.L	2(A0)
	BEQ	AFF1
	TST.W	(A0)
	BEQ	AFF23
	TST.W	2(A0)
	BEQ	AFF13
	TST.W	4(A0)
	BEQ	AFF12
	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CMP.W	2(A0),D0
	BEQ	COMPARE1
	BRA	NOT1SAME
APRES1COMP	MOVEQ	#0,D0
	MOVE.W	4(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSP1	CMP.L	(A3),D0
	BEQ.S	TROUVê1
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSP1
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	4(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVê1	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

COMPARE1	CLR.W	ADD1
	SWAP	D0
	MOVE.W	2(A0),D0
	MOVE.W	#$8199,D4
	MOVE.W	#7,D3
CHERCHCOMP1	CMP.L	(A3),D0
	BEQ.S	TROUVêC1
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHCOMP1
	LEA	-32(A3),A3
	MOVE.W	#$0099,(A2)+
	MOVE.L	(A0),(A2)+
	BRA	APRES1COMP
TROUVêC1	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	BRA	APRES1COMP

NOT1SAME	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSPA	CMP.L	(A3),D0
	BEQ.S	TROUVêA
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSPA
	LEA	-32(A3),A3
	MOVE.W	#$0099,(A2)+
	MOVE.L	(A0),(A2)+
	BRA	APRES1COMP
TROUVêA	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	2(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSPB	CMP.L	(A3),D0
	BEQ.S	TROUVêB
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSPB
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	2(A0),(A2)+
	BRA	APRES1COMP
TROUVêB	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	BRA	APRES1COMP


AFF13	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSP13	CMP.L	(A3),D0
	BEQ.S	TROUVê13
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSP13
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	CONT2
TROUVê13	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD

CONT2	MOVEQ	#0,D0
	MOVE.W	4(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSP1_3	CMP.L	(A3),D0
	BEQ.S	TROUVê1_3
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSP1_3
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	4(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVê1_3	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	
	BRA	FIN_AFF

AFF3	MOVE.W	#$5849,(A2)+
	BSR	OPTI_ADDQ_ORS
;	ADDQ.W	#1,ADD
	MOVEQ	#0,D0
	MOVE.W	4(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSP3	CMP.L	(A3),D0
	BEQ.S	TROUVê3
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSP3
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	4(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVê3	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

AFF1	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSP11	CMP.L	(A3),D0
	BEQ.S	TROUVê11
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSP11
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	(A0),(A2)+
	MOVE.W	#$5C49,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVê11	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5C49,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

AFF12	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CMP.W	2(A0),D0
	BEQ	COMPARE2
	MOVE.W	#$0099,(A2)+
	MOVE.L	(A0),(A2)+
APRES2COMP	MOVE.W	#$5849,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

COMPARE2	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHCOMP2	CMP.L	(A3),D0
	BEQ.S	TROUVêC2
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHCOMP2
	LEA	-32(A3),A3
	MOVE.W	#$0099,(A2)+
	MOVE.L	(A0),(A2)+
	BRA	APRES2COMP
TROUVêC2	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	D4,(A2)+
	BRA	APRES2COMP

AFF23	MOVE.W	#$5449,(A2)+
	BSR	OPTI_ADDQ_ORS
;	ADDQ.W	#1,ADD
	TST.W	4(A0)
	BEQ	AFF2
	MOVE.W	#$0099,(A2)+
	MOVE.L	2(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
AFF2	MOVEQ	#0,D0
	MOVE.W	2(A0),D0
	CLR.W	ADD1
	MOVE.W	#$8159,D4
	MOVE.W	#7,D3
CHERCHSP2	CMP.L	(A3),D0
	BEQ.S	TROUVê2
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#$200,D4
	DBRA	D3,CHERCHSP2
	LEA	-32(A3),A3
	MOVE.W	#$0059,(A2)+
	MOVE.W	2(A0),(A2)+
	MOVE.W	#$5849,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVê2	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5849,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

AFF_MOV	TST.L	(A0)
	BEQ	MOV3
	TST.L	2(A0)
	BEQ	MOV1
	TST.W	(A0)
	BEQ	MOV23
	TST.W	2(A0)
	BEQ	MOV13
	TST.W	4(A0)
	BEQ	MOV12
	MOVE.W	(A0),D0
	CMP.W	2(A0),D0
	BEQ	COMPARE3
	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV66	CMP.L	(A3),D0
	BEQ.S	TROUVêMV66
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV66
	LEA	-32(A3),A3
	BRA	CONT6
TROUVêMV66	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+

	MOVE.W	2(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV77	CMP.L	(A3),D0
	BEQ.S	TROUVêMV77
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV77
	LEA	-32(A3),A3
	MOVE.W	#$32FC,(A2)+
 	MOVE.W	2(A0),(A2)+
	BRA	APRES3COMP
TROUVêMV77	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	BRA	APRES3COMP

CONT6	MOVE.W	#$22FC,(A2)+
	MOVE.L	(A0),(A2)+
APRES3COMP	MOVEQ	#0,D0
	MOVE.W	4(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV33	CMP.L	(A3),D0
	BEQ.S	TROUVêMV33
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV33
	LEA	-32(A3),A3
	MOVE.W	#$32FC,(A2)+
	MOVE.W	4(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVêMV33	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

COMPARE3	SWAP	D0
	MOVE.W	2(A0),D0
	CLR.W	ADD1
	MOVE.W	#$22C0,D4
	MOVE.W	#7,D3
CHERCHCOMP3	CMP.L	(A3),D0
	BEQ.S	TROUVêC3
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#1,D4
	DBRA	D3,CHERCHCOMP3
	LEA	-32(A3),A3
	MOVE.W	#$22FC,(A2)+
	MOVE.L	(A0),(A2)+
	BRA	APRES3COMP
TROUVêC3	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	BRA	APRES3COMP


MOV13	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV13	CMP.L	(A3),D0
	BEQ.S	TROUVêMV13
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV13
	LEA	-32(A3),A3
	MOVE.W	#$22FC,(A2)+
	MOVE.W	(A0),(A2)+
	CLR.W	(A2)+
	;MOVE.W	#$32CC,(A2)+
	BRA	CONT3
TROUVêMV13	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$4259,(A2)+
CONT3	MOVEQ	#0,D0
	MOVE.W	4(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV1_3	CMP.L	(A3),D0
	BEQ.S	TROUVêMV1_3
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV1_3
	LEA	-32(A3),A3
	MOVE.W	#$32FC,(A2)+
	MOVE.W	4(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVêMV1_3	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
MOV3	MOVE.W	#$4299,(A2)+
	MOVEQ	#0,D0
	MOVE.W	4(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV3	CMP.L	(A3),D0
	BEQ.S	TROUVêMV3
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV3
	LEA	-32(A3),A3
	MOVE.W	#$32FC,(A2)+
	MOVE.W	4(A0),(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVêMV3	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

MOV1	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV1	CMP.L	(A3),D0
	BEQ.S	TROUVêMV1
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV1
	LEA	-32(A3),A3
	MOVE.W	#$32FC,(A2)+
	MOVE.W	(A0),(A2)+
	MOVE.W	#$4299,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVêMV1	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$4299,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
	MOVE.W	#$32FC,(A2)+
	MOVE.W	(A0),(A2)+
	MOVE.W	#$4299,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF


MOV23	MOVE.W	#$4259,(A2)+
	TST.W	4(A0)
	BEQ	MOV2

	MOVEQ	#0,D0
	MOVE.W	2(A0),D0
	CMP.W	4(A0),D0
	BEQ	COMPARE5
	MOVE.W	#$22FC,(A2)+
	MOVE.L	2(A0),(A2)+
APRES5COMP	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

COMPARE5	CLR.W	ADD1
	SWAP	D0
	MOVE.W	4(A0),D0
	MOVE.W	#$22C0,D4
	MOVE.W	#7,D3
CHERCHCOMP5	CMP.L	(A3),D0
	BEQ.S	TROUVêC5
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#1,D4
	DBRA	D3,CHERCHCOMP5
	LEA	-32(A3),A3
	MOVE.W	#$22FC,(A2)+
	MOVE.L	2(A0),(A2)+
	BRA	APRES5COMP
TROUVêC5	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	BRA	APRES5COMP

MOV2	MOVEQ	#0,D0
	MOVE.W	2(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMV2	CMP.L	(A3),D0
	BEQ.S	TROUVêMV2
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMV2
	LEA	-32(A3),A3
	MOVE.W	#$22FC,(A2)+
	MOVE.W	2(A0),(A2)+
	CLR.W	(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVêMV2	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$4259,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF


MOV12	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	CMP.W	2(A0),D0
	BEQ	COMPARE4
	MOVE.W	(A0),D0
	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHMVD	CMP.L	(A3),D0
	BEQ.S	TROUVêMVD
	ADDQ.L	#4,A3
	ADDQ.W	#4,ADD1
	ADDQ.W	#1,D4
	DBRA	D3,CHERCHMVD
	LEA	-32(A3),A3
	MOVE.W	#$22FC,(A2)+
	MOVE.L	(A0),(A2)+
	MOVE.W	#$4259,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
TROUVêMVD	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	#$22FC,(A2)+
	MOVE.W	2(A0),(A2)+
	CLR.W	(A2)+
	;MOVE.W	#$32CC,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF
	
APRES4COMP	MOVE.W	#$4259,(A2)+
	MOVE.W	#$5449,(A2)+
;	ADDQ.W	#1,ADD
	BRA	FIN_AFF

COMPARE4	CLR.W	ADD1
	MOVE.W	#$32C0,D4
	MOVE.W	#7,D3
CHERCHCOMP4	CMP.L	(A3),D0
	BEQ.S	TROUVêC4
	ADDQ.W	#4,ADD1
	ADDQ.L	#4,A3
	ADDI.W	#1,D4
	DBRA	D3,CHERCHCOMP4
	LEA	-32(A3),A3
	MOVE.W	#$22FC,(A2)+
	MOVE.L	(A0),(A2)+
	BRA	APRES4COMP
TROUVêC4	SUBA.W	ADD1,A3
	MOVE.W	D4,(A2)+
	MOVE.W	D4,(A2)+
	BRA	APRES4COMP

NO_AFF	MOVE.W	#$5049,(A2)+	
	BSR	OPTI_ADDQ_ORS
;	ADDQ.W	#1,ADD
FIN_AFF	ADDQ.L	#8,A0
	ADDQ.L	#2,A1
	RTS

MAK_EFF	TST.W	FLAG_EFF
	BEQ	FLAGEFF_OFF
	MOVE.L	SCREEN2,A0	;MSK
	MOVE.L	SCREEN1,A1	;SPR
	MOVE.W	#Y-1,D6
RECOMEF2	MOVE.W	#X-1,D7
RECOMEF1	CMPI.W	#-1,(A0)
	BEQ	QQQ
	TST.L	(A1)
	BEQ	EFF3
	TST.L	2(A1)
	BEQ	EFF1
	TST.W	(A1)
	BEQ	EFF23
	TST.W	2(A1)
	BEQ	EFF13
	TST.W	4(A1)
	BEQ	EFF12
EFF_ALL	MOVE.W	#$20C0,(A2)+	;6 NOPS
	MOVE.W	#$30C0,(A2)+
	MOVE.W	#$5448,(A2)+
	BRA.S	NO_EFF
QQQ	MOVE.W	#$5048,(A2)+
	BSR	OPTI_ADDQ_EFF
NO_EFF	ADDQ.L	#8,A1
	ADDQ.L	#2,A0
	DBRA	D7,RECOMEF1
	MOVE.W	#$41E8,(A2)+
	MOVE.W	#230-(X*8),(A2)+
	BSR	OPTI_ADDQ_EFF
	DBRA	D6,RECOMEF2
	MOVE.W	#$4E75,(A2)+
FLAGEFF_OFF	RTS

EFF3	MOVE.W	#$5848,(A2)+
	BSR	OPTI_ADDQ_EFF
	MOVE.W	#$30C0,(A2)+	;4 NOPS
	MOVE.W	#$5448,(A2)+
	BRA	NO_EFF

EFF1	MOVE.W	#$30C0,(A2)+	;3 NOPS
	MOVE.W	#$5C48,(A2)+
	BRA	NO_EFF

EFF23	TST.W	4(A1)
	BEQ	EFF2
	MOVE.W	#$5448,(A2)+	;5 NOPS
	BSR	OPTI_ADDQ_EFF
	MOVE.W	#$20C0,(A2)+
	MOVE.W	#$5448,(A2)+
	BRA	NO_EFF
EFF2	MOVE.W	#$5448,(A2)+	;4 NOPS
	BSR	OPTI_ADDQ_EFF
	MOVE.W	#$30C0,(A2)+
	MOVE.W	#$5848,(A2)+
	BRA	NO_EFF

EFF13	MOVE.W	#$30C0,(A2)+	;6 NOPS
	MOVE.W	#$5448,(A2)+
	MOVE.W	#$30C0,(A2)+
	MOVE.W	#$5448,(A2)+
	BRA	NO_EFF

EFF12	MOVE.W	#$20C0,(A2)+	;4 NOPS
	MOVE.W	#$5848,(A2)+
	BRA	NO_EFF

OPTI_ADDQ_EFF
	MOVE.W	#$5448,D0
	MOVE.W	#$5848,D1
	MOVE.W	#$5C48,D2
	MOVE.W	#$5048,D3
	MOVE.W	#$41E8,D4
	CLR.W	ADD1
CONT_OPTEF	CMP.W	-2(A2),D0
	BNE.S	ADEF2
	ADDQ.W	#2,ADD1
	SUBQ.L	#2,A2
	BRA	CONT_OPTEF
ADEF2	CMP.W	-2(A2),D1
	BNE.S	ADEF3
	ADDQ.W	#4,ADD1
	SUBQ.L	#2,A2
	BRA	CONT_OPTEF
ADEF3	CMP.W	-2(A2),D2
	BNE.S	ADEF4
	ADDQ.W	#6,ADD1
	SUBQ.L	#2,A2
	BRA	CONT_OPTEF
ADEF4	CMP.W	-2(A2),D3
	BNE.S	ADEF5
	ADDQ.W	#8,ADD1
	SUBQ.L	#2,A2
	BRA	CONT_OPTEF
ADEF5	CMP.W	-4(A2),D4
	BNE.S	FIN_OPTEF
	MOVE.W	-2(A2),D0
	ADD.W	D0,ADD1
	MOVE.W	#$5448,D0
	SUBQ.L	#4,A2
	BRA	CONT_OPTEF
FIN_OPTEF	TST.W	ADD1
	BEQ	FINI_OPTEF
	CMPI.W	#8,ADD1
	BGT	MAK_LEAEF
	CMPI.W	#2,ADD1
	BNE.S	TESTEF2
	MOVE.W	#$5448,(A2)+
	BRA	FINI_OPTEF
TESTEF2	CMPI.W	#4,ADD1
	BNE.S	TESTEF3
	MOVE.W	#$5848,(A2)+
	BRA	FINI_OPTEF
TESTEF3	CMPI.W	#6,ADD1
	BNE.S	TESTEF4
	MOVE.W	#$5C48,(A2)+
	BRA	FINI_OPTEF
TESTEF4	MOVE.W	#$5048,(A2)+
	BRA	FINI_OPTEF
MAK_LEAEF	MOVE.W	#$41E8,(A2)+
	MOVE.W	ADD1,(A2)+
FINI_OPTEF	RTS

INCRUSTE	CLR.L	LIGNES
	CLR.L	TM
	CLR.L	D0
	CLR.L	D1
	
	LEA	BUF_COD,A0
	LEA	INSTRUCTIONS,A1
	LEA	BUFFER_FULL,A2
	ADDA.L	PNT_F,A2
BOUCLE	MOVE	(A1),D2
	MOVE	2(A1),D1
	MOVE	4(A1),D0
	CMP	(A0),D0
	BEQ.S	THATS_IT
	CMPI	#$4E75,(A0)
	BEQ	THE_END
	CMPI	#$ABCD,D0
	BEQ	PROBLEME_NUMERO_UN
	LEA	6*2(A1),A1
	BRA.S	BOUCLE
THATS_IT
	TST.L	TM
	BNE.S	PAS_OVER_GAUCHE
	MOVE.L	#$3C8E1CBC,(A2)+
	MOVE	#$0000,(A2)+
	MOVE.L	#5,TM
	ADDq.L	#6,PNT_F
PAS_OVER_GAUCHE
	CMPI.L	#93,TM
	BLE	PARTIE_UN
	CMPI.L	#111,TM
	BLE.S	PARTIE_DEUX
	CMPI.L	#128,TM
	BLE	PARTIE_TROIS


PARTIE_TROIS
	MOVE.L	TM,D4
	ADD.L	D1,D4
	CMPI.L	#128,D4
	BGT.S	TOUJOURS_TROP_GRAND	SI=ALORS CA RENTRE
	BRA	CA_RENTRE
TOUJOURS_TROP_GRAND
	MOVE.L	#128,D4
	MOVE.L	TM,D5
	SUB.L	D5,D4
	TST.L	D4
	BEQ.S	DECIDEMENT_PAS_DE_NOP
	SUBQ.L	#1,D4
NOPZ	MOVE	#$4E71,(A2)+
	ADDq.L	#2,PNT_F
	DBF	D4,NOPZ
DECIDEMENT_PAS_DE_NOP	
	MOVE.L	#$3C8E1CBC,(A2)+
	MOVE	#$0000,(A2)+
	MOVE.L	#5,TM
	ADDq.L	#6,PNT_F
	ADD.L	#1,LIGNES
	BRA	CA_RENTRE

PARTIE_DEUX
	MOVE.L	TM,D4
	ADD.L	D1,D4
	CMPI.L	#111,D4
	BGT.S	ENCORE_TROP_GRAND	SI=ALORS CA RENTRE
	BRA	CA_RENTRE
ENCORE_TROP_GRAND
	MOVE.L	#111,D4
	MOVE.L	TM,D5
	SUB.L	D5,D4
	TST.L	D4
	BEQ.S	TOUJOURS_PAS_DE_NOP
	SUBQ.L	#1,D4
NOPX	MOVE	#$4E71,(A2)+
	ADDq.L	#2,PNT_F
	DBF	D4,NOPX
TOUJOURS_PAS_DE_NOP	
	MOVE.L	#$3C8E1CBC,(A2)+
	MOVE	#$0000,(A2)+
	ADDq.L	#6,PNT_F
	MOVE.L	#116,TM
;	BRA.S	CA_RENTRE
	BRA	PAS_OVER_GAUCHE
	
PARTIE_UN
	MOVE.L	TM,D4
	ADD.L	D1,D4
	CMPI.L	#93,D4
	BGT.S	TROP_GRAND	SI=ALORS CA RENTRE
	BRA	CA_RENTRE
TROP_GRAND
	MOVE.L	#93,D4
	MOVE.L	TM,D5
	SUB.L	D5,D4
	TST.L	D4
	BEQ.S	PAS_DE_NOP
	SUBQ.L	#1,D4
NOPY	MOVE	#$4E71,(A2)+
	ADDq.L	#2,PNT_F
	DBF	D4,NOPY
PAS_DE_NOP	
	MOVE.L	#$1ABC0000,(A2)+
	MOVE	#$3A8E,(A2)+
	ADDq.L	#6,PNT_F
	MOVE.L	#98,TM
CA_RENTRE	
	SUBQ	#1,D2
ICI	MOVE	(A0)+,(A2)+
	ADDq.L	#2,PNT_F
	DBF	D2,ICI
	ADD.L	D1,TM
	LEA	INSTRUCTIONS,A1
	BRA	BOUCLE

THE_END
	JSR	NOPS_QUI_RESTENT
	MOVE	#$4E75,(A2)
	
	MOVE.L	#TEXTE2,-(SP)
	MOVE	#$9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
;	MOVE	#$7,-(SP)
;	TRAP	#1
;	ADDQ.L	#2,SP
	RTS

PROBLEME_NUMERO_UN
	MOVE	#$070,$FFFF8240.W
	MOVE.L	#TEXTE1,-(SP)
	MOVE	#$9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
	MOVE	#$7,-(SP)
	TRAP	#1
	ADDQ.L	#2,SP
	CLR.L	-(SP)
	TRAP	#1	
	

PROBLEME_NUMBER_TWO
	MOVE	#$700,$FFFF8240.W
	MOVEM.L	D0-A6,-(SP)
	MOVE.L	#TEXTE3,-(SP)
	MOVE	#$9,-(SP)
	TRAP	#1
	ADDQ.L	#6,SP
;	MOVE	#$7,-(SP)
;	TRAP	#1
;	ADDQ.L	#2,SP
	MOVEM.L	(SP)+,D0-A6

	MOVE.L	TM,D0
	MOVE.L	#128,D1
	SUB.L	D0,D1
	TST.L	D1
	BEQ.S	PADNOP
	SUBQ.L	#1,D1
LMK	MOVE	#$4E71,(A2)+
	ADDQ.L	#2,PNT_F
	DBF	D1,LMK
PADNOP	
	MOVE	#$3C8E,(A2)+
	MOVE.L	#$1CBC0000,(A2)+
	ADDQ.L	#6,PNT_F
	REPT	44
	MOVE.L	#$4E714E71,(A2)+
	ADDQ.L	#4,PNT_F
	ENDR
	MOVE.L	#$1ABC0000,(A2)+
	MOVE	#$3A8E,(A2)+
	ADDQ.L	#6,PNT_F
	REPT	6
	MOVE.L	#$4E714E71,(A2)+
	ADDQ.L	#4,PNT_F
	ENDR
	MOVE.L	#$4E713C8E,(A2)+
	MOVE.L	#$1CBC0000,(A2)+
	ADDQ.L	#8,PNT_F
;	REPT	4
;	MOVE.L	#$4E714E71,(A2)+
;	ADDQ.L	#4,PNT_F
;	ENDR

	MOVE	#$06B8,(A2)+
	MOVE.L	LIGNES,(A2)
	ADD.L	#1,(A2)+
	MOVE	#$0140,(A2)+

	ADDQ.L	#8,PNT_F
	
	MOVE	#$777,$FFFF8240.W
;	CLR.L	-(SP)
;	TRAP	#1
	BRA	OUT
NOPS_QUI_RESTENT
	CMPI.L	#124,TM
	BGT	PROBLEME_NUMBER_TWO

	CMPI.L	#93,TM
	BEQ.S	MILIEU
	CMPI.L	#111,TM
	BEQ.S	OUT_DR
	CMPI.L	#124,TM
	BEQ	PROBLEME_NUMBER_TWO
	MOVE	#$4E71,(A2)+
	ADDq.L	#2,PNT_F
	ADD.L	#1,TM
	BRA.S	NOPS_QUI_RESTENT
MILIEU	MOVE.L	#$1ABC0000,(A2)+
	MOVE	#$3A8E,(A2)+
	ADDq.L	#6,PNT_F
	ADD.L	#5,TM
	BRA.S	NOPS_QUI_RESTENT
OUT_DR	MOVE.L	#$3C8E1CBC,(A2)+
	MOVE	#$0000,(A2)+
	ADDq.L	#6,PNT_F
	ADD.L	#5,TM
	BRA	NOPS_QUI_RESTENT
OUT	MOVE	#$4E75,(A2)+
	ADDq.L	#2,PNT_F
	RTS

	DATA	
TEXTE1	DC.B	'INSTRUCTION NON RECONNUE.',0
TEXTE2	DC.B	'CA ROULE.',0
TEXTE3	DC.B	'PROB DS LES NOPS DE FIN.',0
	EVEN
	
INSTRUCTIONS
; DC 2,3,$32FC,$0000,$0000,$0000	MOVE #0,(A1)+
; DC 1,2,$32CC,$0000,$0000,$0000	MOVE A4,(A1)+

 DC 1,3,$4259,$0000,$0000,$0000	CLR	(A1)+
 DC 1,5,$4299,$0000,$0000,$0000	CLR.L	(A1)+


; DC 2,19,$4CDA,$00FF,$0,$0                     MOVEM.L (A2)+,D0-D7
; DC 2,19,$4CDB,$00FF,$0,$0                     MOVEM.L (A3)+,D0-D7
 DC 2,2,$41E8,$00A0,$0,$0                     LEA     160(A0),A0
 DC 2,2,$43E9,$00A0,$0,$0                     LEA     160(A1),A1
 DC 1,5,$C198,$0,$0,$0                         AND.L   D0,(A0)+
 DC 1,5,$C398,$0,$0,$0                         AND.L   D1,(A0)+
 DC 1,5,$C598,$0,$0,$0                         AND.L   D2,(A0)+
 DC 1,5,$C798,$0,$0,$0                         AND.L   D3,(A0)+
 DC 1,5,$C998,$0,$0,$0                         AND.L   D4,(A0)+
 DC 1,5,$CB98,$0,$0,$0                         AND.L   D5,(A0)+
 DC 1,5,$CD98,$0,$0,$0                         AND.L   D6,(A0)+
 DC 1,5,$CF98,$0,$0,$0                         AND.L   D7,(A0)+

 DC 1,3,$C158,$0,$0,$0                         AND     D0,(A0)+
 DC 1,3,$C358,$0,$0,$0                         AND     D1,(A0)+
 DC 1,3,$C558,$0,$0,$0                         AND     D2,(A0)+
 DC 1,3,$C758,$0,$0,$0                         AND     D3,(A0)+
 DC 1,3,$C958,$0,$0,$0                         AND     D4,(A0)+
 DC 1,3,$CB58,$0,$0,$0                         AND     D5,(A0)+
 DC 1,3,$CD58,$0,$0,$0                         AND     D6,(A0)+
 DC 1,3,$CF58,$0,$0,$0                         AND     D7,(A0)+


 DC 3,7,$0298,$0000,$00A0,$0                 ANDI.L  #160,(A0)+
 DC 2,4,$0258,$00A0,$0,$0                     ANDI    #160,(A0)+
 DC 3,5,$22FC,$0000,$00A0,$0                 MOVE.L  #160,(A1)+
 DC 2,3,$32FC,$00A0,$0,$0                     MOVE    #160,(A1)+

 DC 1,2,$32C0,$0,$0,$0                         MOVE    d0,(A1)+
 DC 1,2,$32C1,$0,$0,$0                         MOVE    d1,(A1)+
 DC 1,2,$32C2,$0,$0,$0                         MOVE    d2,(A1)+
 DC 1,2,$32C3,$0,$0,$0                         MOVE    d3,(A1)+
 DC 1,2,$32C4,$0,$0,$0                         MOVE    d4,(A1)+
 DC 1,2,$32C5,$0,$0,$0                         MOVE    d5,(A1)+
 DC 1,2,$32C6,$0,$0,$0                         MOVE    d6,(A1)+
 DC 1,2,$32C7,$0,$0,$0                         MOVE    d7,(A1)+

 DC 1,3,$22C0,$0,$0,$0                                        MOVE.L    d0,(A1)+
 DC 1,3,$22C1,$0,$0,$0                                        MOVE.L    d1,(A1)+
 DC 1,3,$22C2,$0,$0,$0                                          MOVE.L    d2,(A1)+
 DC 1,3,$22C3,$0,$0,$0                                          MOVE.L    d3,(A1)+
 DC 1,3,$22C4,$0,$0,$0                                        MOVE.L    d4,(A1)+
 DC 1,3,$22C5,$0,$0,$0                                         MOVE.L    d5,(A1)+
 DC 1,3,$22C6,$0,$0,$0                                       MOVE.L    d6,(A1)+
 DC 1,3,$22C7,$0,$0,$0                                         MOVE.L    d7,(A1)+


 DC 1,2,$5449,$0,$0,$0                         ADDQ    #2,A1
 DC 1,2,$5849,$0,$0,$0                         ADDQ    #4,A1
 DC 1,2,$5C49,$0,$0,$0                         ADDQ    #6,A1
 DC 1,2,$5049,$0,$0,$0                         ADDQ    #8,A1

 DC 1,2,$5448,$0,$0,$0                         ADDQ    #2,A0   
 DC 1,2,$5848,$0,$0,$0                         ADDQ    #4,A0   
 DC 1,2,$5C48,$0,$0,$0                         ADDQ    #6,A0   
 DC 1,2,$5048,$0,$0,$0                         ADDQ    #8,A0   


 DC 3,7,$0099,$0000,$00A0,$0                 ORI.L   #160,(A1)+
 DC 2,4,$0059,$00A0,$0,$0                     ORI     #160,(A1)+
 DC 1,3,$8159,$0,$0,$0                         OR      D0,(A1)+
 DC 1,3,$8359,$0,$0,$0                         OR      D1,(A1)+
 DC 1,3,$8559,$0,$0,$0                         OR      D2,(A1)+
 DC 1,3,$8759,$0,$0,$0                         OR      D3,(A1)+
 DC 1,3,$8959,$0,$0,$0                         OR      D4,(A1)+
 DC 1,3,$8B59,$0,$0,$0                         OR      D5,(A1)+
 DC 1,3,$8D59,$0,$0,$0                         OR      D6,(A1)+
 DC 1,3,$8F59,$0,$0,$0                         OR      D7,(A1)+

 DC 1,5,$8199,$0,$0,$0                         OR.L    D0,(A1)+
 DC 1,5,$8399,$0,$0,$0                         OR.L    D1,(A1)+
 DC 1,5,$8599,$0,$0,$0                         OR.L    D2,(A1)+
 DC 1,5,$8799,$0,$0,$0                         OR.L    D3,(A1)+
 DC 1,5,$8999,$0,$0,$0                         OR.L    D4,(A1)+
 DC 1,5,$8B99,$0,$0,$0                         OR.L    D5,(A1)+
 DC 1,5,$8D99,$0,$0,$0                         OR.L    D6,(A1)+
 DC 1,5,$8F99,$0,$0,$0                         OR.L    D7,(A1)+


 DC 1,3,$201A,$0,$0,$0	MOVE.L	(A2)+,D0
 DC 1,3,$221A,$0,$0,$0	MOVE.L	(A2)+,D1
 DC 1,3,$241A,$0,$0,$0	MOVE.L	(A2)+,D2
 DC 1,3,$261A,$0,$0,$0	MOVE.L	(A2)+,D3
 DC 1,3,$281A,$0,$0,$0	MOVE.L	(A2)+,D4
 DC 1,3,$2A1A,$0,$0,$0	MOVE.L	(A2)+,D5
 DC 1,3,$2C1A,$0,$0,$0	MOVE.L	(A2)+,D6
 DC 1,3,$2E1A,$0,$0,$0	MOVE.L	(A2)+,D7

; DC 1,3,$201B,$0,$0,$0	MOVE.L	(A3)+,D0
; DC 1,3,$221B,$0,$0,$0	MOVE.L	(A3)+,D1
; DC 1,3,$241B,$0,$0,$0	MOVE.L	(A3)+,D2
; DC 1,3,$261B,$0,$0,$0	MOVE.L	(A3)+,D3
; DC 1,3,$281B,$0,$0,$0	MOVE.L	(A3)+,D4
; DC 1,3,$2A1B,$0,$0,$0	MOVE.L	(A3)+,D5
; DC 1,3,$2C1B,$0,$0,$0	MOVE.L	(A3)+,D6
; DC 1,3,$2E1B,$0,$0,$0	MOVE.L	(A3)+,D7



 DC	9,9,$ABCD			;FIN

;FULLSCREEN
;1283	MOVE.B	D3,(A1)			2
;	NOP				1	3
;1284	MOVE.B	D4,(A1)			2	5
;	DCB	89,$4E71			89	94
;1084	MOVE.B	D4,(A0)			2	96
;1083	MOVE.B	D3,(A0)			2	98
;	DCB	13,$4E71			13	111
;1283	MOVE.B	D3,(A1)			2	113
;	NOP				1	114
;1284	MOVE.B	D4,(A1)			2	116
;	DCB	12,$4E71			12	128

; 3C8E     MOVE    a6,(A6)			2	2
; 1CBC0000 MOVE.B  #0,(A6)			3	5
;          DCB     88,$4E71			88	93
; 1ABC0000 MOVE.b  #0,(A5)			3	96
; 3A8E     MOVE    a6,(A5)			2	98
;          DCB     13,$4E71			13	111
; 3C8E     MOVE    a6,(A6)			2	113
; 1CBC0000 MOVE.B  #0,(A6)			3	116
;          DCB     12,$4E71			12	128

	DS.L	1000
COURB	INCBIN	A:\BIGGIE6.CRB
FIN_CRB	DS.L	1120
	DC.W	-1

PIC	INCBIN	a:\BOUL3P.PI1
FIC_OPT	INCBIN	A:\BOUL.OPT

TABLE_SPR	DC.L	PIC+34
IMAGE	INCBIN	A:\fontes1.dat
	INCBIN	A:\fontes2.dat
	INCBIN	A:\fontes3.dat
	INCBIN	A:\fontes4.dat

TEXTE	INCBIN	BIG.TXT
DATA	
	DC.L	-256,NOTHING,NOTHING,NOTHING,NOTHING,NOTHING,NOTHING
	DC.L	256,H44,H44,H44,H44,H44,H44
	DC.L	0,H24,H2,H2,H2,H2,NOTHING
	DC.L	0,H24,NOTHING,NOTHING,NOTHING,NOTHING,NOTHING
	DC.L	0,H80,H44,H2,H70,NOTHING,NOTHING
	DC.L	0,H44,H2,H2,NOTHING,NOTHING,NOTHING
	DC.L	0,H24,H24,NOTHING,NOTHING,NOTHING,NOTHING
	DC.L	0,H80,H70,H2,H2,H70,NOTHING
	DC.L	0,H70,H2,H2,H2,NOTHING,NOTHING
	DC.L	0,H24,H24,H24,NOTHING,NOTHING,NOTHING
	DC.L	0,H44,H44,H2,H2,H2,H2
	DC.L	0,H44,H44,NOTHING,NOTHING,NOTHING,NOTHING
	DC.L	256,H24,H24,H24,H24,NOTHING,NOTHING
	DC.L	-256,H80,H80,H80,H44,H44,NOTHING
	DC.L	0,H70,H44,H2,NOTHING,NOTHING,NOTHING
	DC.L	0,H24,H24,H24,H24,H24,NOTHING
	DC.L	0,H44,H44,H44,H2,H2,NOTHING
	DC.L	0,H70,H24,H44,H2,NOTHING,NOTHING
	DC.L	0,H24,H24,H24,H24,H24,H24
	DC.L	0,H80,H70,H70,H24,H2,H70

	DC.L	256,H70,H70,H24,H2,H2,NOTHING
	DC.L	0,H80,H2,H2,H2,H2,NOTHING	
	DC.L	-256,H80,NOTHING,NOTHING,NOTHING,NOTHING,NOTHING
	DC.L	512,H70,H70,H44,NOTHING,NOTHING,NOTHING
	DC.L	-512,H80,H80,H80,H80,NOTHING,NOTHING
	DC.L	0,H44,H44,H44,H44,H24,NOTHING
	DC.L	512,H70,H70,H70,H2,NOTHING,NOTHING
	DC.L	-512,H80,H80,H80,H80,H24,NOTHING
	DC.L	0,H44,H44,H44,H44,H24,H24
	
	DC.L	512,H70,H70,H24,H24,H44,NOTHING
	DC.L	-256,H80,H80,H80,H80,H24,H24
	DC.L	0,H2,H2,H2,H2,NOTHING,NOTHING

	DC.L	-1,-1

ZIK	INCBIN	BANG.MUS
COD_COG	INCBIN	DATA.COG
	RTS
PAL_BALLS	DCB	16,0
	DC	$000,$010,$010,$110,$111,$111,$111,$111
	DC	$111,$110,$110,$110,$111,$111,$111,$111
	DC	$000,$210,$210,$220,$221,$222,$222,$222
	DC	$222,$210,$210,$220,$221,$222,$222,$222
	DC	$000,$210,$310,$320,$331,$332,$333,$333
	DC	$333,$210,$310,$320,$331,$332,$333,$333
	DC	$000,$210,$310,$420,$431,$442,$443,$444
	DC	$444,$210,$310,$420,$431,$442,$443,$444
	DC	$000,$210,$310,$420,$531,$542,$553,$554
	DC	$555,$210,$310,$420,$531,$542,$553,$554
	DC	$000,$210,$310,$420,$531,$642,$653,$664
	DC	$556,$210,$310,$420,$531,$542,$653,$664
	DC	$000,$210,$310,$420,$531,$642,$753,$764
	DC	$556,$210,$310,$420,$531,$642,$753,$764
	DC.L	-1
PAL_BALLS2
	DC	$000,$210,$310,$420,$531,$642,$753,$764
	DC	$556,$210,$310,$420,$531,$642,$753,$764
	DC	$000,$210,$310,$420,$531,$642,$653,$664
	DC	$556,$210,$310,$420,$531,$542,$653,$664
	DC	$000,$210,$310,$420,$531,$542,$553,$554
	DC	$555,$210,$310,$420,$531,$542,$553,$554
	DC	$000,$210,$310,$420,$431,$442,$443,$444
	DC	$444,$210,$310,$420,$431,$442,$443,$444
	DC	$000,$210,$310,$320,$331,$332,$333,$333
	DC	$333,$210,$310,$320,$331,$332,$333,$333
	DC	$000,$210,$210,$220,$221,$222,$222,$222
	DC	$222,$210,$210,$220,$221,$222,$222,$222
	DC	$000,$010,$010,$110,$111,$111,$111,$111
	DC	$111,$110,$110,$110,$111,$111,$111,$111
	DCB	16,0
	DC.L	-1

PNT_FAD_B	DC.L	0
PNT_FAD_B2	DC.L	0

	SECTION	BSS
F_PILE	DS.L 	128	
D_PILE	DS.L 	1	

SCREENA	DS.L	1
SCREEN	DS.L	1
SCREEN1	DS.L	1
SCREEN2	DS.L	1
SCREEN1_BALLS	DS.L	1
SCREEN2_BALLS	DS.L	1
SCREEN1_EFF	DS.L	1
SCREEN2_EFF	DS.L	1
SCR1	DS.L	1
SCR2	DS.L	1
MFP1	DS.B	1
MFP2	DS.B	1
MFP3	DS.B	1
MFP4	DS.B	1
MFP5	DS.B	1
MFP6	DS.B	1
MFP7	DS.B	1
MFP8	DS.B	1
MFP9	DS.B	1
MFP10	DS.B	1
	DS.B	256+160
BUFFERSCR	DS.B	345*256*2
	ds.b	256+160
ANC_PAL	DS.L	8
SAUV_SP	DS.L	1
ANC_VBL	DS.L	1
DATAPNT	DS.L	1
PLUS	DS.L	1
PLUS3	DS.L	1
MEM_LET	DS.L	1
PART_AFF	DS.L	1
FLAG	DS.L	1
SAUVE_HBL	DS.L	1
SAUVE_TMA	DS.L	1
***
PNT_CRB	DS.L	1
VARI	DS.W	1
ADD1	DS.W	1
ANNEX	DS.L	1
SAVE_ALL	DS.L	16
FLAG_EFF	DS.W	1
PNT_F	DS.L	1
GOUZI	DS.L	1
TABLE_GEN	DS.L	25
TABLE_GENF	DS.L	96
LIGNES	DS.L	1
TM	DS.L	1	
TAB_COG	DS.L	130
BUF_COD	DS.B	6100
END_COD
BUFFER_FULL
	DS.B	16000
	EVEN
