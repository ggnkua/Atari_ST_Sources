

STARTIT		MOVEA.L 4(A7),A6		* BASE PAGE START
		MOVE.L 4(A6),D0
		SUBI.L #$1000,D0
		MOVE.L D0,MEMEND		* END OF MEMORY
		SUB.L (A6),D0
		MOVE.L D0,-(SP)
		MOVE.L A6,-(SP)
		CLR.W -(SP)
		MOVE.W #$4A,-(SP)
		TRAP #1
		ADDA.L #12,SP

		PEA STACKST		
		MOVE.W #$20,-(SP)		* DO SUPERVISOR STUFF
		TRAP #1
		ADDQ.L #6,SP
		MOVE.L D0,SAVE_SSP		* SAVE OLD STACK
		
		LEA FILE_PIC,A0
		BSR OPEN_FILE
		LEA PIC_BUFFER,A1
		MOVE.L #$7D42,A2		* NEO FILE SIZE
		BSR READ_FILE
		BSR CLOSE_FILE
		MOVE.B PIC_BUFFER+1,$FFFF8260	* SET SCREEN REZ.
		MOVE.L #PIC_BUFFER+2,-(SP)
		MOVE.W #6,-(SP)
		TRAP #14
		ADDQ.L #6,SP
		MOVE.W #3,-(SP)
		TRAP #14
		ADDQ.L #2,SP
		MOVEA.L D0,A1
		MOVE.L #PIC_BUFFER+34,A0	* START OF PICTURE 
		MOVE.W #$7FFF,D0
WRITE_PIC	MOVE.W (A0)+,(A1)+
		DBF D0,WRITE_PIC		* PUT PICTURE ON SCREEN
		jmp	mulli

		
		




	
CLOSE_FILE	MOVE.W HANDLE,-(SP)		* FILE HANDLE NO.
		MOVE.W #$3E,-(SP)
		TRAP #1
		ADDQ.L #4,SP
		TST.W D0			* IS IT AN ERROR
		BMI ERRORED
		RTS

OPEN_FILE	MOVE.W #2,-(SP)			* READ TYPE
		MOVE.L A0,-(SP)			* ADDRS OF TEXT NAME	
		MOVE.W #$3D,-(SP)
		TRAP #1
		ADDQ.L #8,SP
		TST.W D0
		BMI ERRORED			* IS IT AN ERROR
		MOVE.W D0,HANDLE
		RTS

READ_FILE	MOVE.L A1,-(SP)
		MOVE.L A2,-(SP)
		MOVE.W HANDLE,-(SP)
		MOVE.W #$3F,-(SP)
		TRAP #1
		ADDA.L #12,SP
		TST.W D0
		BMI ERRORED
		RTS		

ERRORED		CLR.W -(SP)			* GO BACK TO GEM
		TRAP #1

		EVEN



STATUS		DS.W 1
SAVE_SSP	DS.L 1

MEMEND		DS.L 1

HANDLE		DS.W 1

FILE_PIC	DC.B "DEMO.NEO",0


STACKEND	DS.L 512
STACKST		DS.W 10

PIC_BUFFER

mulli:
