;Yo, this is POWER MAN here with the source
;for my volume indicator article. See ya
;next time, so chill out....



	CLR.L -(A7)
	MOVE.W #32,-(A7)
	TRAP #1
	ADDQ.L #6,A7
	MOVE.L D0,STACK
	LEA $78000,A0		;SET UP COLOUR BARS
	MOVE.W #(66*20)-1,D0
COL1	MOVE.W #-1,(A0)+
	MOVE.L #0,(A0)+
	MOVE.W #0,(A0)+
	DBF D0,COL1
	MOVE.W #(66*20)-1,D0
COL2	MOVE.W #0,(A0)+
	MOVE.W #-1,(A0)+
	MOVE.L #0,(A0)+
	DBF D0,COL2
	MOVE.W #(68*20)-1,D0
COL3	MOVE.L #0,(A0)+
	MOVE.W #-1,(A0)+
	MOVE.W #0,(A0)+
	DBF D0,COL3
	JSR SETMUS
	MOVE.L #CHANGE,$4D2+4.W
WAIT	CMPI.B #57,$FFFFFC02.W	;SPACE BAR
	BNE WAIT
	BSR ENDMUS
	MOVE.L STACK,-(A7)
	MOVE.W #32,-(A7)
	TRAP #1
	ADDQ.L #6,A7
	CLR.L -(A7)
	TRAP #1

CHANGE	MOVEQ.W #0,D0
	MOVEQ.W #0,D1
	MOVEQ.W #0,D2
	MOVE.B #8,$FFFF8800.W  	;CHANNEL A
	MOVE.B $FFFF8800.W,D0
	MOVE.B #9,$FFFF8800.W   ;CHANNEL B
	MOVE.B $FFFF8800.W,D1
	MOVE.B #10,$FFFF8800.W  ;CHANNEL C
	MOVE.B $FFFF8800.W,D2
	BTST #4,D0              ;IS CHANNEL A AN ENVELOPE?
	BEQ .L1
	MOVE.